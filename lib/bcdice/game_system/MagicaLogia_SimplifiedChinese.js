(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[6875],{3677:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var W,s,P,I,C,_,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.class_variable_set,D=r.truthy,z=r.class_variable_get,$=r.def,N=r.send,K=r.to_a,L=r.rb_minus,M=r.send2,G=r.find_super,H=r.hash2,F=r.find_block_super,j=r.neqeq;return W=U,_=[C=e(U[0],"I18n")].concat(W),y(_[0],"@@fallbacks",t),s=r.get_singleton_class(C),P=[s].concat(_),I=r.$r(P),$(s,"$fallbacks",function(){var T=t;return y(P[1],"@@fallbacks",D(null!=P[1].$$cvars["@@fallbacks"]?"class variable":t)&&D(T=z(P[1],"@@fallbacks",!1))?T:m(m(I("I18n"),"Locale"),"Fallbacks").$new()),D(T=I("Thread").$current()["$[]"]("i18n_fallbacks"))?T:z(P[1],"@@fallbacks",!1)},0),$(s,"$fallbacks=",function(b){var T;return y(P[1],"@@fallbacks",D(b["$is_a?"](I("Array")))?m(m(I("I18n"),"Locale"),"Fallbacks").$new(b):b),T=["i18n_fallbacks",z(P[1],"@@fallbacks",!1)],N(I("Thread").$current(),"[]=",K(T)),T[L(T.length,1)]},1),function(s,k){var b,T,S,c,I=[e(s,"Backend")].concat(k);return b=I,S=[T=e(I[0],"Fallbacks")].concat(b),c=r.$r(S),$(T,"$translate",function f(o,a,u){try{var n=f.$$p||t,i=this,g=t,B=t;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),D(u.$fetch("fallback",!0))?D(u["$[]"]("fallback_in_progress"))?M(i,G(i,"translate",f,!1,!0),"translate",[o,a,u],n):(D(u["$[]"]("default"))&&(g=i["$extract_non_symbol_default!"](u)),B=u.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),N(c("I18n").$fallbacks()["$[]"](o),"each",[],function h(w){var E=null==h.$$s?this:h.$$s;null==w&&(w=t);try{return N(E,"catch",["exception"],function p(){var l=null==p.$$s?this:p.$$s,A=t;if(A=M(l,F(l,"translate",p.$$def||h.$$def||f,!1,!1),"translate",[w,a,B],null),D(A["$nil?"]()))return t;j(o.$to_s(),w.$to_s())&&l.$on_fallback(o,w,a,u),r.ret(A)},{$$arity:0,$$s:E})}catch(p){if(!r.rescue(p,[m(c("I18n"),"InvalidLocale")]))throw p;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),D(u["$key?"]("default"))&&D(u["$[]"]("default")["$nil?"]())?t:D(g)?M(i,G(i,"translate",f,!1,!0),"translate",[o,t,u.$merge(H(["default"],{default:g}))],null):i.$throw("exception",m(c("I18n"),"MissingTranslation").$new(o,a,u))):M(i,G(i,"translate",f,!1,!0),"translate",[o,a,u],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),$(T,"$extract_non_symbol_default!",function(o){var u,a=t,n=t;return a=[o["$[]"]("default")].$flatten(),u=N(a,"detect",[],function(g){return null==g&&(g=t),g["$is_a?"](c("Symbol"))["$!"]()},1),D(u)&&(n=["default",a["$[]"](0,a.$index(u))],N(o,"[]=",K(n)),L(n.length,1)),u},1),$(T,"$exists?",function f(o,a,u){try{var n=f.$$p||t,i=this;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),D(u.$fetch("fallback",!0))?(N(c("I18n").$fallbacks()["$[]"](o),"each",[],function g(B){var h=null==g.$$s?this:g.$$s;null==B&&(B=t);try{if(!D(M(h,F(h,"exists?",g.$$def||f,!1,!1),"exists?",[B,a],null)))return t;r.ret(!0)}catch(w){if(!r.rescue(w,[m(c("I18n"),"InvalidLocale")]))throw w;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):M(i,G(i,"exists?",f,!1,!0),"exists?",[o,a,u],n)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),T.$private(),$(T,"$on_fallback",function(o,a,u,n){return t},4)}(_[0],_)},Opal.modules["bcdice/randomizer"]=function(r){var C,v,b,T,S,c,s,k,U=[],t=r.nil,m=r.$$$,y=r.klass,D=r.const_set,z=r.def,$=r.truthy,N=r.rb_gt,K=r.rb_plus,L=r.rb_le,M=r.send,G=r.rb_minus,H=r.eqeq,F=r.rb_times,j=r.eqeqeq,V=r.rb_ge;return C=U,s=[(0,r.module)(U[0],"BCDice")].concat(C),k=r.$r(s),v=s,T=[b=y(s[0],null,"Randomizer")].concat(v),S=r.$r(T),(c=b.$$prototype).rand_results=c.detailed_rand_results=t,D(T[0],"UPPER_LIMIT_DICE_TIMES",200),D(T[0],"UPPER_LIMIT_DICE_SIDES",1e3),D(T[0],"UPPER_LIMIT_RANDS",1e4),z(b,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),b.$attr_reader("rand_results"),b.$attr_reader("detailed_rand_results"),D(T[0],"DetailedRandResult",S("Struct").$new("kind","sides","value")),z(b,"$roll_barabara",function(o,a){var u=this;return $(N(K(u.rand_results.$size(),o),S("UPPER_LIMIT_RANDS")))&&u.$raise(S("TooManyRandsError")),$(L(o,0))||$(N(o,S("UPPER_LIMIT_DICE_TIMES")))?[]:M(S("Array"),"new",[o],function n(){return(null==n.$$s?this:n.$$s).$roll_once(a)},{$$arity:0,$$s:u})},2),z(b,"$roll_sum",function(o,a){return this.$roll_barabara(o,a).$sum()},2),z(b,"$roll_once",function(o){var u=t;return $(L(o,0))||$(N(o,S("UPPER_LIMIT_DICE_SIDES")))?0:(u=this.$rand_inner(o),this.$push_to_detail("normal",o,u),u)},1),z(b,"$roll_index",function(o){return G(this.$roll_once(o),1)},1),z(b,"$roll_tens_d10",function(){var u,a=t;return a=this.$rand_inner(10),H(a,10)&&(a=0),u=F(a,10),this.$push_to_detail("tens_d10",10,u),u},0),z(b,"$roll_d9",function(){var a;return a=G(this.$rand_inner(10),1),this.$push_to_detail("d9",10,a),a},0),z(b,"$roll_d66",function(o){var n,u=t;return u=M(S("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(m(S("D66SortType"),"ASC"),n=o)?u["$sort!"]():j(m(S("D66SortType"),"DESC"),n)&&u["$sort!"]()["$reverse!"](),K(F(u["$[]"](0),10),u["$[]"](1))},1),b.$private(),z(b,"$rand_inner",function(o){var u,a=this;return $(V(a.rand_results.$size(),S("UPPER_LIMIT_RANDS")))&&a.$raise(S("TooManyRandsError")),u=a.$random(o),a.rand_results["$<<"]([u,o]),u},1),z(b,"$random",function(o){return K(S("Kernel").$rand(o),1)},1),z(b,"$push_to_detail",function(o,a,u){var i;return i=S("DetailedRandResult").$new(o,a,u),this.detailed_rand_results.$push(i)},3),y(s[0],k("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var $,M,V,W,C,_,s,H,K,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,D=r.truthy;return $=U,M=K=[m(U[0],"BCDice")].concat($),V=H=[m(K[0],"DiceTable")].concat(M),C=[W=e(H[0],null,"RollResult")].concat(V),_=r.$r(C),(s=W.$$prototype).table_name=s.value=s.body=t,y(W,"$initialize",function(P,I,v){var b=this;return b.table_name=P,b.value=I,b.body=v},3),W.$attr_reader("table_name"),W.$attr_reader("value"),W.$attr_reader("body"),y(W,"$to_s",function(){var P=this;return P.table_name+"("+P.value+") \uff1e "+P.body},0),y(W,"$last_body",function(){var P=this;return D(P.body["$is_a?"](_("RollResult")))?P.body.$last_body():P.body},0),y(W,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var N,G,W,C,_,s,k,F,L,U=[],t=r.nil,m=r.module,e=r.klass,y=r.truthy,D=r.def,z=r.rb_minus;return N=U,G=L=[m(U[0],"BCDice")].concat(N),W=F=[m(L[0],"DiceTable")].concat(G),_=[C=e(F[0],null,"ChainTable")].concat(W),s=r.$r(_),(k=C.$$prototype).times=k.sides=k.items=k.name=t,D(C,"$initialize",function(I,v,b){var T=this,S=t;return T.name=I,T.items=b.$freeze(),S=/(\d+)D(\d+)/i.$match(v),y(S)||T.$raise(s("ArgumentError"),"Unexpected table type: "+v),T.times=S["$[]"](1).$to_i(),T.sides=S["$[]"](2).$to_i()},3),D(C,"$roll",function(I){var b,T,v=this,S=t;return b=I.$roll_sum(v.times,v.sides),T=z(b,v.times),S=v.items["$[]"](T),y(S["$respond_to?"]("roll"))&&(S=S.$roll(I)),s("RollResult").$new(v.name,b,S)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var M,j,s,k,P,I,v,W,H,U=[],t=r.nil,m=r.module,e=r.klass,y=r.hash2,D=r.defs,z=r.def,$=r.rb_plus,N=r.rb_times,K=r.rb_minus;return M=U,j=H=[m(U[0],"BCDice")].concat(M),s=W=[m(H[0],"DiceTable")].concat(j),P=[k=e(W[0],null,"D66GridTable")].concat(s),I=r.$r(P),(v=k.$$prototype).name=v.items=t,D(k,"$from_i18n",function(T,S){var f=t;return f=I("I18n").$t(T,y(["locale","raise"],{locale:S,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items"))},2),z(k,"$initialize",function(T,S){return this.name=T,this.items=S.$freeze()},2),z(k,"$roll",function(T){var c,f,o,a,u;return c=T.$roll_once(6),f=T.$roll_once(6),o=$(N(c,10),f),a=K(c,1),u=K(f,1),I("RollResult").$new(this.name,o,this.items["$[]"](a)["$[]"](u))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var K,H,_,s,k,P,j,V,M,t=[],m=r.nil,e=r.module,y=r.klass,D=r.hash2,z=r.defs,$=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=M=[e(t[0],"BCDice")].concat(K),j=[e(M[0],"DiceTable")].concat(H),V=r.$r(j),_=j,k=[s=y(j[0],V("D66GridTable"),"D66HalfGridTable")].concat(_),P=r.$r(k),z(s,"$from_i18n",function(v,b){var S=m;return S=P("I18n").$t(v,D(["locale","raise"],{locale:b,raise:!0})),this.$new(S["$[]"]("name"),S["$[]"]("items_1_2_3"),S["$[]"]("items_4_5_6"))},2),$(s,"$initialize",function(v,b,T){return this.name=v,this.items=[b,b,b,T,T,T].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var K,H,_,s,k,P,j,V,M,t=[],m=r.nil,e=r.module,y=r.klass,D=r.hash2,z=r.defs,$=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=M=[e(t[0],"BCDice")].concat(K),j=[e(M[0],"DiceTable")].concat(H),V=r.$r(j),_=j,k=[s=y(j[0],V("D66GridTable"),"D66OneThirdTable")].concat(_),P=r.$r(k),z(s,"$from_i18n",function(v,b){var S=m;return S=P("I18n").$t(v,D(["locale","raise"],{locale:b,raise:!0})),this.$new(S["$[]"]("name"),S["$[]"]("items_1_2"),S["$[]"]("items_3_4"),S["$[]"]("items_5_6"))},2),$(s,"$initialize",function(v,b,T,S){return this.name=v,this.items=[b,b,T,T,S,S].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var H,W,P,I,v,b,T,_,j,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,D=r.hash2,z=r.defs,$=r.def,N=r.eqeqeq,K=r.rb_plus,L=r.rb_times,M=r.truthy;return H=U,W=j=[e(U[0],"BCDice")].concat(H),P=_=[e(j[0],"DiceTable")].concat(W),v=[I=y(_[0],null,"D66Table")].concat(P),b=r.$r(v),(T=I.$$prototype).sort_type=T.items=T.name=t,z(I,"$from_i18n",function(c,f){var u,a=t;return a=b("I18n").$t(c,D(["locale"],{locale:f})),u=b("D66SortType").$const_get(a["$[]"]("d66_sort_type")),this.$new(a["$[]"]("name"),u,a["$[]"]("items"))},2),$(I,"$initialize",function(c,f,o){var a=this;return a.name=c,a.sort_type=f,a.items=o.$freeze()},3),$(I,"$roll",function(c){var f=this,o=t,a=t,u=t,n=t;return o=c.$roll_barabara(2,6),N(m(b("D66SortType"),"ASC"),a=f.sort_type)?o["$sort!"]():N(m(b("D66SortType"),"DESC"),a)&&o["$sort!"]()["$reverse!"](),u=K(L(o["$[]"](0),10),o["$[]"](1)),n=M(a=f.items["$[]"](u))?a:f.items["$[]"](u.$to_s()),M(n["$respond_to?"]("roll"))&&(n=n.$roll(c)),b("RollResult").$new(f.name,u,n)},1),$(I,"$choice",function(c){return b("RollResult").$new(this.name,c,this.items["$[]"](c))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var V,s,P,I,C,t=[],m=r.nil,e=r.module,y=r.klass,D=r.hash2,z=r.send,$=r.to_ary,N=r.rb_plus,K=r.rb_times,L=r.to_a,M=r.rb_minus,G=r.send2,H=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),V=t,s=C=[e(t[0],"BCDice")].concat(V),P=[e(C[0],"DiceTable")].concat(s),I=r.$r(P),F(y(P[0],I("D66Table"),"D66LeftRangeTable"),"$initialize",function S(c,f,o){var n;return delete S.$$p,n=D([],{}),z(o,"each",[],function(g){var B,E;return null==g&&(g=m),B=$(g),E=null==B[1]?m:B[1],z(null==B[0]?m:B[0],"each",[],function(l){return null==l&&(l=m),z(E,"each_with_index",[],function(d,O){var re,Q;return null==d&&(d=m),null==O&&(O=m),re=N(K(l,10),N(O,1)),z(n,"[]=",L(Q=[re,d])),Q[M(Q.length,1)]},2)},1)},1),G(this,H(this,"initialize",S,!1,!0),"initialize",[c,f,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var L,F,_,s,k,P,I,V,G,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,D=r.truthy,z=r.rb_minus,$=r.rb_plus,N=r.rb_times;return L=U,F=G=[m(U[0],"BCDice")].concat(L),_=V=[m(G[0],"DiceTable")].concat(F),k=[s=e(V[0],null,"D66ParityTable")].concat(_),P=r.$r(k),(I=s.$$prototype).odd=I.even=I.name=t,y(s,"$initialize",function(b,T,S){var c=this;return c.name=b,c.odd=T.$freeze(),c.even=S.$freeze()},3),y(s,"$roll",function(b){var c,o,a,T=this,S=t;return S=b.$roll_once(6),c=b.$roll_once(6),o=(D(S["$odd?"]())?T.odd:T.even)["$[]"](z(c,1)),a=$(N(S,10),c),P("RollResult").$new(T.name,a,o)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var K,H,C,_,s,k,P,j,M,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,D=r.rb_plus,z=r.rb_times,$=r.send;return K=U,H=M=[m(U[0],"BCDice")].concat(K),C=j=[m(M[0],"DiceTable")].concat(H),s=[_=e(j[0],null,"D66RangeTable")].concat(C),k=r.$r(s),(P=_.$$prototype).items=P.name=t,y(_,"$initialize",function(v,b){return this.name=v,this.items=b.$freeze()},2),y(_,"$roll",function(v){var T,S,c,f=t;return T=v.$roll_once(6),S=v.$roll_once(6),c=D(z(T,10),S),f=$(this.items,"find",[],function(a){return null==a&&(a=t),a["$[]"](0)["$include?"](c)},1),k("RollResult").$new(this.name,c,f["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,C,I,v,b,T,S,s,V,U=[],t=r.nil,m=r.module,e=r.klass,y=r.const_set,D=r.send,z=r.truthy,$=r.def,N=r.to_a,K=r.rb_minus,L=r.eqeqeq,M=r.rb_times,G=r.rb_plus;return F=U,C=V=[m(U[0],"BCDice")].concat(F),I=s=[m(V[0],"DiceTable")].concat(C),b=[v=e(s[0],null,"RangeTable")].concat(I),T=r.$r(b),(S=v.$$prototype).name=S.items=S.num_of_dice=S.num_of_sides=S.formatter=t,y(b[0],"RollResult",D(T("Struct"),"new",["sum","values","content","formatted"],function c(){return(null==c.$$s?this:c.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:v})),y(b[0],"Item",T("Struct").$new("range","content")),y(b[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),y(b[0],"DEFAULT_FORMATTER",D(v,"lambda",[],function(f,o){return null==f&&(f=t),null==o&&(o=t),f.$name()+"("+o.$sum()+") \uff1e "+o.$content()},2)),v.$attr_reader("name"),v.$attr_reader("num_of_dice"),v.$attr_reader("num_of_sides"),$(v,"$initialize",function c(f,o,a){var i,u=c.$$p||t,n=this,g=t;return delete c.$$p,n.name=f.$freeze(),n.formatter=z(i=u)?i:T("DEFAULT_FORMATTER"),g=T("DICE_ROLL_METHOD_RE").$match(o),z(g)||n.$raise(T("ArgumentError"),n.name+": invalid dice roll method: "+o),n.num_of_dice=g["$[]"](1).$to_i(),n.num_of_sides=g["$[]"](2).$to_i(),n.$store(a)},3),$(v,"$fetch",function(f){var a,o=this;return a=D(o.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](f)},1),z(a)||o.$raise(T("RangeError"),o.name+": value is out of range: "+f),a},1),$(v,"$roll",function(f){var u,n,i,o=this,a=t;return u=(a=f.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),n=T("RollResult").$new(u,a,o.$fetch(u).$content()),i=[o.formatter["$[]"](o,n)],D(n,"formatted=",N(i)),K(i.length,1),n},1),v.$private(),$(v,"$store",function(f){var a,u,o=this;return a=D(f,"map",[],function n(i,g){return null==i&&(i=t),null==g&&(g=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),g]},{$$arity:2,$$s:o}),u=D(a,"sort_by",[],function(i,g){return null==i&&(i=t),null==g&&(g=t),i.$min()},2),o.$assert_min_sum_is_covered(u),o.$assert_max_sum_is_covered(u),o.$assert_no_gap_or_overlap_in_ranges(u),o.items=D(u,"map",[],function(i,g){return null==i&&(i=t),null==g&&(g=t),T("Item").$new(i,g.$freeze()).$freeze()},2).$freeze(),o},1),$(v,"$coerce_to_int_range",function(f){var a;return L(T("Integer"),a=f)?T("Range").$new(f,f):L(T("Range"),a)&&z(f.$begin()["$is_a?"](T("Integer")))&&z(f.$end()["$is_a?"](T("Integer")))?f:this.$raise(T("TypeError"),this.name+": "+f+" ("+f.$class()+") must be an Integer or a Range with Integers ")},1),$(v,"$assert_min_sum_is_covered",function(f){var a,o=this,u=t;return a=o.num_of_dice,u=f.$first()["$[]"](0),z(u["$include?"](a))||o.$raise(T("RangeError"),o.name+": min value ("+a+") is not covered: "+u),o},1),$(v,"$assert_max_sum_is_covered",function(f){var a,o=this,u=t;return a=M(o.num_of_dice,o.num_of_sides),u=f.$last()["$[]"](0),z(u["$include?"](a))||o.$raise(T("RangeError"),o.name+": max value ("+a+") is not covered: "+u),o},1),$(v,"$assert_no_gap_or_overlap_in_ranges",function(f){return D(f,"each_cons",[2],function a(u,n){var h,w,i=null==a.$$s?this:a.$$s,g=t,B=t;return null==i.name&&(i.name=t),null==u&&(u=t),null==n&&(n=t),g=u["$[]"](0),B=n["$[]"](0),h=g.$max(),w=G(h,1),z(B["$include?"](h))&&i.$raise(T("RangeError"),i.name+": Range overlap: "+g+" and "+B),z(B["$include?"](w))?t:i.$raise(T("RangeError"),i.name+": Range gap: "+g+" and "+B)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var K,H,C,I,v,b,T,s,j,M,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,D=r.send,z=r.def,$=r.rb_minus;return K=U,H=M=[e(U[0],"BCDice")].concat(K),C=j=[e(M[0],"DiceTable")].concat(H),I=s=[y(j[0],null,"SaiFicSkillTable")].concat(C),b=[v=y(s[0],null,"Category")].concat(I),T=r.$r(b),v.$$prototype.name=t,z(v,"$initialize",function(f,o,a,u){var n=this;return n.name=f,n.skills=D(o.$map(),"with_index",[2],function(g,B){return null==g&&(g=t),null==B&&(B=t),m(T("SaiFicSkillTable"),"Skill").$new(f,g,a,B,u)},2),n.dice=a},4),z(v,"$roll",function(f){return this.$skills()["$[]"]($(f.$roll_sum(2,6),2))},1),z(v,"$to_s",function(){return this.name},0),v.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var $,M,V,k,P,C,H,K,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,D=r.hash2;return $=U,M=K=[m(U[0],"BCDice")].concat($),V=H=[m(K[0],"DiceTable")].concat(M),C=[e(H[0],null,"SaiFicSkillTable")].concat(V),(P=(k=e(C[0],null,"Skill")).$$prototype).s_format=P.category_dice=P.row_dice=P.category_name=P.name=t,y(k,"$initialize",function(v,b,T,S,c){var f=this;return f.category_name=v,f.name=b,f.category_dice=T,f.row_dice=S,f.s_format=c},5),y(k,"$to_s",function(){var v=this;return v.$format(v.s_format,D(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))},0),k.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var W,k,T,S,c,f,o,I,_,U=r.top,t=[],m=r.nil,e=r.$$$,y=r.module,D=r.klass,z=r.hash2,$=r.send,K=r.defs,L=r.const_set,M=r.to_ary,G=r.def,H=r.truthy,F=r.rb_minus,j=r.rb_plus;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),W=t,k=_=[y(t[0],"BCDice")].concat(W),T=I=[y(_[0],"DiceTable")].concat(k),c=[S=D(I[0],null,"SaiFicSkillTable")].concat(T),f=r.$r(c),(o=S.$$prototype).rtt=o.rtt_format=o.rct=o.rct_format=o.rttn=o.rttn_format=o.categories=m,K(S,"$from_i18n",function(u,n,i){var g,B,h,l,p=m;if(null==i)i=z([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(g=i.$$smap.rtt)&&(g=m),null==(B=i.$$smap.rct)&&(B=m),null==(h=i.$$smap.rttn)&&(h=m),l=(p=f("I18n").$t("RTT",z(["locale","raise","default"],{locale:n,raise:!1,default:z([],{})})).$merge(f("I18n").$t(u,z(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),p=$(p,"select",[],function(d,O){return null==d&&(d=m),null==O&&(O=m),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](d)},2),this.$new(l,r.to_hash(p).$merge(z(["rtt","rct","rttn"],{rtt:g,rct:B,rttn:h})))},-3),L(c[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),L(c[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),L(c[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),L(c[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),G(S,"$initialize",function(u,n){var i,g,B,h,w,E,p,l=this;if(null==n)n=z([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=m),null==(g=n.$$smap.rct)&&(g=m),null==(B=n.$$smap.rttn)&&(B=m),null==(h=n.$$smap.rtt_format)&&(h=f("DEFAULT_RTT")),null==(w=n.$$smap.rct_format)&&(w=f("DEFAULT_RCT")),null==(E=n.$$smap.rttn_format)&&(E=f("DEFAULT_RTTN")),null==(p=n.$$smap.s_format)&&(p=f("DEFAULT_S")),l.categories=$(u.$map(),"with_index",[1],function(d,O){var re,ie,Z;return null==d&&(d=m),null==O&&(O=m),ie=null==(re=M(d))[0]?m:re[0],Z=null==re[1]?m:re[1],e(f("SaiFicSkillTable"),"Category").$new(ie,Z,O,p)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),l.rtt=i,l.rct=g,l.rttn=B.$to_a(),l.rtt_format=h,l.rct_format=w,l.rttn_format=E},-2),L(c[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),S.$attr_reader("categories"),G(S,"$roll_command",function(u,n){var g,i=this,B=m,h=m;return H(["RTT",i.rtt]["$include?"](g=n))?i.$format_skill(i.rtt_format,i.$roll_skill(u)):H(["RCT",i.rct]["$include?"](g))?(B=i.$roll_category(u),i.$format(i.rct_format,z(["category_dice","category_name"],{category_dice:B.$dice(),category_name:B.$name()}))):H(h=f("RTTN").$index(g))||H(h=i.rttn.$index(g))?i.$format_skill(i.rttn_format,i.categories["$[]"](h).$roll(u)):m},2),G(S,"$roll_category",function(u){return this.categories["$[]"](F(u.$roll_once(6),1))},1),G(S,"$roll_skill",function(u){return this.$roll_category(u).$roll(u)},1),G(S,"$prefixes",function(){var u=this;return j(["RTT[1-6]?","RCT",u.rtt,u.rct],u.rttn).$compact()},0),S.$private(),G(S,"$format_skill",function(u,n){return this.$format(u,z(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var L,F,_,s,k,P,I,V,G,U=[],t=r.nil,m=r.module,e=r.klass,y=r.hash2,D=r.defs,z=r.truthy,$=r.def,N=r.rb_minus;return L=U,F=G=[m(U[0],"BCDice")].concat(L),_=V=[m(G[0],"DiceTable")].concat(F),k=[s=e(V[0],null,"Table")].concat(_),P=r.$r(k),(I=s.$$prototype).times=I.sides=I.name=I.items=t,D(s,"$from_i18n",function(b,T){var c=t;return c=P("I18n").$t(b,y(["locale"],{locale:T})),this.$new(c["$[]"]("name"),c["$[]"]("type"),c["$[]"]("items"))},2),$(s,"$initialize",function(b,T,S){var c=this,f=t;return c.name=b,c.items=S.$freeze(),f=/(\d+)D(\d+)/i.$match(T),z(f)||c.$raise(P("ArgumentError"),"Unexpected table type: "+T),c.times=f["$[]"](1).$to_i(),c.sides=f["$[]"](2).$to_i()},3),$(s,"$roll",function(b){var S,T=this;return S=b.$roll_sum(T.times,T.sides),T.$choice(S)},1),$(s,"$choice",function(b){var S,T=this;return S=N(b,T.times),P("RollResult").$new(T.name,b,T.items["$[]"](S))},1)},Opal.modules["bcdice/dice_table"]=function(r){var U=r.top;return U.$require("bcdice/dice_table/roll_result"),U.$require("bcdice/dice_table/chain_table"),U.$require("bcdice/dice_table/d66_grid_table"),U.$require("bcdice/dice_table/d66_half_grid_table"),U.$require("bcdice/dice_table/d66_one_third_table"),U.$require("bcdice/dice_table/d66_left_range_table"),U.$require("bcdice/dice_table/d66_parity_table"),U.$require("bcdice/dice_table/d66_range_table"),U.$require("bcdice/dice_table/d66_table"),U.$require("bcdice/dice_table/range_table"),U.$require("bcdice/dice_table/sai_fic_skill_table"),U.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var D,K,M,$,U=[],m=r.module,e=r.const_set;return D=U,K=$=[m(U[0],"BCDice")].concat(D),M=[m($[0],"D66SortType")].concat(K),e(M[0],"NO_SORT","no_sort"),e(M[0],"ASC","asc"),e(M[0],"DESC","desc"),function(N,K){var M=[m(N,"RoundType")].concat(K);return e(M[0],"CEIL","ceil"),e(M[0],"FLOOR","floor"),e(M[0],"ROUND","round")}($[0],$)},Opal.modules["bcdice/translate"]=function(r){var $,M,G,H,F,K,U=[],t=r.nil,m=r.module,e=r.hash2,D=r.def;return $=U,M=K=[m(U[0],"BCDice")].concat($),H=[G=m(K[0],"Translate")].concat(M),F=r.$r(H),D(G,"$translate",function(V,W){var C,_=this;if(null==_.locale&&(_.locale=t),null==W)W=e([],{});else if(!W.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return C=r.kwrestargs(W,{}),F("I18n").$translate(V,e(["locale","raise"],{locale:_.locale,raise:!0}).$merge(r.to_hash(C)))},-2)},Opal.modules["bcdice/result"]=function(r){var K,F,C,j,W,M,U=[],t=r.nil,e=r.klass,y=r.send,D=r.to_a,z=r.rb_minus,$=r.def;return K=U,F=M=[(0,r.module)(U[0],"BCDice")].concat(K),[j=e(M[0],null,"Result")].concat(F),(W=j.$$prototype).secret=W.success=W.failure=W.critical=W.fumble=t,$(C=r.get_singleton_class(j),"$success",function(k){return y(this.$new(),"tap",[],function(v){var b=t;return null==v&&(v=t),y(v,"text=",D(b=[k])),z(b.length,1),y(v,"success=",D(b=[!0])),b[z(b.length,1)]},1)},1),$(C,"$failure",function(k){return y(this.$new(),"tap",[],function(v){var b=t;return null==v&&(v=t),y(v,"text=",D(b=[k])),z(b.length,1),y(v,"failure=",D(b=[!0])),b[z(b.length,1)]},1)},1),$(C,"$critical",function(k){return y(this.$new(),"tap",[],function(v){var b=t;return null==v&&(v=t),y(v,"text=",D(b=[k])),z(b.length,1),y(v,"critical=",D(b=[!0])),z(b.length,1),y(v,"success=",D(b=[!0])),b[z(b.length,1)]},1)},1),$(C,"$fumble",function(k){return y(this.$new(),"tap",[],function(v){var b=t;return null==v&&(v=t),y(v,"text=",D(b=[k])),z(b.length,1),y(v,"fumble=",D(b=[!0])),z(b.length,1),y(v,"failure=",D(b=[!0])),b[z(b.length,1)]},1)},1),$(C,"$nothing",function(){return"nothing"},0),$(j,"$initialize",function(_){var s=this;return null==_&&(_=t),s.text=_,s.rands=t,s.detailed_rands=t,s.secret=!1,s.success=!1,s.failure=!1,s.critical=!1,s.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),$(j,"$secret?",function(){return this.secret},0),$(j,"$success?",function(){return this.success},0),$(j,"$failure?",function(){return this.failure},0),$(j,"$critical?",function(){return this.critical},0),$(j,"$fumble?",function(){return this.fumble},0),$(j,"$condition=",function(_){return this.success=_,this.failure=_["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var T,c,f,t=[],m=r.$r(t),e=r.nil,y=r.$$$,D=r.module,z=r.klass,$=r.truthy,N=r.const_set,K=r.defs,L=r.gvars,M=r.rb_lt,G=r.send,H=r.to_a,F=r.rb_minus,j=r.def,V=r.to_ary,W=r.neqeq,C=r.rb_plus,_=r.eqeq,s=r.rb_ge,k=r.rb_gt,P=r.eqeqeq,I=r.rb_le,v=r.rb_times;return T=t,c=[D(t[0],"Racc")].concat(T),f=r.$r(c),z(c[0],f("StandardError"),"ParseError"),$(y("::","ParseError","skip_raise")?"constant":e)||N(t[0],"ParseError",y(m("Racc"),"ParseError")),function(b,T){var n,i,g,B,h,f=[D(b,"Racc")].concat(T),o=r.$r(f);return $(o("Racc_No_Extensions","skip_raise")?"constant":e)||N(f[0],"Racc_No_Extensions",!1),n=f,g=[i=z(f[0],null,"Parser")].concat(n),B=r.$r(g),(h=i.$$prototype).yydebug=h.racc_debug_out=h.racc_error_status=h.racc_t=h.racc_vstack=h.racc_val=h.racc_state=h.racc_tstack=e,N(g[0],"Racc_Runtime_Version","1.4.6"),N(g[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),N(g[0],"Racc_Runtime_Core_Version_R","1.4.6"),N(g[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),N(g[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),N(g[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),N(g[0],"Racc_Runtime_Core_Version",B("Racc_Runtime_Core_Version_R")),N(g[0],"Racc_Runtime_Core_Revision",B("Racc_Runtime_Core_Revision_R")),N(g[0],"Racc_Runtime_Type","ruby"),K(B("Parser"),"$racc_runtime_type",function(){return B("Racc_Runtime_Type")},0),j(i,"$_racc_setup",function(){var E,p,l=this,A=e,d=e,O=e;return null==L.stderr&&(L.stderr=e),$(y(l.$class(),"Racc_debug_parser"))||(l.yydebug=!1),$(null!=(E=l.yydebug)&&E!==e?"instance-variable":e)||(l.yydebug=!1),$(l.yydebug)&&($(null!=(p=l.racc_debug_out)&&p!==e?"instance-variable":e)||(l.racc_debug_out=L.stderr),l.racc_debug_out=$(A=l.racc_debug_out)?A:L.stderr),d=y(l.$class(),"Racc_arg"),$(M(d.$size(),14))&&(G(d,"[]=",H(O=[13,!0])),F(O.length,1)),d},0),j(i,"$_racc_init_sysvars",function(){var E=this;return E.racc_state=[0],E.racc_tstack=[],E.racc_vstack=[],E.racc_t=e,E.racc_val=e,E.racc_read_next=!0,E.racc_user_yyerror=!1,E.racc_error_status=0},0),j(i,"$do_parse",function(){return this.$__send__(B("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j(i,"$next_token",function(){return this.$raise(B("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j(i,"$_racc_do_parse_rb",function(E,p){var l,d=this,O=e,re=e,Q=e,ie=e,X=e,x=e,J=e,R=e;return l=V(E),O=null==l[0]?e:l[0],re=null==l[1]?e:l[1],Q=null==l[2]?e:l[2],ie=null==l[3]?e:l[3],X=null==l[10]?e:l[10],d.$_racc_init_sysvars(),x=J=R=e,G(d,"catch",["racc_end_parse"],function q(){var ae,ee,Y=null==q.$$s?this:q.$$s,ce=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);$(!0);)for($(R=ie["$[]"](Y.racc_state["$[]"](-1)))?($(Y.racc_read_next)&&W(Y.racc_t,0)&&(ee=Y.$next_token(),ae=V(ee),x=null==ae[0]?e:ae[0],Y.racc_val=null==ae[1]?e:ae[1],Y.racc_t=$(x)?$(ce=X["$[]"](x))?ce:1:0,$(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,x,Y.racc_val),Y.racc_read_next=!1),R=C(R,Y.racc_t),$(s(R,0))&&$(J=O["$[]"](R))&&_(re["$[]"](R),Y.racc_state["$[]"](-1))||(J=Q["$[]"](Y.racc_state["$[]"](-1)))):J=Q["$[]"](Y.racc_state["$[]"](-1));$(J=Y.$_racc_evalact(J,E)););},{$$arity:0,$$s:d})},2),j(i,"$yyparse",function(E,p){return this.$__send__(B("Racc_YY_Parse_Method"),E,p,this.$_racc_setup(),!0)},2),j(i,"$_racc_yyparse_rb",function(E,p,l,A){var d,Q=e,ie=e,Z=e,X=e,J=e,R=e,q=e;return d=V(l),Q=null==d[0]?e:d[0],ie=null==d[1]?e:d[1],Z=null==d[2]?e:d[2],X=null==d[3]?e:d[3],J=null==d[10]?e:d[10],this.$_racc_init_sysvars(),R=e,q=e,G(this,"catch",["racc_end_parse"],function ne(){var Y=null==ne.$$s?this:ne.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!$(q=X["$[]"](Y.racc_state["$[]"](-1)));)for(;$(R=Y.$_racc_evalact(Z["$[]"](Y.racc_state["$[]"](-1)),l)););return G(E,"__send__",[p],function ce(se,le){var $e=null==ce.$$s?this:ce.$$s,te=e,oe=e;for(null==$e.racc_t&&($e.racc_t=e),null==$e.racc_state&&($e.racc_state=e),null==$e.racc_read_next&&($e.racc_read_next=e),null==se&&(se=e),null==le&&(le=e),$e.racc_t=$(se)?$(te=J["$[]"](se))?te:1:0,$e.racc_val=le,$e.racc_read_next=!1,q=C(q,$e.racc_t),$(s(q,0))&&$(R=Q["$[]"](q))&&_(ie["$[]"](q),$e.racc_state["$[]"](-1))||(R=Z["$[]"]($e.racc_state["$[]"](-1)));$(R=$e.$_racc_evalact(R,l)););for(;$($(te=$(oe=(q=X["$[]"]($e.racc_state["$[]"](-1)))["$!"]())?oe:$e.racc_read_next["$!"]())?te:$e.racc_t["$=="](0));)for($(q)&&$(q=C(q,$e.racc_t))&&$(s(q,0))&&$(R=Q["$[]"](q))&&_(ie["$[]"](q),$e.racc_state["$[]"](-1))||(R=Z["$[]"]($e.racc_state["$[]"](-1)));$(R=$e.$_racc_evalact(R,l)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),j(i,"$_racc_evalact",function(E,p){var l,Z,d=this,O=e,re=e,ie=e,X=e,x=e,J=e,R=e;if(O=null==(l=V(p))[0]?e:l[0],re=null==l[1]?e:l[1],ie=null==l[3]?e:l[3],Z=null==l[11]?e:l[11],X=null==l[12]?e:l[12],$(k(E,0))&&$(M(E,Z)))$(k(d.racc_error_status,0))&&(_(d.racc_t,1)||(d.racc_error_status=F(d.racc_error_status,1))),d.racc_vstack.$push(d.racc_val),d.racc_state.$push(E),d.racc_read_next=!0,$(d.yydebug)&&(d.racc_tstack.$push(d.racc_t),d.$racc_shift(d.racc_t,d.racc_tstack,d.racc_vstack));else if($(M(E,0))&&$(k(E,X["$-@"]()))){if(x=G(d,"catch",["racc_jump"],function q(){var ne=null==q.$$s?this:q.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(p,E)),!1},{$$arity:0,$$s:d}),$(x)){if(P(1,J=x))return d.racc_user_yyerror=!0,X["$-@"]();if(P(2,J))return Z;d.$raise("[Racc Bug] unknown jump code")}}else if(_(E,Z))$(d.yydebug)&&d.$racc_accept(),d.$throw("racc_end_parse",d.racc_vstack["$[]"](0));else{if(_(E,X["$-@"]())){for(P(0,J=d.racc_error_status)?$(p["$[]"](21))||d.$on_error(d.racc_t,d.racc_val,d.racc_vstack):P(3,J)&&(_(d.racc_t,0)&&d.$throw("racc_end_parse",e),d.racc_read_next=!0),d.racc_user_yyerror=!1,d.racc_error_status=3;$(!0)&&!($(R=ie["$[]"](d.racc_state["$[]"](-1)))&&(R=C(R,1),$(s(R,0))&&$(E=O["$[]"](R))&&_(re["$[]"](R),d.racc_state["$[]"](-1))));)$(I(d.racc_state.$size(),1))&&d.$throw("racc_end_parse",e),d.racc_state.$pop(),d.racc_vstack.$pop(),$(d.yydebug)&&(d.racc_tstack.$pop(),d.$racc_e_pop(d.racc_state,d.racc_tstack,d.racc_vstack));return E}d.$raise("[Racc Bug] unknown action "+E.$inspect())}return $(d.yydebug)&&d.$racc_next_state(d.racc_state["$[]"](-1),d.racc_state),e},2),j(i,"$_racc_do_reduce",function(E,p){var l,X,J,Y,ce,se,$e,d=this,re=e,Q=e,ie=e,Z=e,x=e,R=e,q=e,ne=e,ae=e,ee=e,le=e,_e=e,ue=e,te=e;return re=null==(l=V(E))[4]?e:l[4],Q=null==l[5]?e:l[5],ie=null==l[6]?e:l[6],Z=null==l[7]?e:l[7],X=null==l[8]?e:l[8],x=null==l[9]?e:l[9],J=null==l[13]?e:l[13],R=d.racc_state,q=d.racc_vstack,ne=d.racc_tstack,ae=v(p,-3),ee=x["$[]"](ae),Y=x["$[]"](C(ae,1)),ce=x["$[]"](C(ae,2)),se=[],$(d.yydebug)&&(le=ne["$[]"](ee["$-@"](),ee)),_e=q["$[]"](ee["$-@"](),ee),$(d.yydebug)&&(ue=[ee["$-@"](),ee,se],G(ne,"[]=",H(ue)),F(ue.length,1)),ue=[ee["$-@"](),ee,se],G(q,"[]=",H(ue)),F(ue.length,1),ue=[ee["$-@"](),ee,se],G(R,"[]=",H(ue)),F(ue.length,1),$(J)?q.$push(d.$__send__(ce,_e,q,_e["$[]"](0))):q.$push(d.$__send__(ce,_e,q)),ne.$push(Y),$(d.yydebug)&&d.$racc_reduce(le,Y,ne,q),$e=F(Y,X),$(ae=Z["$[]"]($e))&&(ae=C(ae,R["$[]"](-1)),$(s(ae,0))&&$(te=re["$[]"](ae))&&_(Q["$[]"](ae),$e))?te:ie["$[]"]($e)},2),j(i,"$on_error",function(E,p,l){var d,A=this;return A.$raise(B("ParseError"),A.$sprintf("\nparse error on value %s (%s)",p.$inspect(),$(d=A.$token_to_str(E))?d:"?"))},3),j(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j(i,"$yyerrok",function(){return this.racc_error_status=0},0),j(i,"$racc_read_token",function(E,p,l){var A=this;return A.racc_debug_out.$print("read    "),A.racc_debug_out.$print(p.$inspect(),"(",A.$racc_token2str(E),") "),A.racc_debug_out.$puts(l.$inspect()),A.racc_debug_out.$puts()},3),j(i,"$racc_shift",function(E,p,l){var A=this;return A.racc_debug_out.$puts("shift   "+A.$racc_token2str(E)),A.$racc_print_stacks(p,l),A.racc_debug_out.$puts()},3),j(i,"$racc_reduce",function(E,p,l,A){var d=this,O=e;return(O=d.racc_debug_out).$print("reduce "),$(E["$empty?"]())?O.$print(" <none>"):G(E,"each",[],function re(Q){return null==Q&&(Q=e),O.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(Q))},{$$arity:1,$$s:d}),O.$puts(" --\x3e "+d.$racc_token2str(p)),d.$racc_print_stacks(l,A),d.racc_debug_out.$puts()},4),j(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j(i,"$racc_e_pop",function(E,p,l){var A=this;return A.racc_debug_out.$puts("error recovering mode: pop token"),A.$racc_print_states(E),A.$racc_print_stacks(p,l),A.racc_debug_out.$puts()},3),j(i,"$racc_next_state",function(E,p){var l=this;return l.racc_debug_out.$puts("goto    "+E),l.$racc_print_states(p),l.racc_debug_out.$puts()},2),j(i,"$racc_print_stacks",function(E,p){var A=e;return(A=this.racc_debug_out).$print("        ["),G(E,"each_index",[],function d(O){return null==O&&(O=e),A.$print(" (",(null==d.$$s?this:d.$$s).$racc_token2str(E["$[]"](O))," ",p["$[]"](O).$inspect(),")")},{$$arity:1,$$s:this}),A.$puts(" ]")},2),j(i,"$racc_print_states",function(E){var l=e;return(l=this.racc_debug_out).$print("        ["),G(E,"each",[],function(d){return null==d&&(d=e),l.$print(" ",d)},1),l.$puts(" ]")},1),j(i,"$racc_token2str",function(E){var l;return $(l=y(this.$class(),"Racc_token_to_s_table")["$[]"](E))?l:this.$raise("[Racc Bug] can't convert token "+E+" to string")},1),j(i,"$token_to_str",function(E){return y(this.$class(),"Racc_token_to_s_table")["$[]"](E)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var F,C,P,c,f,v,b,s,V,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,D=r.def,z=r.send2,$=r.find_super,N=r.eqeq,K=r.const_set,L=r.eqeqeq,M=r.rb_divide,G=r.alias;return F=U,C=V=[e(U[0],"BCDice")].concat(F),P=s=[e(V[0],"Arithmetic")].concat(C),v=[e(s[0],"Node")].concat(P),b=r.$r(v),(f=(c=y(v[0],null,"BinaryOp")).$$prototype).lhs=f.rhs=f.op=t,D(c,"$initialize",function(a,u,n){var i=this;return i.lhs=a,i.op=u,i.rhs=n},3),D(c,"$eval",function(a){var i,u=this,n=t;return n=u.lhs.$eval(a),i=u.rhs.$eval(a),n.$send(u.op,i)},1),D(c,"$output",function(){var a=this;return""+a.lhs.$output()+a.op+a.rhs.$output()},0),D(c,"$s_exp",function(){var a=this;return"("+a.$op_for_s_exp()+" "+a.lhs.$s_exp()+" "+a.rhs.$s_exp()+")"},0),D(c,"$op_for_s_exp",function(){return this.op},0),function(T,S,c){var f=y(T,S,"DivideBase"),o=[f].concat(c),a=r.$r(o),u=f.$$prototype;u.lhs=u.rhs=u.op=t,D(f,"$initialize",function n(i,g){return delete n.$$p,z(this,$(this,"initialize",n,!1,!0),"initialize",[i,"/",g],null)},2),D(f,"$eval",function(i){var B,h,g=this;return B=g.lhs.$eval(i),h=g.rhs.$eval(i),N(h,0)&&g.$raise(a("ZeroDivisionError")),g.$divide_and_round(B,h,i)},1),D(f,"$output",function n(){var i=n.$$p||t,g=this;return delete n.$$p,""+z(g,$(g,"output",n,!1,!0),"output",[],i)+g.$rounding_method()},0),f.$private(),D(f,"$rounding_method",function(){return m(this.$class(),"ROUNDING_METHOD")},0),D(f,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),D(f,"$divide_and_round",function(i,g,B){return this.$raise(a("NotImplementedError"))},3)}(v[0],b("BinaryOp"),v),function(T,S,c){var f=y(T,S,"DivideWithGameSystemDefault"),o=[f].concat(c),a=r.$r(o);K(o[0],"ROUNDING_METHOD",""),f.$private(),D(f,"$divide_and_round",function(n,i,g){var B;return L(m(a("RoundType"),"CEIL"),B=g)?M(n.$to_f(),i).$ceil():L(m(a("RoundType"),"ROUND"),B)?M(n.$to_f(),i).$round():M(n,i).$floor()},3)}(v[0],b("DivideBase"),v),function(T,S,c){var f=y(T,S,"DivideWithCeil"),o=[f].concat(c);K(o[0],"ROUNDING_METHOD","C"),f.$private(),D(f,"$divide_and_round",function(u,n,i){return M(u.$to_f(),n).$ceil()},3)}(v[0],b("DivideBase"),v),function(T,S,c){var f=y(T,S,"DivideWithRound"),o=[f].concat(c);K(o[0],"ROUNDING_METHOD","R"),f.$private(),D(f,"$divide_and_round",function(u,n,i){return M(u.$to_f(),n).$round()},3)}(v[0],b("DivideBase"),v),function(T,S,c){var f=y(T,S,"DivideWithFloor"),o=[f].concat(c);K(o[0],"ROUNDING_METHOD","F"),f.$private(),D(f,"$divide_and_round",function(u,n,i){return M(u,n).$to_i()},3)}(v[0],b("DivideBase"),v),function(T,S){var c=y(T,null,"Negative");c.$$prototype.body=t,D(c,"$initialize",function(a){return this.body=a},1),D(c,"$eval",function(a){return this.body.$eval(a)["$-@"]()},1),D(c,"$output",function(){return"-"+this.body.$output()},0),D(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(v[0]),function(T,S){var c=y(T,null,"Parenthesis");c.$$prototype.expr=t,D(c,"$initialize",function(a){return this.expr=a},1),D(c,"$eval",function(a){return this.expr.$eval(a)},1),D(c,"$output",function(){return"("+this.expr.$output()+")"},0),D(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(v[0]),function(T,S){var c=y(T,null,"Number");return c.$$prototype.value=t,D(c,"$initialize",function(a){return this.value=a},1),D(c,"$eval",function(a){return this.value},1),D(c,"$output",function(){return this.value.$to_s()},0),G(c,"s_exp","output")}(v[0])},Opal.modules.strscan=function(r){var H,F,j,V,W,U=[],t=r.nil,e=r.def,y=r.truthy,D=r.eqeqeq,z=r.Opal,$=r.send,N=r.to_a,K=r.rb_minus,L=r.alias;return H=U,j=[F=(0,r.klass)(U[0],null,"StringScanner")].concat(H),V=r.$r(j),(W=F.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=t,F.$attr_reader("pos","matched"),e(F,"$initialize",function(_){var s=this;return s.string=_,s.pos=0,s.matched=t,s.working=_,s.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},0),e(F,"$scan",function(_){var s=this,k=(_=s.$anchor(_)).exec(s.working);return null==k?s.matched=t:"object"==typeof k?(s.prev_pos=s.pos,s.pos+=k[0].length,s.working=s.working.substring(k[0].length),s.matched=k[0],s.match=k,k[0]):"string"==typeof k?(s.pos+=k.length,s.working=s.working.substring(k.length),k):t},1),e(F,"$scan_until",function(_){var s=this;_=s.$anchor(_);for(var I,k=s.pos,P=s.working;;){if(I=_.exec(P),k+=1,P=P.substr(1),null!=I)return s.matched=s.string.substr(s.pos,k-s.pos-1+I[0].length),s.match=I,s.prev_pos=k-1,s.pos=k,s.working=P.substr(I[0].length),s.matched;if(0===P.length)return s.match=[],s.matched=t}},1),e(F,"$[]",function(_){var k;if(y(this.match["$empty?"]()))return t;D(V("Symbol"),k=_)?_=_.$to_s():D(V("String"),k)||(_=z["$coerce_to!"](_,V("Integer"),"to_int"));var P=this.match;return _<0&&(_+=P.length),_<0||_>=P.length||null==P[_]?t:P[_]},1),e(F,"$check",function(_){var s=this,k=(_=s.$anchor(_)).exec(s.working);return s.matched=null==k?t:k[0]},1),e(F,"$check_until",function(_){var s=this,k=s.prev_pos,P=s.pos,I=s.$scan_until(_);return I!==t&&(s.matched=I.substr(-1),s.working=s.string.substr(P)),s.prev_pos=k,s.pos=P,I},1),e(F,"$peek",function(_){return this.working.substring(0,_)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(_){var k=_.exec(this.working);return null==k?t:0==k.index?0:k.index+1},1),e(F,"$skip",function(_){var s=this,k=(_=s.$anchor(_)).exec(s.working);if(null==k)return s.match=[],s.matched=t;var P=k[0],I=P.length;return s.matched=P,s.match=k,s.prev_pos=s.pos,s.pos+=I,s.working=s.working.substring(I),I},1),e(F,"$skip_until",function(_){var k=this.$scan_until(_);return k===t?t:(this.matched=k.substr(-1),k.length)},1),e(F,"$get_byte",function(){var _=this,s=t;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,s=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=t,s},0),e(F,"$match?",function(_){var s=this,k=(_=s.$anchor(_)).exec(s.working);return null==k?t:(s.prev_pos=s.pos,k[0].length)},1),e(F,"$pos=",function(_){var s=this;return _<0&&(_+=s.string.$length()),s.pos=_,s.working=s.string.slice(_)},1),e(F,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(F,"$post_match",function(){var _=this;return _.matched===t?t:_.string.substr(_.pos)},0),e(F,"$pre_match",function(){var _=this;return _.matched===t?t:_.string.substr(0,_.prev_pos)},0),e(F,"$reset",function(){var _=this;return _.working=_.string,_.matched=t,_.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var s,_=this;return _.match=t,s=[_.string.$length()],$(_,"pos=",N(s)),s[K(s.length,1)]},0),e(F,"$unscan",function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=t,_.match=t,_},0),L(F,"bol?","beginning_of_line?"),L(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(_){var s=_.toString().match(/\/([^\/]+)$/);return s=s?s[1]:void 0,new RegExp("^(?:"+_.source+")",s)},1)},Opal.modules["bcdice/normalize"]=function(r){var $,M,K,U=[],t=r.nil,m=r.module,e=r.eqeqeq,y=r.def,D=r.eqeq;return $=U,K=[m(U[0],"BCDice")].concat($),(M=m(K[0],"Normalize")).$module_function(),y(M,"$comparison_operator",function(H){var F;return e(/<=|=</,F=H)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":t},1),y(M,"$target_number",function(H){return D(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var M,j,s,k,P,I,v,W,H,U=r.top,t=[],m=r.nil,e=r.module,y=r.klass,D=r.const_set,z=r.hash2,$=r.truthy,N=r.send,K=r.def;return U.$require("strscan"),U.$require("bcdice/normalize"),M=t,j=H=[e(t[0],"BCDice")].concat(M),s=W=[e(H[0],"Command")].concat(j),P=[k=y(W[0],null,"Lexer")].concat(s),I=r.$r(P),(v=k.$$prototype).scanner=v.notations=m,D(P[0],"SYMBOLS",z(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(k,"$initialize",function(T,S){var c,f,a;return T=$(a=(f=(c=T)===m||null==c?m:N(c,"split",[" ",2]))===m||null==f?m:N(f,"first",[]))?a:"",this.scanner=I("StringScanner").$new(T),this.notations=N(S,"map",[],function(n){return null==n&&(n=m),$(n["$is_a?"](I("String")))?I("Regexp").$new(n):n},1)},2),K(k,"$next_token",function(){try{var T=this,S=m,c=m,o=m,a=m;return $(T.scanner["$eos?"]())?[!1,"$"]:(N(T.notations,"each",[],function u(n){var g,i=null==u.$$s?this:u.$$s;if(null==i.scanner&&(i.scanner=m),null==n&&(n=m),g=i.scanner.$scan(n),!$(g))return m;r.ret(["NOTATION",g])},{$$arity:1,$$s:T}),$(S=T.scanner.$scan(/\d+/))?["NUMBER",S.$to_i()]:$(c=T.scanner.$scan(/[<>!=]+/))?(c=I("Normalize").$comparison_operator(c),[$(c)?"CMP_OP":"ILLEGAL",c]):(o=T.scanner.$getch().$upcase(),[$(a=I("SYMBOLS")["$[]"](o))?a:o.$to_sym(),o]))}catch(u){if(u===r.returner)return u.$v;throw u}},0),K(k,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var N,G,W,C,_,s,k,F,L,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,D=r.truthy,z=r.eqeqeq;return N=U,G=L=[m(U[0],"BCDice")].concat(N),W=F=[m(L[0],"Command")].concat(G),_=[C=e(F[0],null,"Parsed")].concat(W),s=r.$r(_),(k=C.$$prototype).question_target=k.critical=k.fumble=k.dollar=k.modify_number=k.target_number=k.prefix_number=k.command=k.suffix_number=k.cmp_op=t,C.$attr_accessor("command"),C.$attr_accessor("prefix_number"),C.$attr_accessor("suffix_number"),C.$attr_accessor("critical"),C.$attr_accessor("fumble"),C.$attr_accessor("dollar"),C.$attr_accessor("modify_number"),C.$attr_accessor("cmp_op"),C.$attr_accessor("target_number"),C.$attr_writer("question_target"),y(C,"$initialize",function(){var I=this;return I.prefix_number=t,I.suffix_number=t,I.critical=t,I.fumble=t,I.dollar=t,I.cmp_op=t,I.target_number=t,I.question_target=!1},0),y(C,"$question_target?",function(){return this.question_target},0),y(C,"$to_s",function(I){var o,v=this,b=t,T=t,S=t,c=t,f=t;return null==I&&(I="after_command"),b=D(v.critical)?"@"+v.critical:t,T=D(v.fumble)?"#"+v.fumble:t,S=D(v.dollar)?"$"+v.dollar:t,c=s("Format").$modifier(v.modify_number),f=D(v.question_target)?"?":v.target_number,z("after_command",o=I)?[v.prefix_number,v.command,v.suffix_number,b,T,S,c,v.cmp_op,f].$join():z("after_modify_number",o)?[v.prefix_number,v.command,v.suffix_number,c,b,T,S,v.cmp_op,f].$join():z("after_target_number",o)?[v.prefix_number,v.command,v.suffix_number,c,v.cmp_op,f,b,T,S].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var s,v,o,i,g,B,h,w,E,p,l,A,re,a,u,n,Z,T,S,P,U=r.top,t=[],m=r.$r(t),e=r.nil,y=r.$$$,D=r.klass,z=r.module,$=r.hash2,N=r.send2,K=r.find_super,L=r.def,M=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeq,j=r.hash,V=r.const_set,W=r.truthy,C=r.to_ary;return U.$require("racc/parser.rb"),U.$require("bcdice/arithmetic/node"),U.$require("bcdice/command/lexer"),U.$require("bcdice/command/parsed"),D(y(m("BCDice"),"Command"),y(m("Racc"),"Parser"),"Parser"),s=t,v=P=[z(t[0],"BCDice")].concat(s),T=[z(P[0],"Command")].concat(v),S=r.$r(T),o=T,u=[a=D(T[0],y(S("Racc"),"Parser"),"Parser")].concat(o),n=r.$r(u),(Z=a.$$prototype).notations=Z.lexer=Z.modifier=Z.suffix_number=Z.prefix_number=Z.need_suffix_number=Z.need_prefix_number=Z.critical=Z.fumble=Z.dollar=Z.allowed_cmp_op=Z.question_target=e,L(a,"$initialize",function X(x,J){var R,q,ne,ae,Y=this;if(delete X.$$p,R=r.slice.call(arguments),null==(q=r.extract_kwargs(R)))q=$([],{});else if(!q.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=R,!r.hasOwnProperty.call(q.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return ae=q.$$smap.round_type,N(Y,K(Y,"initialize",X,!1,!0),"initialize",[],null),Y.notations=ne,Y.round_type=ae,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),L(a,"$disable_modifier",function(){return this.modifier=!1,this},0),L(a,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),L(a,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),L(a,"$has_prefix_number",function(){var x=this;return x.prefix_number=!0,x.need_prefix_number=!0,x},0),L(a,"$has_suffix_number",function(){var x=this;return x.suffix_number=!0,x.need_suffix_number=!0,x},0),L(a,"$enable_critical",function(){return this.critical=!0,this},0),L(a,"$enable_fumble",function(){return this.fumble=!0,this},0),L(a,"$enable_dollar",function(){return this.dollar=!0,this},0),L(a,"$restrict_cmp_op_to",function(x){var J,q=this;return J=r.slice.call(arguments),q.allowed_cmp_op=J,q},-1),L(a,"$enable_question_target",function(){return this.question_target=!0,this},0),L(a,"$parse",function(x){var J=this;try{return J.lexer=n("Lexer").$new(x,J.notations),J.$do_parse()}catch(R){if(!r.rescue(R,[n("ParseError"),n("ZeroDivisionError")]))throw R;try{return e}finally{r.pop_exception()}}},1),a.$private(),L(a,"$parsed",function(x,J,R,q){return M(n("Parsed").$new(),"tap",[],function ae(ee){var Y,ce,se,le,_e,ue,$e=null==ae.$$s?this:ae.$$s,te=e;return null==$e.round_type&&($e.round_type=e),null==ee&&(ee=e),te=[x["$[]"]("command")],M(ee,"command=",G(te)),H(te.length,1),te=[(Y=x["$[]"]("prefix"),Y===e||null==Y?e:M(Y,"eval",[$e.round_type]))],M(ee,"prefix_number=",G(te)),H(te.length,1),te=[(ce=x["$[]"]("suffix"),ce===e||null==ce?e:M(ce,"eval",[$e.round_type]))],M(ee,"suffix_number=",G(te)),H(te.length,1),te=[(se=J["$[]"]("critical"),se===e||null==se?e:M(se,"eval",[$e.round_type]))],M(ee,"critical=",G(te)),H(te.length,1),te=[(le=J["$[]"]("fumble"),le===e||null==le?e:M(le,"eval",[$e.round_type]))],M(ee,"fumble=",G(te)),H(te.length,1),te=[(_e=J["$[]"]("dollar"),_e===e||null==_e?e:M(_e,"eval",[$e.round_type]))],M(ee,"dollar=",G(te)),H(te.length,1),te=[R.$eval($e.round_type)],M(ee,"modify_number=",G(te)),H(te.length,1),te=[q["$[]"]("cmp_op")],M(ee,"cmp_op=",G(te)),H(te.length,1),F(q["$[]"]("target"),"?")?(M(ee,"question_target=",G(te=[!0])),H(te.length,1),M(ee,"target_number=",G(te=[0])),te[H(te.length,1)]):(M(ee,"question_target=",G(te=[!1])),H(te.length,1),te=[(ue=q["$[]"]("target"),ue===e||null==ue?e:M(ue,"eval",[$e.round_type]))],M(ee,"target_number=",G(te)),te[H(te.length,1)])},{$$arity:1,$$s:this})},4),L(a,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],g=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],B=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],h=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],w=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],E=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],p=[e,6,13,3,9,-1,27,-15,-10,-1,-38],l=[e,e,e,e,e,e,19,16,15,e,e],A=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],re=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),V(u[0],"Racc_arg",[i,g,h,B,w,E,l,p,19,A,re,58,35,!0]),V(u[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),V(u[0],"Racc_debug_parser",!1),L(a,"$_reduce_1",function(x,J,R){var q;return W(this.modifier)||this.$raise(n("ParseError")),q=C(x),this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],null==q[2]?e:q[2],null==q[3]?e:q[3])},3),L(a,"$_reduce_2",function(x,J,R){var q;return W(this.modifier)||this.$raise(n("ParseError")),q=C(x),this.$parsed(null==q[0]?e:q[0],null==q[2]?e:q[2],null==q[1]?e:q[1],null==q[3]?e:q[3])},3),L(a,"$_reduce_3",function(x,J,R){var q,ce;return ce=null==(q=C(x))[2]?e:q[2],this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],y(y(n("Arithmetic"),"Node"),"Number").$new(0),ce)},3),L(a,"$_reduce_4",function(x,J,R){var q=this;return W(q.prefix_number)&&W(q.suffix_number)||q.$raise(n("ParseError")),$(["command","prefix","suffix"],{command:x["$[]"](1),prefix:x["$[]"](0),suffix:x["$[]"](2)})},3),L(a,"$_reduce_5",function(x,J,R){var q=this;return W(q.prefix_number)||q.$raise(n("ParseError")),W(q.need_suffix_number)&&q.$raise(n("ParseError")),$(["command","prefix"],{command:x["$[]"](1),prefix:x["$[]"](0)})},3),L(a,"$_reduce_6",function(x,J,R){var q=this;return W(q.suffix_number)||q.$raise(n("ParseError")),W(q.need_prefix_number)&&q.$raise(n("ParseError")),$(["command","suffix"],{command:x["$[]"](0),suffix:x["$[]"](1)})},3),L(a,"$_reduce_7",function(x,J,R){var q=this;return(W(q.need_prefix_number)||W(q.need_suffix_number))&&q.$raise(n("ParseError")),$(["command"],{command:x["$[]"](0)})},3),L(a,"$_reduce_8",function(x,J,R){return $([],{})},3),L(a,"$_reduce_9",function(x,J,R){var q,ce,se,ee=e;return ee=null==(q=C(x))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.critical)&&W(ee["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["critical",ce])),H(se.length,1),ee},3),L(a,"$_reduce_10",function(x,J,R){var q,ce,se,ee=e;return ee=null==(q=C(x))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.fumble)&&W(ee["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["fumble",ce])),H(se.length,1),ee},3),L(a,"$_reduce_11",function(x,J,R){var q,ce,se,ee=e;return ee=null==(q=C(x))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.dollar)&&W(ee["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["dollar",ce])),H(se.length,1),ee},3),L(a,"$_reduce_12",function(x,J,R){return x["$[]"](1)},3),L(a,"$_reduce_13",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))},3),L(a,"$_reduce_14",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))},3),L(a,"$_reduce_15",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))},3),L(a,"$_reduce_16",function(x,J,R){return W(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),$([],{})},3),L(a,"$_reduce_17",function(x,J,R){var q,ee,Y;return Y=null==(q=C(x))[1]?e:q[1],W(this.allowed_cmp_op["$include?"](ee=null==q[0]?e:q[0]))||this.$raise(n("ParseError")),$(["cmp_op","target"],{cmp_op:ee,target:Y})},3),L(a,"$_reduce_18",function(x,J,R){var ne,q=this;return ne=x["$[]"](0),W(q.question_target)||q.$raise(n("ParseError")),W(q.allowed_cmp_op["$include?"](ne))||q.$raise(n("ParseError")),$(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),L(a,"$_reduce_19",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))},3),L(a,"$_reduce_20",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))},3),L(a,"$_reduce_22",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"*",x["$[]"](2))},3),L(a,"$_reduce_23",function(x,J,R){return x["$[]"](3).$new(x["$[]"](0),x["$[]"](2))},3),L(a,"$_reduce_25",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),L(a,"$_reduce_26",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"DivideWithCeil")},3),L(a,"$_reduce_27",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"DivideWithCeil")},3),L(a,"$_reduce_28",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"DivideWithRound")},3),L(a,"$_reduce_29",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"DivideWithFloor")},3),L(a,"$_reduce_30",function(x,J,R){return x["$[]"](1)},3),L(a,"$_reduce_31",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))},3),L(a,"$_reduce_33",function(x,J,R){return x["$[]"](1)},3),L(a,"$_reduce_34",function(x,J,R){return y(y(n("Arithmetic"),"Node"),"Number").$new(x["$[]"](0))},3),L(a,"$_reduce_none",function(x,J,R){return x["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var N,G,V,W,C,_,F,L,U=[],t=r.nil,m=r.module,e=r.send,y=r.eqeqeq,D=r.truthy,z=r.def;return N=U,G=L=[m(U[0],"BCDice")].concat(N),V=F=[m(L[0],"Deprecated")].concat(G),C=[W=m(F[0],"Checker")].concat(V),_=r.$r(C),W.$private(),z(W,"$check_result_legacy",function(k,P,I,v){var c,b=this,T=t,S=t,f=t,o=t;return T=e(P,"map",[],"sides".$to_proc()),c=(S=e(P,"map",[],"value".$to_proc())).$sum(),f=y([100],o=T)?b.$check_1D100(k,c,I,v):y([20],o)?b.$check_1D20(k,c,I,v):y([6,6],o)?b.$check_2D6(k,c,S,I,v):t,(D(f["$nil?"]())||D(f["$empty?"]()))&&(f=y([10],o=T.$uniq())?b.$check_nD10(k,c,S,I,v):y([6],o)?b.$check_nD6(k,c,S,I,v):t,D(f["$nil?"]())||D(f["$empty?"]()))?t:_("Result").$new(f.$delete_prefix(" \uff1e "))},4),z(W,"$check_1D100",function(k,P,I,v){return t},4),z(W,"$check_1D20",function(k,P,I,v){return t},4),z(W,"$check_nD10",function(k,P,I,v,b){return t},5),z(W,"$check_2D6",function(k,P,I,v,b){return t},5),z(W,"$check_nD6",function(k,P,I,v,b){return t},5)},Opal.modules["bcdice/base"]=function(r){var P,S,u,i,g,c,f,o,a,v,U=r.top,t=[],m=r.$r(t),e=r.nil,y=r.$$$,D=r.module,z=r.klass,$=r.truthy,N=r.def,K=r.regexp,L=r.rb_plus,M=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeqeq,j=r.eqeq,V=r.range,W=r.rb_divide,C=r.rb_times,_=r.rb_ge,s=e;return U.$require("i18n"),U.$require("i18n/backend/fallbacks"),U.$require("bcdice/randomizer"),U.$require("bcdice/dice_table"),U.$require("bcdice/enum"),U.$require("bcdice/translate"),U.$require("bcdice/result"),U.$require("bcdice/command/parser"),U.$require("bcdice/deprecated/checker"),P=t,S=v=[D(t[0],"BCDice")].concat(P),f=[c=z(v[0],null,"Base")].concat(S),o=r.$r(f),(a=c.$$prototype).sort_add_dice=a.sort_barabara_dice=a.enabled_d9=a.raw_input=a.randomizer=a.enabled_upcase_input=a.debug=e,i=[u=r.get_singleton_class(c)].concat(f),g=r.$r(i),u.$attr_reader("prefixes"),N(u,"$register_prefix",function(h){var E,p=this,l=e;return null==p.prefixes&&(p.prefixes=e),E=r.slice.call(arguments),p.prefixes=$(l=p.prefixes)?l:[],p.prefixes.$concat(E.$flatten())},-1),N(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),N(u,"$prefixes_pattern",function(){var h=this,w=e;return null==h.prefixes_pattern&&(h.prefixes_pattern=e),null==h.prefixes&&(h.prefixes=e),h.prefixes_pattern=$(w=h.prefixes_pattern)?w:e,$(h.prefixes_pattern)?h.prefixes_pattern:(h.prefixes=$(w=h.prefixes)?w:[],h.prefixes.$freeze(),h.prefixes_pattern=($(h.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",h.prefixes.$join("|"),")"],"i")).$freeze())},0),N(u,"$command_pattern",function(){var h=this,w=e,E=e;return null==h.command_pattern&&(h.command_pattern=e),null==h.prefixes&&(h.prefixes=e),h.command_pattern=$(w=h.command_pattern)?w:e,$(h.command_pattern)?h.command_pattern:(h.prefixes=$(w=h.prefixes)?w:[],h.prefixes.$freeze(),E=L(M(y(g("CommonCommand"),"COMMANDS"),"map",[],function(l){return null==l&&(l=e),y(l,"PREFIX_PATTERN").$source()},1),h.prefixes),h.command_pattern=K(["^S?(",E.$join("|"),")"],"i").$freeze())},0),N(u,"$eval",function(h){return this.$new(h).$eval()},1),c.$include(o("Translate")),c.$include(y(o("Deprecated"),"Checker")),N(c,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=y(o("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=y(o("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=y(o("BCDice"),"Randomizer").$new(),i.debug=!1},1),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),N(c,"$sort_add_dice?",function(){return this.sort_add_dice},0),N(c,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),N(c,"$enabled_d9?",function(){return this.enabled_d9},0),N(c,"$enable_debug",function(){return this.debug=!0},0),N(c,"$eval",function(){var i,g,B,n=this,h=e;return i=y(o("BCDice"),"Preprocessor").$process(n.raw_input,n),g=$(B=n.$dice_command(i))?B:n.$eval_common_command(n.raw_input),$(g)?(h=[n.randomizer.$rand_results()],M(g,"rands=",G(h)),H(h.length,1),h=[n.randomizer.$detailed_rand_results()],M(g,"detailed_rands=",G(h)),H(h.length,1),g):e},0),N(c,"$change_text",function(n){return n},1),N(c,"$check_result",function(n,i,g,B){var h=this,w=e,E=e,p=e,l=e,A=e;return w=h.$check_result_legacy(n,i,g,B),$(w)?w:(E=M(i,"map",[],"sides".$to_proc()),l=(p=M(i,"map",[],"value".$to_proc())).$sum(),w=F([100],A=E)?h.$result_1d100(n,l,g,B):F([20],A)?h.$result_1d20(n,l,g,B):F([6,6],A)?h.$result_2d6(n,l,p,g,B):e,j(w,o("Result").$nothing())?e:$(w)?w:(w=F([10],A=E.$uniq())?h.$result_nd10(n,l,p,g,B):F([6],A)?h.$result_nd6(n,l,p,g,B):e,j(w,o("Result").$nothing())?e:$(w)?w:h.$result_ndx(n,g,B)))},4),N(c,"$grich_text",function(n,i,g){return e},3),c.$private(),N(c,"$eval_common_command",function(n){try{return n=this.$change_text(n),M(y(o("CommonCommand"),"COMMANDS"),"each",[],function g(B){var w,h=null==g.$$s?this:g.$$s;if(null==h.randomizer&&(h.randomizer=e),null==B&&(B=e),w=B.$eval(n,h,h.randomizer),!$(w))return e;r.ret(w)},{$$arity:1,$$s:this}),e}catch(g){if(g===r.returner)return g.$v;throw g}},1),N(c,"$dice_command",function(n){var i=this,g=e,B=e,h=e,w=e,E=e;return $(i.enabled_upcase_input)&&(n=n.$upcase()),g=i.$class().$prefixes_pattern().$match(n),$(g)?(B=g["$[]"](1)["$nil?"]()["$!"](),$(B)&&(n=n["$[]"](V(1,-1,!1))),h=i.$eval_game_system_specific_command(n),$(h["$is_a?"](o("Result")))?(w=[$(E=h["$secret?"]())?E:B],M(h,"secret=",G(w)),H(w.length,1),h):$(h["$nil?"]())||$(h["$empty?"]())||j(h,"1")?e:M(o("Result").$new(),"tap",[],function(l){return null==l&&(l=e),w=[h.$to_s()],M(l,"text=",G(w)),H(w.length,1),M(l,"secret=",G(w=[B])),w[H(w.length,1)]},1)):e},1),N(c,"$eval_game_system_specific_command",function(n){return e},1),N(c,"$result_ndx",function(n,i,g){return $(g["$is_a?"](o("String")))?e:$(n.$send(i,g))?o("Result").$success(this.$translate("success")):o("Result").$failure(this.$translate("failure"))},3),N(c,"$result_1d100",function(n,i,g,B){return e},4),N(c,"$result_1d20",function(n,i,g,B){return e},4),N(c,"$result_nd10",function(n,i,g,B,h){return e},5),N(c,"$result_2d6",function(n,i,g,B,h){return e},5),N(c,"$result_nd6",function(n,i,g,B,h){return e},5),N(c,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),N(c,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),N(c,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),N(c,"$get_table_by_nDx",function(n,i,g){var h,w=e;return h=this.randomizer.$roll_sum(i,g),w=this.$get_table_value(n["$[]"](H(h,i))),$(w["$nil?"]())?["1",0]:[w,h]},3),N(c,"$get_table_by_1d3",function(n){var B,h,i=this,w=e;return i.$debug("get_table_by_1d3"),B=i.randomizer.$roll_sum(1,6),i.$debug("num",B),h=W(H(B,1),2).$to_i(),i.$debug("index",h),w=n["$[]"](h),$(w["$nil?"]())?["1",0]:[w,B]},1),N(c,"$get_table_by_d66_swap",function(n){var g;return g=this.randomizer.$roll_d66(y(o("D66SortType"),"ASC")),[this.$get_table_by_number(g,n),g]},1),N(c,"$get_table_by_d66",function(n){var g,B,h,E,w=e;return g=this.randomizer.$roll_once(6),B=this.randomizer.$roll_once(6),h=L(C(H(g,1),6),H(B,1)),w=n["$[]"](h),E=""+g+B,$(w["$nil?"]())?["1",E]:[w,E]},1),N(c,"$get_table_by_number",function(n,i,g){try{return null==g&&(g="1"),M(i,"each",[],function h(w){var p,E=null==h.$$s?this:h.$$s;if(null==w&&(w=e),p=w["$[]"](0),!$(_(p,n)))return e;r.ret(E.$get_table_value(w["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(g)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),N(c,"$get_table_value",function(n){return $(n["$is_a?"](o("Proc")))?n.$call():n},1),N(c,"$roll_tables",function(n,i){var B=e;return B=i["$[]"](n),$(B)?B.$roll(this.randomizer).$to_s():e},2),N(c,"$debug",function(n,i){var B,h=this,w=e,E=e;return B=r.slice.call(arguments,1),$(h.debug)?(w=$(n["$is_a?"](o("String")))?n:n.$inspect(),$(B["$empty?"]())?h.$warn(w):(E=M(B,"map",[],function(l){return null==l&&(l=e),$(l["$is_a?"](o("String")))?'"'+l+'"':l.$inspect()},1),h.$warn(w+": "+E.$join(", ")))):e},-2),y(y(m("I18n"),"Backend"),"Simple").$include(y(y(m("I18n"),"Backend"),"Fallbacks")),m("I18n").$load_path()["$<<"](m("Dir")["$[]"](m("File").$join("bcdice","../../i18n/**/*.yml"))),s=["ja_jp"],M(m("I18n"),"default_locale=",G(s)),H(s.length,1),s=[["ja_jp"]],M(m("I18n").$fallbacks(),"defaults=",G(s)),s[H(s.length,1)]},Opal.modules["bcdice/game_system/MagicaLogia"]=function(r){var P,T,o,a,u,E,p,l,A,d,n,i,g,c,f,v,t=[],m=r.nil,e=r.$$$,y=r.module,D=r.klass,z=r.const_set,$=r.send2,N=r.find_super,K=r.def,L=r.eqeq,M=r.truthy,G=r.rb_le,H=r.rb_ge,F=r.rb_plus,j=r.send,V=r.to_a,W=r.rb_minus,C=r.hash2,_=r.defs,s=r.to_ary;return r.top.$require("bcdice/base"),P=t,T=v=[y(t[0],"BCDice")].concat(P),c=[y(v[0],"GameSystem")].concat(T),f=r.$r(c),o=c[0],a=f("Base"),u=c,i=[n=D(o,a,"MagicaLogia")].concat(u),g=r.$r(i),n.$$prototype.randomizer=m,z(i[0],"ID","MagicaLogia"),z(i[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),z(i[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),z(i[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),K(n,"$initialize",function h(w){var p=this;return delete h.$$p,$(p,N(p,"initialize",h,!1,!0),"initialize",[w],null),p.sort_add_dice=!0,p.sort_barabara_dice=!0,p.d66_sort_type=e(g("D66SortType"),"ASC")},1),K(n,"$result_2d6",function(w,E,p,l,A){var d=this,O=m,re=m;return L(A,"?")||!L(l,">=")?m:(O=M(G(E,2))?g("Result").$fumble(d.$translate("fumble")):M(H(E,12))?g("Result").$critical(d.$translate("MagicaLogia.special")):M(H(w,A))?g("Result").$success(d.$translate("success")):g("Result").$failure(d.$translate("failure")),re=[F(O.$text(),d.$gain_magic_element(p["$[]"](0),p["$[]"](1)))],j(O,"text=",V(re)),W(re.length,1),O)},5),K(n,"$eval_game_system_specific_command",function(w){var p,E=this;return M(p=e(E.$class(),"SKILL_TABLE").$roll_command(E.randomizer,w))?p:E.$roll_tables(w,e(E.$class(),"TABLES"))},1),n.$private(),K(n,"$gain_magic_element",function(w,E){var p=this,l=m;return L(w,E)?(l=p.$translate("MagicaLogia.elements.items")["$[]"](W(w,1)),F(" \uff1e ",p.$format(p.$translate("MagicaLogia.elements.format"),C(["text"],{text:l})))):""},2),E=i,l=[p=D(i[0],null,"SkillExpandTable")].concat(E),A=r.$r(l),(d=p.$$prototype).times=d.sides=d.items=d.name=d.skill_table=m,_(p,"$from_i18n",function(re,Q,ie){var X=m;return X=A("I18n").$t(re,C(["locale","raise"],{locale:Q,raise:!1})),this.$new(X["$[]"]("name"),X["$[]"]("type"),X["$[]"]("items"),ie)},3),K(p,"$initialize",function(re,Q,ie,Z){var X=this,x=m;return X.name=re,X.items=ie.$freeze(),X.skill_table=Z,x=/(\d+)D(\d+)/i.$match(Q),M(x)||X.$raise(A("ArgumentError"),"Unexpected table type: "+Q),X.times=x["$[]"](1).$to_i(),X.sides=x["$[]"](2).$to_i()},4),K(p,"$roll",function(re){var ie,Z,Q=this;return ie=re.$roll_sum(Q.times,Q.sides),Z=Q.$expand(Q.items["$[]"](W(ie,Q.times)),re),e(A("DiceTable"),"RollResult").$new(Q.name,ie,Z)},1),p.$private(),K(p,"$expand",function(re,Q){return j(re,"gsub",[/%{([a-z]+)}/],function Z(){var J,X=null==Z.$$s?this:Z.$$s;return J=A("Regexp").$last_match()["$[]"](1).$to_sym(),X.$roll_skill(J,Q)},{$$arity:0,$$s:this})},2),z(l[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),K(p,"$roll_skill",function(re,Q){var Z=m;return L(re,"skill")?this.skill_table.$roll_skill(Q):L(re,"element")?this.skill_table.$roll_category(Q):(Z=A("CATEGORIES").$index(re),M(Z)||this.$raise(A("ArgumentError")),this.skill_table.$categories()["$[]"](Z).$roll(Q).$name())},2),function(h,w,E){var p=D(h,null,"FallenAfterTable"),l=[p].concat(E),A=r.$r(l),d=p.$$prototype;d.lower=d.higher=d.name=m,_(p,"$from_i18n",function(re,Q){var Z=m;return Z=A("I18n").$t(re,C(["locale","raise"],{locale:Q,raise:!0})),this.$new(Z["$[]"]("name"),Z["$[]"]("items_lower"),Z["$[]"]("items_higher"))},2),K(p,"$initialize",function(re,Q,ie){var Z=this;return Z.name=re,Z.lower=Q,Z.higher=ie},3),K(p,"$roll",function(re){var Q,ie,X,x,Z=this,J=m;return ie=re.$roll_barabara(2,6),x=null==(Q=s(ie))[1]?m:Q[1],J=M(G(X=null==Q[0]?m:Q[0],3))?Z.lower:Z.higher,Z.name+"("+X+","+x+") \uff1e "+J["$[]"](W(x,1))},1)}(i[0],0,i),function(h,w){var E=[h].concat(w),p=r.$r(E);h.$private(),K(h,"$translate_skill_table",function(A){return e(p("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",A,C(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))},1),K(h,"$translate_tables",function(A,d){var O,re,Q,ie,Z,X;return O=p("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",A,d),re=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",A),Q=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",A),ie=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",A),Z=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",A),X=p("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",A,d),C(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",A,d),ST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",A,d),FT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",A),WT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",A,d),FCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",A),AT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",A,d),BGT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",A),DAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",A),FAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",A),WIT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",A),TCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",A),PCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",A),MCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",A),ICT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",A),SCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",A),XCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",A),WCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",A),CCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",A),MIT:O,MOT:re,MAT:Q,MUT:ie,MFT:Z,MLT:X,BST:e(p("DiceTable"),"ChainTable").$new(p("I18n").$translate("MagicaLogia.tables.BST.name",C(["raise","locale"],{raise:!0,locale:A})),"1D6",[O,re,Q,ie,Z,X]),PT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",A),XEST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",A,d),IWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",A,d),MCST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",A,d),WDST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",A,d),LWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",A,d),STB:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",A,d),MGCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",A),MBST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",A,d),MAST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",A,d),TCST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",A,d),PWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",A,d),PAST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",A,d),GBST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",A,d),SLST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",A,d),WLAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",A),WMT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",A,d),FFT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",A),OLST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",A,d),TPTB:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",A,d),FLT:p("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",A)})},2)}(r.get_singleton_class(n),i),z(i[0],"SKILL_TABLE",n.$translate_skill_table("ja_jp")),z(i[0],"TABLES",n.$translate_tables("ja_jp",g("SKILL_TABLE"))),n.$register_prefix(g("SKILL_TABLE").$prefixes()),n.$register_prefix(g("TABLES").$keys())},Opal.queue(function(r){var L,F,s,k,P,I,V,W,G,t=[],e=r.module,y=r.klass,D=r.const_set,z=r.send2,$=r.find_super,N=r.def;return r.top.$require("bcdice/game_system/MagicaLogia"),L=t,F=G=[e(t[0],"BCDice")].concat(L),V=[e(G[0],"GameSystem")].concat(F),W=r.$r(V),s=V,P=[k=y(V[0],W("MagicaLogia"),"MagicaLogia_SimplifiedChinese")].concat(s),I=r.$r(P),D(P[0],"ID","MagicaLogia:SimplifiedChinese"),D(P[0],"NAME","\u9b54\u5bfc\u4e66\u5927\u6218"),D(P[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218"),D(P[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u53ef\u4ee5\u5224\u5b9a\u5927\u6210\u529f\uff0f\u5927\u5931\u8d25\uff0f\u6210\u529f\uff0f\u5931\u8d25\n\u30fb\u5404\u79cd\u8868\n\u7ecf\u5386\u8868\u3000BGT/\u521d\u671f\u951a\u70b9\u8868\u3000DAT/\u547d\u8fd0\u5c5e\u6027\u8868\u3000FAT\n\u613f\u671b\u8868\u3000WIT/\u6218\u5229\u54c1\u8868\u3000PT\n\u65f6\u95f4\u6d41\u901d\u8868\u3000TPT/\u5927\u5224\u65f6\u95f4\u6d41\u901d\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u5927\u5931\u8d25\u8868\u3000FT\uff0f\u53d8\u8c03\u8868\u3000WT\n\u547d\u8fd0\u8f6c\u53d8\u8868\u8868\u3000FCT\n\u3000\u5178\u578b\u6027\u707e\u5384 TCT\uff0f\u7269\u7406\u6027\u707e\u5384 PCT\uff0f\u7cbe\u795e\u6027\u707e\u5384 MCT\uff0f\u72c2\u6c14\u6027\u707e\u5384 ICT\n\u3000\u793e\u4f1a\u6027\u707e\u5384 SCT\uff0f\u8d85\u81ea\u7136\u707e\u5384 XCT\uff0f\u4e0d\u53ef\u601d\u8bae\u7684\u707e\u5384 WCT\uff0f\u559c\u5267\u6027\u707e\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u7684\u707e\u5384 MGCT\n\u573a\u666f\u8868\u3000ST\uff0f\u5927\u5224\u573a\u666f\u8868\u3000STB\n\u3000\u6781\u9650\u73af\u5883 XEST\uff0f\u5185\u5fc3\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u540e\u4e16\u754c WDST\uff0f\u8ff7\u5bab\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u4e66\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u514b\u96f7\u5fb7\u5854 TCST\n\u3000\u5e73\u884c\u4e16\u754c PWST\uff0f\u7ec8\u672b\u4e16\u754c PAST\uff0f\u5f02\u4e16\u754c\u9152\u5427 GBST\n\u3000\u661f\u5f71 SLST\uff0f\u65e7\u56fe\u4e66\u9986 OLST\n\u4e16\u754c\u6cd5\u5219\u8ffd\u52a0\u8868 WLAT/\u5f98\u5f8a\u602a\u7269\u8868 WMT\n\u968f\u673a\u9886\u57df\u8868\u3000RCT\n\u968f\u673a\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTS, RTT1\n\u3000\u517d\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTP, RTT4\n\u3000\u68a6\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTD, RTT5\n\u3000\u6697\u9886\u57df\u968f\u673a\u7279\u6280\u8868  RTN, RTT6\n\u7a7a\u767d\u79d8\u5bc6\u8868\u3000BST\n\u3000\u5bbf\u654c\u8868\u3000MIT/\u8c0b\u7565\u8868\u3000MOT/\u56e0\u7f18\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u573a\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u90a3\u4e4b\u540e\u8868 FLT\n\u30fb\u53ef\u4ee5\u4f7f\u7528D66\n"),k.$register_prefix_from_super_class(),N(k,"$initialize",function v(b){var S=this;return delete v.$$p,z(S,$(S,"initialize",v,!1,!0),"initialize",[b],null),S.locale="zh_hans"},1),D(P[0],"SKILL_TABLE",k.$translate_skill_table("zh_hans")),D(P[0],"TABLES",k.$translate_tables("zh_hans",I("SKILL_TABLE")))})}}]);