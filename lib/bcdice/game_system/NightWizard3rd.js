(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3535],{4933:(V,X,Y)=>{Y(9993),Opal.modules["bcdice/normalize"]=function(o){var E,l,c,z=[],g=o.nil,t=o.module,b=o.eqeqeq,h=o.def,v=o.eqeq;return E=z,c=[t(z[0],"BCDice")].concat(E),(l=t(c[0],"Normalize")).$module_function(),h(l,"$comparison_operator",function(a){var u;return b(/<=|=</,u=a)?"<=":b(/>=|=>/,u)?">=":b(/<>|!=|=!/,u)?"!=":b(/</,u)?"<":b(/>/,u)?">":b(/=/,u)?"==":g},1),h(l,"$target_number",function(a){return v(a,"?")?a:a.$to_i()},1)},Opal.modules["bcdice/format"]=function(o){var c,a,u,f,A,l,z=[],g=o.nil,t=o.module,b=o.eqeqeq,h=o.def,v=o.truthy,W=o.eqeq,E=o.rb_gt;return c=z,a=l=[t(z[0],"BCDice")].concat(c),f=[u=t(l[0],"Format")].concat(a),A=o.$r(f),u.$module_function(),h(u,"$comparison_operator",function(y){var R;return b("==",R=y)?"=":b("!=",R)?"<>":b(A("Symbol"),R)?y.$to_s():g},1),h(u,"$modifier",function(y){return v(y["$nil?"]())?g:W(y,0)?"":v(E(y,0))?"+"+y:y.$to_s()},1)},Opal.modules["bcdice/game_system/NightWizard"]=function(o){var R,M,J,Q,U,n,q,x,w,j,T,L,C,z=o.top,g=[],t=o.nil,b=o.module,h=o.klass,v=o.const_set,W=o.send2,E=o.find_super,d=o.def,c=o.truthy,k=o.to_ary,l=o.rb_plus,P=o.regexp,a=o.send,u=o.to_a,f=o.rb_minus,A=o.eqeq,D=o.neqeq;return z.$require("bcdice/normalize"),z.$require("bcdice/format"),R=g,M=C=[b(g[0],"BCDice")].concat(R),T=[b(C[0],"GameSystem")].concat(M),L=o.$r(T),J=T[0],Q=L("Base"),U=T,x=[q=h(J,Q,"NightWizard")].concat(U),w=o.$r(x),(j=q.$$prototype).nw_command=j.randomizer=j.total=j.interim_expr=j.status=j.fumble_numbers=j.critical_numbers=t,v(x[0],"ID","NightWizard"),v(x[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),v(x[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),v(x[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),q.$register_prefix("([-+]?\\d+)?NW","2R6"),d(q,"$initialize",function p($){var r=this;return delete p.$$p,W(r,E(r,"initialize",p,!1,!0),"initialize",[$],null),r.nw_command="NW"},1),d(q,"$eval_game_system_specific_command",function($){var n,r,_,s=this,e=t,i=t,m=t,S=t,N=t;return e=c(_=s.$parse_nw($))?_:s.$parse_2r6($),c(e)?(r=s.$roll_nw(e),i=null==(n=k(r))[0]?t:n[0],m=null==n[1]?t:n[1],S=null==n[2]?t:n[2],N=c(e.$cmp_op())?c(i.$send(e.$cmp_op(),e.$target_number()))?"\u6210\u529f":"\u5931\u6557":t,["("+e+")",m,S,i.$to_s(),N].$compact().$join(" \uff1e ")):t},1),q.$private(),(n=h(x[0],null,"Parsed")).$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number"),function(p,$,n){var r=h(p,$,"ParsedNW"),s=[r].concat(n),e=o.$r(s),_=r.$$prototype;_.base=_.modify_number=_.active_modify_number=_.prana=_.command=_.critical_numbers=_.fumble_numbers=_.cmp_op=_.target_number=t,r.$attr_accessor("base"),r.$attr_accessor("modify_number"),d(r,"$initialize",function i(m){var N=this;return delete i.$$p,W(N,E(N,"initialize",i,!1,!0),"initialize",[],null),N.command=m},1),d(r,"$passive_modify_number",function(){return l(this.base,this.modify_number)},0),d(r,"$to_s",function(){var S,N,F,I,K,m=this;return S=c(m.base["$zero?"]())?t:m.base,N=e("Format").$modifier(m.modify_number),F=e("Format").$modifier(m.active_modify_number),I=c(K=m.prana)?"$"+m.prana:K,""+S+m.command+N+"@"+m.critical_numbers.$join(",")+"#"+m.fumble_numbers.$join(",")+I+F+m.cmp_op+m.target_number},0)}(x[0],w("Parsed"),x),function(p,$){var n=h(p,$,"Parsed2R6"),r=n.$$prototype;r.passive_modify_number=r.active_modify_number=r.critical_numbers=r.fumble_numbers=r.cmp_op=r.target_number=t,n.$attr_accessor("passive_modify_number"),d(n,"$to_s",function(){var e=this;return"2R6M["+e.passive_modify_number+","+e.active_modify_number+"]C["+e.critical_numbers.$join(",")+"]F["+e.fumble_numbers.$join(",")+"]"+e.cmp_op+e.target_number},0)}(x[0],w("Parsed")),d(q,"$parse_nw",function($){var n,r,e=t,_=t,i=t;return e=P(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match($),c(e)?(_=w("ParsedNW").$new(this.nw_command),i=[e["$[]"](1).$to_i()],a(_,"base=",u(i)),f(i.length,1),i=[w("ArithmeticEvaluator").$eval(e["$[]"](2))],a(_,"modify_number=",u(i)),f(i.length,1),i=[c(e["$[]"](3))?a(e["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],a(_,"critical_numbers=",u(i)),f(i.length,1),i=[c(e["$[]"](4))?a(e["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],a(_,"fumble_numbers=",u(i)),f(i.length,1),i=[(n=e["$[]"](5),n===t||null==n?t:a(n,"to_i",[]))],a(_,"prana=",u(i)),f(i.length,1),i=[w("ArithmeticEvaluator").$eval(e["$[]"](6))],a(_,"active_modify_number=",u(i)),f(i.length,1),i=[w("Normalize").$comparison_operator(e["$[]"](7))],a(_,"cmp_op=",u(i)),f(i.length,1),i=[(r=e["$[]"](8),r===t||null==r?t:a(r,"to_i",[]))],a(_,"target_number=",u(i)),f(i.length,1),_):t},1),d(q,"$parse_2r6",function($){var n,r=t,s=t,e=t;return r=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match($),c(r)?(s=w("Parsed2R6").$new(),e=[w("ArithmeticEvaluator").$eval(r["$[]"](1))],a(s,"passive_modify_number=",u(e)),f(e.length,1),e=[w("ArithmeticEvaluator").$eval(r["$[]"](2))],a(s,"active_modify_number=",u(e)),f(e.length,1),e=[c(r["$[]"](3))?a(r["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],a(s,"critical_numbers=",u(e)),f(e.length,1),e=[c(r["$[]"](4))?a(r["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],a(s,"fumble_numbers=",u(e)),f(e.length,1),e=[w("Normalize").$comparison_operator(r["$[]"](5))],a(s,"cmp_op=",u(e)),f(e.length,1),e=[(n=r["$[]"](6),n===t||null==n?t:a(n,"to_i",[]))],a(s,"target_number=",u(e)),f(e.length,1),s):t},1),d(q,"$roll_nw",function($){var r=this,s=t,e=t,_=t,i=t,m=t;for(r.critical_numbers=$.$critical_numbers(),r.fumble_numbers=$.$fumble_numbers(),r.total=0,r.interim_expr="",r.status=t,s=r.$roll_once_first();A(s,"critical");)s=r.$roll_once();return D(s,"fumble")&&c($.$prana())&&(_=(e=r.randomizer.$roll_barabara($.$prana(),6)).$sum(),i=e.$join(","),r.total=l(r.total,_),r.interim_expr=l(r.interim_expr,"+"+_+"["+i+"]")),m=A(s,"fumble")?r.$fumble_base_number($):l($.$passive_modify_number(),$.$active_modify_number()),r.total=l(r.total,m),r.interim_expr=l(m.$to_s(),r.interim_expr),[r.total,r.interim_expr,r.status]},1),d(q,"$roll_once",function($){var s,e,n=this,r=t;return null==$&&($=!1),s=(r=n.randomizer.$roll_barabara(2,6)).$sum(),e=r.$join(","),c($)&&c(n.fumble_numbers["$include?"](s))?(n.total=f(n.total,10),n.interim_expr=l(n.interim_expr,"-10["+e+"]"),n.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):c(n.critical_numbers["$include?"](s))?(n.total=l(n.total,10),n.interim_expr=l(n.interim_expr,"+10["+e+"]"),n.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(n.total=l(n.total,s),n.interim_expr=l(n.interim_expr,"+"+s+"["+e+"]"),t)},-1),d(q,"$roll_once_first",function(){return this.$roll_once(!0)},0),d(q,"$fumble_base_number",function($){return $.$passive_modify_number()},1)},Opal.queue(function(o){var c,a,R,B,C,f,A,l,g=[],b=o.module,h=o.klass,v=o.const_set,W=o.rb_plus,E=o.def;return o.top.$require("bcdice/game_system/NightWizard"),c=g,a=l=[b(g[0],"BCDice")].concat(c),f=[b(l[0],"GameSystem")].concat(a),A=o.$r(f),R=f,v((C=[B=h(f[0],A("NightWizard"),"NightWizard3rd")].concat(R))[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"),v(C[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683"),v(C[0],"ID","NightWizard3rd"),B.$register_prefix("([-+]?\\d+)?NW","2R6"),E(B,"$fumble_base_number",function(M){return W(M.$passive_modify_number(),M.$active_modify_number())},1)})}}]);