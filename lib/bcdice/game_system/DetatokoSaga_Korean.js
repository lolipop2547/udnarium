(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7553],{4236:(ie,oe,X)=>{X(9993),Opal.modules["bcdice/game_system/DetatokoSaga"]=function(l){var H,O,ne,s,z,m,N,te,W,p=[],e=l.nil,k=l.$$$,q=l.module,M=l.klass,d=l.const_set,I=l.send2,K=l.find_super,_=l.def,S=l.truthy,V=l.send,c=l.hash2,o=l.rb_plus,w=l.to_ary,D=l.eqeqeq,C=l.rb_minus,E=l.eqeq,F=l.neqeq,L=l.rb_ge,G=l.rb_gt,j=l.rb_divide,J=l.rb_times,v=l.defs;return H=p,O=W=[q(p[0],"BCDice")].concat(H),N=[q(W[0],"GameSystem")].concat(O),te=l.$r(N),ne=N,z=[s=M(N[0],te("Base"),"DetatokoSaga")].concat(ne),m=l.$r(z),s.$$prototype.randomizer=e,d(z[0],"ID","DetatokoSaga"),d(z[0],"NAME","\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac"),d(z[0],"SORT_KEY","\u3066\u305f\u3068\u3053\u3055\u3042\u304b"),d(z[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000xDS or xDSy or xDS>=t or xDSy>=t or xDS+z>=t or xDSy+z>=t\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10)\u3001t\uff1d\u76ee\u6a19\u5024(\u7701\u7565\u6642\uff18))\n\u3000\u4f8b\uff093DS\u30002DS5\u30000DS\u30003DS>=10\u30003DS7>=12 2DS3+1 3DS2+1>=10\n\u30fb\u5224\u5b9a\u5024\u3000xJD or xJDy or xJDy+z or xJDy-z or xJDy/z\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10))\n\u3000\u4f8b\uff093JD\u30002JD5\u30003JD7+1\u30004JD/3\n\u30fb\u4f53\u529b\u70d9\u5370\u8868\u3000SST (StrengthStigmaTable)\n\u30fb\u6c17\u529b\u70d9\u5370\u8868\u3000WST (WillStigmaTable)\n\u30fb\u4f53\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000SBET (StrengthBadEndTable)\n\u30fb\u6c17\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000WBET (WillBadEndTable)\n"),s.$register_prefix("\\d+DS","\\d+JD"),_(s,"$initialize",function f(a){var t=this;return delete f.$$p,I(t,K(t,"initialize",f,!1,!0),"initialize",[a],null),t.sort_add_dice=!0,t.d66_sort_type=k(m("D66SortType"),"ASC")},1),_(s,"$eval_game_system_specific_command",function(a){var r=this,t=e,n=e;return r.$debug("eval_game_system_specific_command begin string",a),t=r.$checkRoll(a),S(t)||(t=r.$checkJudgeValue(a),S(t))?t:(r.$debug("\u5404\u7a2e\u8868\u3068\u3057\u3066\u51e6\u7406"),r.$roll_tables(S(n=m("ALIAS")["$[]"](a))?n:a,k(r.$class(),"TABLES")))},1),_(s,"$checkRoll",function(a){var r,t,n,i=this,g=e,B=e,R=e,h=e,$=e,y=e,T=e,u=e,x=e,b=e,Q=e,U=e;return i.$debug("checkRoll begin string",a),g=/^(\d+)DS(\d+)?(([+-\/])(\d+))?(?:>=(\d+))?$/i.$match(a),S(g)?(B=g["$[]"](1).$to_i(),R=g["$[]"](2).$to_i(),h=g["$[]"](4),$=g["$[]"](5).$to_i(),y=S(T=(r=g["$[]"](6))===e||null==r?e:V(r,"to_i",[]))?T:8,u=i.$translate("DetatokoSaga.DS.input_options",c(["skill","flag","target"],{skill:B,flag:R,target:y})),x=i.$getModifyText(h,$),S(x["$empty?"]())||(u=o(u,i.$translate("DetatokoSaga.DS.modifier",c(["modifier"],{modifier:x})))),n=i.$getRollResult(B),t=w(n),u=o(u," \uff1e "+(b=null==t[0]?e:t[0])+"["+(null==t[1]?e:t[1])+"]"+x),Q=i.$getTotalResultValue(b,$,h),u=o(u," \uff1e "+Q),S(x["$empty?"]())||(D("+",T=h)?b=o(b,$):D("-",T)&&(b=C(b,$))),U=i.$getSuccess(b,y),u=o(u," \uff1e "+U),u=o(u,i.$getCheckFlagResult(b,R))):e},1),_(s,"$getRollResult",function(a){var i,t=e,n=e;return t=o(a,1),E(a,0)&&(t=3),i=(n=this.randomizer.$roll_barabara(t,6)).$join(","),n=n.$sort(),F(a,0)&&(n=n.$reverse()),[o(n["$[]"](0),n["$[]"](1)),i]},1),_(s,"$getSuccess",function(a,r){return S(L(a,r))?this.$translate("DetatokoSaga.DS.success"):this.$translate("DetatokoSaga.DS.failure")},2),_(s,"$getCheckFlagResult",function(a,r){var n=e;return S(G(a,r))?"":(n=this.$getDownWill(r),this.$translate("DetatokoSaga.less_than_flag",c(["will"],{will:n})))},2),_(s,"$getDownWill",function(a){return S(L(a,10))?"6":"1D6->"+this.randomizer.$roll_once(6)},1),_(s,"$checkJudgeValue",function(a){var r,t,n=this,i=e,g=e,B=e,R=e,h=e,$=e,y=e,T=e,x=e;return n.$debug("checkJudgeValue begin string",a),i=/^(\d+)JD(\d+)?(([+-\/])(\d+))?$/i.$match(a),S(i)?(g=i["$[]"](1).$to_i(),B=i["$[]"](2).$to_i(),R=i["$[]"](4),h=i["$[]"](5).$to_i(),$=n.$translate("DetatokoSaga.JD.input_options",c(["skill","flag"],{skill:g,flag:B})),y=n.$getModifyText(R,h),S(y["$empty?"]())||($=o($,n.$translate("DetatokoSaga.JD.modifier",c(["modifier"],{modifier:y})))),t=n.$getRollResult(g),r=w(t),$=o($," \uff1e "+(T=null==r[0]?e:r[0])+"["+(null==r[1]?e:r[1])+"]"+y),x=n.$getTotalResultValue(T,h,R),$=o($," \uff1e "+x),$=o($,n.$getCheckFlagResult(T,B))):e},1),_(s,"$getModifyText",function(a,r){var n=e;return E(r,0)?"":(D("+",n=a)?"\uff0b":D("-",n)?"\uff0d":D("/",n)?"\xf7":"")+r},2),_(s,"$getTotalResultValue",function(a,r,t){var i,n=this;return D("+",i=t)?o(a+"+"+r+" \uff1e ",n.$translate("DetatokoSaga.total_value",c(["total"],{total:o(a,r)}))):D("-",i)?o(a+"-"+r+" \uff1e ",n.$translate("DetatokoSaga.total_value",c(["total"],{total:C(a,r)}))):D("/",i)?n.$getTotalResultValueWhenSlash(a,r):n.$translate("DetatokoSaga.total_value",c(["total"],{total:a}))},3),_(s,"$getTotalResultValueWhenSlash",function(a,r){var n=e;return E(r,0)?this.$translate("DetatokoSaga.division_by_zero_error"):(n=j(J(1,a),r).$ceil(),o(a+"\xf7"+r+" \uff1e ",this.$translate("DetatokoSaga.total_value",c(["total"],{total:n}))))},2),d(z[0],"ALIAS",V(c(["StrengthStigmaTable","WillStigmaTable","StrengthBadEndTable","WillBadEndTable"],{StrengthStigmaTable:"SST",WillStigmaTable:"WST",StrengthBadEndTable:"SBET",WillBadEndTable:"WBET"}),"transform_keys",[],"upcase".$to_proc()).$freeze()),v(s,"$translate_tables",function(a){return c(["SST","WST","SBET","WBET"],{SST:k(m("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SST",a),WST:k(m("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WST",a),SBET:k(m("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SBET",a),WBET:k(m("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WBET",a)})},1),d(z[0],"TABLES",s.$translate_tables("ja_jp").$freeze()),s.$register_prefix(m("TABLES").$keys(),m("ALIAS").$keys())},Opal.queue(function(l){var V,D,j,J,v,E,F,o,e=[],q=l.module,M=l.klass,d=l.const_set,I=l.send2,K=l.find_super,_=l.def;return l.top.$require("bcdice/game_system/DetatokoSaga"),V=e,D=o=[q(e[0],"BCDice")].concat(V),E=[q(o[0],"GameSystem")].concat(D),F=l.$r(E),j=E,d((v=[J=M(E[0],F("DetatokoSaga"),"DetatokoSaga_Korean")].concat(j))[0],"ID","DetatokoSaga:Korean"),d(v[0],"NAME","\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00"),d(v[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00"),d(v[0],"HELP_MESSAGE","\u30fb\ud1b5\uc0c1\ud310\uc815\u3000xDS or xDSy or xDS>=t or xDSy>=t or xDS+z>=t or xDSy+z>=t\n\u3000(x\uff1d\uc2a4\ud0ac\ub808\ubca8, y\uff1d\ud604\uc7ac \ud50c\ub798\uadf8(\uc0dd\ub7b5=0), z\uff1d\uc218\uc815\uce58(\uc0dd\ub7b5=\uff10), t\uff1d\ubaa9\ud45c\uce58(\uc0dd\ub7b5=\uff18))\n\u3000\uc608\uff093DS\u30002DS5\u30000DS\u30003DS>=10\u30003DS7>=12 2DS3+1 3DS2+1>=10\n\u30fb\ud310\uc815\uce58\u3000xJD or xJDy or xJDy+z or xJDy-z or xJDy/z\n\u3000(x\uff1d\uc2a4\ud0ac\ub808\ubca8, y\uff1d\ud604\uc7ac \ud50c\ub798\uadf8(\uc0dd\ub7b5=0), z\uff1d\uc218\uc815\uce58(\uc0dd\ub7b5=\uff10))\n\u3000\uc608\uff093JD\u30002JD5\u30003JD7+1\u30004JD/3\n\u30fb\uccb4\ub825 \ub099\uc778\ud45c\u3000SST (StrengthStigmaTable)\n\u30fb\uae30\ub825 \ub099\uc778\ud45c\u3000WST (WillStigmaTable)\n\u30fb\uccb4\ub825 \ubc30\ub4dc\uc5d4\ub529\ud45c\u3000SBET (StrengthBadEndTable)\n\u30fb\uae30\ub825 \ubc30\ub4dc\uc5d4\ub529\ud45c\u3000WBET (WillBadEndTable)\n"),J.$register_prefix_from_super_class(),_(J,"$initialize",function A(H){var W=this;return delete A.$$p,I(W,K(W,"initialize",A,!1,!0),"initialize",[H],null),W.locale="ko_kr"},1),d(v[0],"TABLES",J.$translate_tables("ko_kr"))})}}]);