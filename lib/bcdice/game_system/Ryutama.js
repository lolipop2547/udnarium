(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[585],{8123:(te,ie,F)=>{F(9993),Opal.queue(function($){var j,U,ee,a,m,d,z,R,X,k,p=[],n=$.nil,V=$.module,G=$.klass,D=$.const_set,H=$.send2,I=$.find_super,o=$.def,s=$.truthy,K=$.to_ary,_=$.eqeq,g=$.rb_plus,q=$.neqeq,S=$.rb_divide,L=$.rb_ge,N=$.rb_gt,P=$.rb_lt;return j=p,U=k=[V(p[0],"BCDice")].concat(j),R=[V(k[0],"GameSystem")].concat(U),X=$.$r(R),ee=R,m=[a=G(R[0],X("Base"),"Ryutama")].concat(ee),d=$.$r(m),(z=a.$$prototype).validDiceTypes=z.randomizer=n,D(m[0],"ID","Ryutama"),D(m[0],"NAME","\u308a\u3085\u3046\u305f\u307e"),D(m[0],"SORT_KEY","\u308a\u3086\u3046\u305f\u307e"),D(m[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u3000Rx,y>=t\uff08x,y\uff1a\u4f7f\u7528\u3059\u308b\u80fd\u529b\u5024\u3001t\uff1a\u76ee\u6a19\u5024\uff09\n\u30001\u30be\u30ed\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3082\u542b\u3081\u3066\u5224\u5b9a\u7d50\u679c\u3092\u8868\u793a\u3057\u307e\u3059\n\u3000\u80fd\u529b\u5024\uff11\u3064\u3067\u306e\u5224\u5b9a\u306f Rx>=t \u3067\u884c\u3048\u307e\u3059\n\u4f8b\uff09R8,6>=13\n"),a.$register_prefix("R"),o(a,"$initialize",function l(e){var i=this;return delete l.$$p,H(i,I(i,"initialize",l,!1,!0),"initialize",[e],null),i.validDiceTypes=[20,12,10,8,6,4,2]},1),o(a,"$eval_game_system_specific_command",function(e){var t,i,r=this,f=n,u=n,c=n,b=n,B=n,h=n,x=n,v=n,T=n,y=n,C=n,E=n,M=n;return r.$debug("eval_game_system_specific_command begin"),s(e["$=~"](/^R(\d+)(,(\d+))?([+\-\d]+)?(>=(\d+))?/))?(r.$debug("matched"),f=d("Regexp").$last_match(1).$to_i(),u=d("Regexp").$last_match(3).$to_i(),c=d("Regexp").$last_match(4),b=d("Regexp").$last_match(6),i=r.$getDiceType(f,u),u=null==(t=K(i))[1]?n:t[1],_(f=null==t[0]?n:t[0],0)?"":(c=s(B=c)?B:"",h=d("ArithmeticEvaluator").$eval(c),b=r.$getDiffculty(b),x=r.$getRollValue(f),v=r.$getRollValue(u),T=g(g(x,v),h),y=r.$getResultText(x,v,f,u,b,T),s(y["$empty?"]())||(y=" \uff1e "+y),C=x+"("+f+")",E=_(v,0)?"":"+"+v+"("+u+")",M=r.$getModifyString(h),"("+r.$getBaseText(f,u,h,b)+") \uff1e "+C+E+M+" \uff1e "+T+y)):(r.$debug("unmatched!"),"")},1),o(a,"$getDiceType",function(e,t){var i=this,r=n;return i.$debug("getDiceType begin"),q(t,0)?s(i.$isValidDiceOne(e))?[e,t]:[0,0]:s(i.$isValidDice(e,t))?[e,t]:(e=S(r=e,10).$to_i(),t=r["$%"](10),s(i.$isValidDice(e,t))?[e,t]:(e=S(r,100).$to_i(),t=r["$%"](100),s(i.$isValidDice(e,t))?[e,t]:s(i.$isValidDiceOne(r))?[r,0]:[0,0]))},2),o(a,"$isValidDice",function(e,t){var r;return s(r=this.$isValidDiceOne(e))?this.$isValidDiceOne(t):r},2),o(a,"$isValidDiceOne",function(e){return this.validDiceTypes["$include?"](e)},1),o(a,"$getDiffculty",function(e){return s(e["$nil?"]())||(e=e.$to_i()),e},1),o(a,"$getRollValue",function(e){return _(e,0)?0:this.randomizer.$roll_once(e)},1),o(a,"$getResultText",function(e,t,i,r,f,u){return s(this.$isFamble(e,t))?"\uff11\u30be\u30ed\u3010\uff11\u30be\u30ed\u30dd\u30a4\u30f3\u30c8\uff0b\uff11\u3011":s(this.$isCritical(e,t,i,r))?"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u6210\u529f":s(f["$nil?"]())?"":s(L(u,f))?"\u6210\u529f":"\u5931\u6557"},6),o(a,"$isFamble",function(e,t){var i;return s(i=e["$=="](1))?t["$=="](1):i},2),o(a,"$isCritical",function(e,t,i,r){return!_(t,0)&&!!(_(e,6)&&_(t,6)||_(e,i)&&_(t,r))},4),o(a,"$getBaseText",function(e,t,i,r){var u=n;return u="R"+e,q(t,0)&&(u=g(u,","+t)),u=g(u,this.$getModifyString(i)),s(r["$nil?"]())||(u=g(u,">="+r)),u},4),o(a,"$getModifyString",function(e){return s(N(e,0))?g("+",e.$to_s()):s(P(e,0))?e.$to_s():""},1)})}}]);