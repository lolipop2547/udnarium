(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5150],{8327:(ee,te,I)=>{I(9993),Opal.queue(function(f){var P,Y,Z,a,S,v,k,Q,E,w=[],e=f.nil,M=f.$$$,A=f.module,q=f.klass,R=f.const_set,C=f.send2,T=f.find_super,m=f.def,o=f.truthy,D=f.rb_le,b=f.rb_plus,B=f.rb_divide,X=f.hash,l=f.hash2,F=f.neqeq,y=f.send,G=f.to_ary,z=f.to_a,j=f.rb_minus;return P=w,Y=E=[A(w[0],"BCDice")].concat(P),k=[A(E[0],"GameSystem")].concat(Y),Q=f.$r(k),Z=k,S=[a=q(k[0],Q("Base"),"Skynauts")].concat(Z),v=f.$r(S),a.$$prototype.randomizer=e,R(S[0],"ID","Skynauts"),R(S[0],"NAME","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09"),R(S[0],"SORT_KEY","\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064"),R(S[0],"HELP_MESSAGE","\u25c6\u5224\u5b9a\u3000(SNn)\u3001(2D6<=n)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000\u4f8b\uff09SN5\u3000SN5\u3000SN(3+2)\n\u25c6\u822a\u884c\u30c1\u30a7\u30c3\u30af\u3000(NV+n)\u3000n:\u4fee\u6b63\u5024\uff08\u7701\u7565\u6642:0\uff09\n\u3000\u4f8b\uff09NV\u3000NV+1\n\u25c6\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(Dx/y@m)\u3000x:\u30c0\u30e1\u30fc\u30b8\u5de6\u5074\u306e\u5024\u3001y:\u30c0\u30e1\u30fc\u30b8\u53f3\u5074\u306e\u5024\n\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u98db\u7a7a\u8247\u30b7\u30fc\u30c8\u5916\u306e\u5ea7\u6a19\u306f()\u304c\u4ed8\u304d\u307e\u3059\u3002\n\u3000\u4f8b\uff09 D/4\u3000D19/2\u3000D/3@8\u3000D[\u5927\u63fa\u308c]/2\n\u25c6\u7832\u6483\u5224\u5b9a+\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(BOMn/Dx/y@m)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000x:\u30c0\u30e1\u30fc\u30b8\u5de6\u5074\u306e\u5024\u3001y:\u30c0\u30e1\u30fc\u30b8\u53f3\u5074\u306e\u5024\n\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u4f8b\uff09 BOM/D/4\u3000BOM9/D19/2@4\n\u25c6\u300a\u56de\u907f\u904b\u52d5\u300b\u3000(AVOn@mXX)\u3000n:\u76ee\u6a19\u5024\uff08\u7701\u7565\u6642:7\uff09\n\u3000m:\u56de\u907f\u65b9\u5411\u3002\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\u3001XX\uff1a\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u7d50\u679c\n\u3000\u4f8b\uff09\n\u3000AVO9@8[\u7e261,\u6a2a4],[\u7e262,\u6a2a6],[\u7e263,\u6a2a8]\u3000AVO@2[\u7e266,\u6a2a4],[\u7e262,\u6a2a6]\n"),a.$register_prefix("D","2D6<=","SN","NV","AVO","BOM"),m(a,"$initialize",function c(n){var $=this;return delete c.$$p,C($,T($,"initialize",c,!1,!0),"initialize",[n],null),$.round_type=M(v("RoundType"),"FLOOR")},1),m(a,"$eval_game_system_specific_command",function(n){var $,t,s,r,i=this;return i.$debug("\n=======================================\n"),i.$debug("eval_game_system_specific_command command",n),o($=o(t=o(s=o(r=i.$get_judge_result(n))?r:i.$navigation_result(n))?s:i.$get_fire_result(n))?t:i.$get_bomb_result(n))?$:i.$get_avoid_result(n)},1),a.$private(),m(a,"$get_judge_result",function(n){var t,i=this,$=e,s=e,r=e,_=e,u=e;return o($=o(t=/^2D6<=(\d)$/i.$match(n))?t:/^SN(\d*)$/i.$match(n))?(i.$debug("====get_judge_result===="),s=o($["$[]"](1)["$empty?"]())?7:$["$[]"](1).$to_i(),i.$debug("\u76ee\u6a19\u5024",s),u="(2D6<="+s+") \uff1e "+(_=(r=i.randomizer.$roll_barabara(2,6)).$sum())+"["+r.$join(",")+"] \uff1e "+_,o(D(_,2))?v("Result").$fumble(b(u," \uff1e \u30d5\u30a1\u30f3\u30d6\u30eb")):o(D(_,s))?v("Result").$success(b(u," \uff1e \u6210\u529f")):v("Result").$failure(b(u," \uff1e \u5931\u6557"))):e},1),m(a,"$navigation_result",function(n){var i=this,$=e,t=e,s=e,r=e,_=e;return o($=/^NV(\+(\d+))?$/.$match(n))?(i.$debug("====navigation_result===="),t=$["$[]"](2).$to_i(),i.$debug("\u79fb\u52d5\u4fee\u6b63",t),s=i.randomizer.$roll_once(6),r=o(D(B(s,2).$to_i(),0))?1:B(s,2).$to_i(),_=b(r,t),i.$debug("\u79fb\u52d5\u30a8\u30ea\u30a2\u6570",_),v("Result").$new("\u822a\u884c\u30c1\u30a7\u30c3\u30af(\u6700\u4f4e1)\u3000(1D6/2+"+t+") \uff1e "+s+" /2+"+t+" \uff1e "+r+"+"+t+" \uff1e "+_+"\u30a8\u30ea\u30a2\u9032\u3080")):e},1),R(S[0],"DIRECTION_INFOS",X(1,l(["name","position_diff"],{name:"\u5de6\u4e0b",position_diff:l(["x","y"],{x:-1,y:1})}),2,l(["name","position_diff"],{name:"\u4e0b",position_diff:l(["x","y"],{x:0,y:1})}),3,l(["name","position_diff"],{name:"\u53f3\u4e0b",position_diff:l(["x","y"],{x:1,y:1})}),4,l(["name","position_diff"],{name:"\u5de6",position_diff:l(["x","y"],{x:-1,y:0})}),6,l(["name","position_diff"],{name:"\u53f3",position_diff:l(["x","y"],{x:1,y:0})}),7,l(["name","position_diff"],{name:"\u5de6\u4e0a",position_diff:l(["x","y"],{x:-1,y:-1})}),8,l(["name","position_diff"],{name:"\u4e0a",position_diff:l(["x","y"],{x:0,y:-1})}),9,l(["name","position_diff"],{name:"\u53f3\u4e0a",position_diff:l(["x","y"],{x:1,y:-1})})).$freeze()),m(a,"$get_direction_info",function(n,i,$){var t=e;return null==$&&($=e),t=v("DIRECTION_INFOS")["$[]"](n.$to_i()),o(t["$nil?"]())?$:t["$[]"](i)},-3),m(a,"$get_fire_result",function(n){var i=this,$=e,t=e,s=e,r=e,_=e,u=e;return o($=/^D([12346789]*)(\[.+\])*\/(\d{1,2})(@([2468]))?$/.$match(n))?(i.$debug("====get_fire_result===="),t=$["$[]"](3).$to_i(),s=$["$[]"](1).$to_s(),r=$["$[]"](5).$to_i(),i.$debug("fire_count",t),i.$debug("fire_range",s),i.$debug("ballistics",r),_=i.$get_fire_point(s,t),u=[n,i.$get_fire_point_text(_,t).$text()],F(r,0)&&(u["$<<"]("\u300a\u5f3e\u9053\u5b66\u300b:"+i.$get_direction_info(r,"name","")+"\n"),u["$<<"](i.$get_fire_point_text(_,t,r).$text())),v("Result").$new(u.$join(" \uff1e "))):e},1),m(a,"$get_fire_point",function(n,i){var $=this,t=e;return $.$debug("====get_fire_point===="),t=[],y(i,"times",[],function s(r){var u,g,_=null==s.$$s?this:s.$$s,p=e;return null==_.randomizer&&(_.randomizer=e),null==r&&(r=e),_.$debug("\n\u7832\u6483\u56de\u6570",b(r,1)),t["$<<"]([]),u=_.randomizer.$roll_once(6),g=_.randomizer.$roll_sum(2,6),p=[g,u],t["$[]"](-1)["$<<"](p),_.$debug("\u7740\u5f3e\u70b9",t),y(n,"chars",[],function h(d){var x=null==h.$$s?this:h.$$s,N=e;return null==d&&(d=e),x.$debug("\u7bc4\u56f2",d),N=x.$get_direction_info(d,"position_diff",l([],{})),p=[b(g,N["$[]"]("x").$to_i()),b(u,N["$[]"]("y").$to_i())],t["$[]"](-1)["$<<"](p),x.$debug("\u7740\u5f3e\u70b9:\u7bc4\u56f2",t)},{$$arity:1,$$s:_})},{$$arity:1,$$s:$}),$.$debug("\n\u6700\u7d42\u7740\u5f3e\u70b9",t),t},2),m(a,"$get_fire_point_text",function(n,i,$){var s=e;return null==$&&($=0),this.$debug("====get_fire_point_text===="),s=[],y(n,"each",[],function r(_){var g=e;return null==_&&(_=e),g="",y(_,"each",[],function p(h,d){var x,N,V=null==p.$$s?this:p.$$s;return null==h&&(h=e),null==d&&(d=e),N=V.$get_move_point(h,d,$),x=G(N),g=b(g,o(V["$in_map_position?"](h=null==x[0]?e:x[0],d=null==x[1]?e:x[1]))?"[\u7e26"+d+",\u6a2a"+h+"]":"([\u7e26"+d+",\u6a2a"+h+"])"),V.$debug("\u7740\u5f3e\u70b9\u30c6\u30ad\u30b9\u30c8",g)},{$$arity:2,$$s:null==r.$$s?this:r.$$s}),s["$<<"](g)},{$$arity:1,$$s:this}),v("Result").$new(s.$join(","))},-3),m(a,"$in_map_position?",function(n,i){var $,t=e;return o($=o(t=D(1,i))?D(i,6):t)?o(t=D(2,n))?D(n,12):t:$},2),m(a,"$get_move_point",function(n,i,$){var t=this,s=e;return t.$debug("====get_move_point===="),t.$debug("\u65b9\u5411",$),t.$debug("\u5ea7\u6a19\u79fb\u52d5\u524d(x,y)",n,i),s=t.$get_direction_info($,"position_diff",l([],{})),n=b(n,s["$[]"]("x").$to_i()),i=b(i,s["$[]"]("y").$to_i()),t.$debug("\n\u5ea7\u6a19\u79fb\u52d5\u5f8c(x,y)",n,i),[n,i]},3),m(a,"$get_bomb_result",function(n){var i=this,$=e,t=e,s=e,r=e,_=e,u=e;return o($=/^BOM(\d*)?\/D([12346789]*)(\[.+\])*\/(\d+)(@([2468]))?$/i.$match(n))?(i.$debug("====get_bomb_result====",n),t=$["$[]"](1).$to_s(),s=$["$[]"](6).$to_i(),i.$debug("\u5f3e\u9053\u5b66\u65b9\u5411",s),r=i.$get_judge_result(b("SN",t)),o(r["$failure?"]())?(_=[n+" \uff1e "+r.$text()],y(r,"text=",z(_)),j(_.length,1),r):(u=n.$slice(/D([12346789]*)(\[.+\])*\/(\d+)(@([2468]))?/),_=[n+" \uff1e "+r.$text()+"\n \uff1e "+i.$get_fire_result(u).$text()],y(r,"text=",z(_)),j(_.length,1),r)):e},1),m(a,"$get_avoid_result",function(n){var i=this,$=e,t=e,s=e,r=e,_=e,u=e,g=e,p=e;return o($=/^AVO(\d*)?(@([2468]))(\(?\[\u7e26\d+,\u6a2a\d+\]\)?,?)+$/.$match(n))?(i.$debug("====get_avoid_result====",n),t=$["$[]"](3).$to_i(),i.$debug("\u56de\u907f\u65b9\u5411",t),s=n.$slice(/^AVO(\d*)?(@([2468]))/),r=i.$get_judge_result(b("SN",v("Regexp").$last_match(1).$to_s())),o(r["$failure?"]())?(_=[s+" \uff1e \u300a\u56de\u907f\u904b\u52d5\u300b"+r.$text()],y(r,"text=",z(_)),j(_.length,1),r):(u=n.$slice(/(\(?\[\u7e26\d+,\u6a2a\d+\]\)?,?)+/),p=(g=i.$scan_fire_point(u)).$size(),v("Result").$success([s,"\u300a\u56de\u907f\u904b\u52d5\u300b"+r.$text()+"\n",u,b(b("\u300a\u56de\u907f\u904b\u52d5\u300b:",i.$get_direction_info(t,"name","")),"\n"),i.$get_fire_point_text(g,p,t).$text()].$compact().$join(" \uff1e ")))):e},1),m(a,"$scan_fire_point",function(n){var $=e;return this.$debug("====scan_fire_point====",n),n=n.$gsub(/\(|\)/,""),$=[],y(n.$split(/\],/),"each",[],function t(s){var r=null==t.$$s?this:t.$$s;return null==s&&(s=e),r.$debug("point_text",s),$["$<<"]([]),y(s.$split(/\]/),"each",[],function _(u){var g=null==_.$$s?this:_.$$s,p=e,d=e;return null==u&&(u=e),g.$debug("point",u),$["$[]"](-1)["$<<"]([]),o(u["$=~"](/[^\d]*(\d+),[^\d]*(\d+)/))?(p=v("Regexp").$last_match(1).$to_i(),d=[-1,[v("Regexp").$last_match(2).$to_i(),p]],y($["$[]"](-1),"[]=",z(d)),j(d.length,1),g.$debug("\u7740\u5f3e\u70b9",$)):e},{$$arity:1,$$s:r})},{$$arity:1,$$s:this}),$},1)})}}]);