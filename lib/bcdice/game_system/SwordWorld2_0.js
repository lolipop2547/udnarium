(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7043],{3840:(be,ge,he)=>{he(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(r){var B,M,K,Z,I,Y,F,y,W=[],$=r.nil,t=r.$$$,e=r.module,p=r.hash2,S=r.truthy,G=r.def;return B=W,M=y=[e(W[0],"BCDice")].concat(B),F=[Y=e(y[0],"ArithmeticEvaluator")].concat(M),Z=[K=r.get_singleton_class(Y)].concat(F),I=r.$r(Z),G(K,"$eval",function(o,P){var V,H=$;if(null==P)P=p([],{});else if(!P.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(V=P.$$smap.round_type)&&(V=t(I("RoundType"),"FLOOR")),S(o)&&S(H=I("Arithmetic").$eval(o,V))?H:0},-2)},Opal.modules["i18n/backend/fallbacks"]=function(r){var Z,o,V,H,I,m,W=[],$=r.nil,t=r.$$$,e=r.module,p=r.class_variable_set,S=r.truthy,G=r.class_variable_get,u=r.def,B=r.send,C=r.to_a,y=r.rb_minus,q=r.send2,M=r.find_super,Y=r.hash2,F=r.find_block_super,K=r.neqeq;return Z=W,m=[I=e(W[0],"I18n")].concat(Z),p(m[0],"@@fallbacks",$),o=r.get_singleton_class(I),V=[o].concat(m),H=r.$r(V),u(o,"$fallbacks",function(){var w=$;return p(V[1],"@@fallbacks",S(null!=V[1].$$cvars["@@fallbacks"]?"class variable":$)&&S(w=G(V[1],"@@fallbacks",!1))?w:t(t(H("I18n"),"Locale"),"Fallbacks").$new()),S(w=H("Thread").$current()["$[]"]("i18n_fallbacks"))?w:G(V[1],"@@fallbacks",!1)},0),u(o,"$fallbacks=",function(g){var w;return p(V[1],"@@fallbacks",S(g["$is_a?"](H("Array")))?t(t(H("I18n"),"Locale"),"Fallbacks").$new(g):g),w=["i18n_fallbacks",G(V[1],"@@fallbacks",!1)],B(H("Thread").$current(),"[]=",C(w)),w[y(w.length,1)]},1),function(o,P){var g,w,z,_,H=[e(o,"Backend")].concat(P);return g=H,z=[w=e(H[0],"Fallbacks")].concat(g),_=r.$r(z),u(w,"$translate",function v(f,a,c){try{var n=v.$$p||$,i=this,h=$,x=$;return delete v.$$p,null==c&&(c=_("EMPTY_HASH")),S(c.$fetch("fallback",!0))?S(c["$[]"]("fallback_in_progress"))?q(i,M(i,"translate",v,!1,!0),"translate",[f,a,c],n):(S(c["$[]"]("default"))&&(h=i["$extract_non_symbol_default!"](c)),x=c.$merge(Y(["fallback_in_progress"],{fallback_in_progress:!0})),B(_("I18n").$fallbacks()["$[]"](f),"each",[],function b(l){var A=null==b.$$s?this:b.$$s;null==l&&(l=$);try{return B(A,"catch",["exception"],function L(){var s=null==L.$$s?this:L.$$s,j=$;if(j=q(s,F(s,"translate",L.$$def||b.$$def||v,!1,!1),"translate",[l,a,x],null),S(j["$nil?"]()))return $;K(f.$to_s(),l.$to_s())&&s.$on_fallback(f,l,a,c),r.ret(j)},{$$arity:0,$$s:A})}catch(L){if(!r.rescue(L,[t(_("I18n"),"InvalidLocale")]))throw L;try{return $}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),S(c["$key?"]("default"))&&S(c["$[]"]("default")["$nil?"]())?$:S(h)?q(i,M(i,"translate",v,!1,!0),"translate",[f,$,c.$merge(Y(["default"],{default:h}))],null):i.$throw("exception",t(_("I18n"),"MissingTranslation").$new(f,a,c))):q(i,M(i,"translate",v,!1,!0),"translate",[f,a,c],n)}catch(b){if(b===r.returner)return b.$v;throw b}},-3),u(w,"$extract_non_symbol_default!",function(f){var c,a=$,n=$;return a=[f["$[]"]("default")].$flatten(),c=B(a,"detect",[],function(h){return null==h&&(h=$),h["$is_a?"](_("Symbol"))["$!"]()},1),S(c)&&(n=["default",a["$[]"](0,a.$index(c))],B(f,"[]=",C(n)),y(n.length,1)),c},1),u(w,"$exists?",function v(f,a,c){try{var n=v.$$p||$,i=this;return delete v.$$p,null==c&&(c=_("EMPTY_HASH")),S(c.$fetch("fallback",!0))?(B(_("I18n").$fallbacks()["$[]"](f),"each",[],function h(x){var b=null==h.$$s?this:h.$$s;null==x&&(x=$);try{if(!S(q(b,F(b,"exists?",h.$$def||v,!1,!1),"exists?",[x,a],null)))return $;r.ret(!0)}catch(l){if(!r.rescue(l,[t(_("I18n"),"InvalidLocale")]))throw l;try{return $}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):q(i,M(i,"exists?",v,!1,!0),"exists?",[f,a,c],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),w.$private(),u(w,"$on_fallback",function(f,a,c,n){return $},4)}(m[0],m)},Opal.modules["bcdice/randomizer"]=function(r){var I,k,g,w,z,_,o,P,W=[],$=r.nil,t=r.$$$,p=r.klass,S=r.const_set,G=r.def,u=r.truthy,B=r.rb_gt,C=r.rb_plus,y=r.rb_le,q=r.send,M=r.rb_minus,Y=r.eqeq,F=r.rb_times,K=r.eqeqeq,J=r.rb_ge;return I=W,o=[(0,r.module)(W[0],"BCDice")].concat(I),P=r.$r(o),k=o,w=[g=p(o[0],null,"Randomizer")].concat(k),z=r.$r(w),(_=g.$$prototype).rand_results=_.detailed_rand_results=$,S(w[0],"UPPER_LIMIT_DICE_TIMES",200),S(w[0],"UPPER_LIMIT_DICE_SIDES",1e3),S(w[0],"UPPER_LIMIT_RANDS",1e4),G(g,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),g.$attr_reader("rand_results"),g.$attr_reader("detailed_rand_results"),S(w[0],"DetailedRandResult",z("Struct").$new("kind","sides","value")),G(g,"$roll_barabara",function(f,a){var c=this;return u(B(C(c.rand_results.$size(),f),z("UPPER_LIMIT_RANDS")))&&c.$raise(z("TooManyRandsError")),u(y(f,0))||u(B(f,z("UPPER_LIMIT_DICE_TIMES")))?[]:q(z("Array"),"new",[f],function n(){return(null==n.$$s?this:n.$$s).$roll_once(a)},{$$arity:0,$$s:c})},2),G(g,"$roll_sum",function(f,a){return this.$roll_barabara(f,a).$sum()},2),G(g,"$roll_once",function(f){var c=$;return u(y(f,0))||u(B(f,z("UPPER_LIMIT_DICE_SIDES")))?0:(c=this.$rand_inner(f),this.$push_to_detail("normal",f,c),c)},1),G(g,"$roll_index",function(f){return M(this.$roll_once(f),1)},1),G(g,"$roll_tens_d10",function(){var c,a=$;return a=this.$rand_inner(10),Y(a,10)&&(a=0),c=F(a,10),this.$push_to_detail("tens_d10",10,c),c},0),G(g,"$roll_d9",function(){var a;return a=M(this.$rand_inner(10),1),this.$push_to_detail("d9",10,a),a},0),G(g,"$roll_d66",function(f){var n,c=$;return c=q(z("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),K(t(z("D66SortType"),"ASC"),n=f)?c["$sort!"]():K(t(z("D66SortType"),"DESC"),n)&&c["$sort!"]()["$reverse!"](),C(F(c["$[]"](0),10),c["$[]"](1))},1),g.$private(),G(g,"$rand_inner",function(f){var c,a=this;return u(J(a.rand_results.$size(),z("UPPER_LIMIT_RANDS")))&&a.$raise(z("TooManyRandsError")),c=a.$random(f),a.rand_results["$<<"]([c,f]),c},1),G(g,"$random",function(f){return C(z("Kernel").$rand(f),1)},1),G(g,"$push_to_detail",function(f,a,c){var i;return i=z("DetailedRandResult").$new(f,a,c),this.detailed_rand_results.$push(i)},3),p(o[0],P("StandardError"),"TooManyRandsError"),$},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var u,q,J,Z,I,m,o,Y,C,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.truthy;return u=W,q=C=[t(W[0],"BCDice")].concat(u),J=Y=[t(C[0],"DiceTable")].concat(q),I=[Z=e(Y[0],null,"RollResult")].concat(J),m=r.$r(I),(o=Z.$$prototype).table_name=o.value=o.body=$,p(Z,"$initialize",function(V,H,k){var g=this;return g.table_name=V,g.value=H,g.body=k},3),Z.$attr_reader("table_name"),Z.$attr_reader("value"),Z.$attr_reader("body"),p(Z,"$to_s",function(){var V=this;return V.table_name+"("+V.value+") \uff1e "+V.body},0),p(Z,"$last_body",function(){var V=this;return S(V.body["$is_a?"](m("RollResult")))?V.body.$last_body():V.body},0),p(Z,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var B,M,Z,I,m,o,P,F,y,W=[],$=r.nil,t=r.module,e=r.klass,p=r.truthy,S=r.def,G=r.rb_minus;return B=W,M=y=[t(W[0],"BCDice")].concat(B),Z=F=[t(y[0],"DiceTable")].concat(M),m=[I=e(F[0],null,"ChainTable")].concat(Z),o=r.$r(m),(P=I.$$prototype).times=P.sides=P.items=P.name=$,S(I,"$initialize",function(H,k,g){var w=this,z=$;return w.name=H,w.items=g.$freeze(),z=/(\d+)D(\d+)/i.$match(k),p(z)||w.$raise(o("ArgumentError"),"Unexpected table type: "+k),w.times=z["$[]"](1).$to_i(),w.sides=z["$[]"](2).$to_i()},3),S(I,"$roll",function(H){var g,w,k=this,z=$;return g=H.$roll_sum(k.times,k.sides),w=G(g,k.times),z=k.items["$[]"](w),p(z["$respond_to?"]("roll"))&&(z=z.$roll(H)),o("RollResult").$new(k.name,g,z)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var q,K,o,P,V,H,k,Z,Y,W=[],$=r.nil,t=r.module,e=r.klass,p=r.hash2,S=r.defs,G=r.def,u=r.rb_plus,B=r.rb_times,C=r.rb_minus;return q=W,K=Y=[t(W[0],"BCDice")].concat(q),o=Z=[t(Y[0],"DiceTable")].concat(K),V=[P=e(Z[0],null,"D66GridTable")].concat(o),H=r.$r(V),(k=P.$$prototype).name=k.items=$,S(P,"$from_i18n",function(w,z){var v=$;return v=H("I18n").$t(w,p(["locale","raise"],{locale:z,raise:!0})),this.$new(v["$[]"]("name"),v["$[]"]("items"))},2),G(P,"$initialize",function(w,z){return this.name=w,this.items=z.$freeze()},2),G(P,"$roll",function(w){var _,v,f,a,c;return _=w.$roll_once(6),v=w.$roll_once(6),f=u(B(_,10),v),a=C(_,1),c=C(v,1),H("RollResult").$new(this.name,f,this.items["$[]"](a)["$[]"](c))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var C,Y,m,o,P,V,K,J,q,$=[],t=r.nil,e=r.module,p=r.klass,S=r.hash2,G=r.defs,u=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),C=$,Y=q=[e($[0],"BCDice")].concat(C),K=[e(q[0],"DiceTable")].concat(Y),J=r.$r(K),m=K,P=[o=p(K[0],J("D66GridTable"),"D66HalfGridTable")].concat(m),V=r.$r(P),G(o,"$from_i18n",function(k,g){var z=t;return z=V("I18n").$t(k,S(["locale","raise"],{locale:g,raise:!0})),this.$new(z["$[]"]("name"),z["$[]"]("items_1_2_3"),z["$[]"]("items_4_5_6"))},2),u(o,"$initialize",function(k,g,w){return this.name=k,this.items=[g,g,g,w,w,w].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var C,Y,m,o,P,V,K,J,q,$=[],t=r.nil,e=r.module,p=r.klass,S=r.hash2,G=r.defs,u=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),C=$,Y=q=[e($[0],"BCDice")].concat(C),K=[e(q[0],"DiceTable")].concat(Y),J=r.$r(K),m=K,P=[o=p(K[0],J("D66GridTable"),"D66OneThirdTable")].concat(m),V=r.$r(P),G(o,"$from_i18n",function(k,g){var z=t;return z=V("I18n").$t(k,S(["locale","raise"],{locale:g,raise:!0})),this.$new(z["$[]"]("name"),z["$[]"]("items_1_2"),z["$[]"]("items_3_4"),z["$[]"]("items_5_6"))},2),u(o,"$initialize",function(k,g,w,z){return this.name=k,this.items=[g,g,w,w,z,z].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var Y,Z,V,H,k,g,w,m,K,W=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,S=r.hash2,G=r.defs,u=r.def,B=r.eqeqeq,C=r.rb_plus,y=r.rb_times,q=r.truthy;return Y=W,Z=K=[e(W[0],"BCDice")].concat(Y),V=m=[e(K[0],"DiceTable")].concat(Z),k=[H=p(m[0],null,"D66Table")].concat(V),g=r.$r(k),(w=H.$$prototype).sort_type=w.items=w.name=$,G(H,"$from_i18n",function(_,v){var c,a=$;return a=g("I18n").$t(_,S(["locale"],{locale:v})),c=g("D66SortType").$const_get(a["$[]"]("d66_sort_type")),this.$new(a["$[]"]("name"),c,a["$[]"]("items"))},2),u(H,"$initialize",function(_,v,f){var a=this;return a.name=_,a.sort_type=v,a.items=f.$freeze()},3),u(H,"$roll",function(_){var v=this,f=$,a=$,c=$,n=$;return f=_.$roll_barabara(2,6),B(t(g("D66SortType"),"ASC"),a=v.sort_type)?f["$sort!"]():B(t(g("D66SortType"),"DESC"),a)&&f["$sort!"]()["$reverse!"](),c=C(y(f["$[]"](0),10),f["$[]"](1)),n=q(a=v.items["$[]"](c))?a:v.items["$[]"](c.$to_s()),q(n["$respond_to?"]("roll"))&&(n=n.$roll(_)),g("RollResult").$new(v.name,c,n)},1),u(H,"$choice",function(_){return g("RollResult").$new(this.name,_,this.items["$[]"](_))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var J,o,V,H,I,$=[],t=r.nil,e=r.module,p=r.klass,S=r.hash2,G=r.send,u=r.to_ary,B=r.rb_plus,C=r.rb_times,y=r.to_a,q=r.rb_minus,M=r.send2,Y=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),J=$,o=I=[e($[0],"BCDice")].concat(J),V=[e(I[0],"DiceTable")].concat(o),H=r.$r(V),F(p(V[0],H("D66Table"),"D66LeftRangeTable"),"$initialize",function z(_,v,f){var n;return delete z.$$p,n=S([],{}),G(f,"each",[],function(h){var x,A;return null==h&&(h=t),x=u(h),A=null==x[1]?t:x[1],G(null==x[0]?t:x[0],"each",[],function(s){return null==s&&(s=t),G(A,"each_with_index",[],function(R,ie){var le,_e;return null==R&&(R=t),null==ie&&(ie=t),le=B(C(s,10),B(ie,1)),G(n,"[]=",y(_e=[le,R])),_e[q(_e.length,1)]},2)},1)},1),M(this,Y(this,"initialize",z,!1,!0),"initialize",[_,v,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var y,F,m,o,P,V,H,J,M,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.truthy,G=r.rb_minus,u=r.rb_plus,B=r.rb_times;return y=W,F=M=[t(W[0],"BCDice")].concat(y),m=J=[t(M[0],"DiceTable")].concat(F),P=[o=e(J[0],null,"D66ParityTable")].concat(m),V=r.$r(P),(H=o.$$prototype).odd=H.even=H.name=$,p(o,"$initialize",function(g,w,z){var _=this;return _.name=g,_.odd=w.$freeze(),_.even=z.$freeze()},3),p(o,"$roll",function(g){var _,f,a,w=this,z=$;return z=g.$roll_once(6),_=g.$roll_once(6),f=(S(z["$odd?"]())?w.odd:w.even)["$[]"](G(_,1)),a=u(B(z,10),_),V("RollResult").$new(w.name,a,f)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var C,Y,I,m,o,P,V,K,q,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.rb_plus,G=r.rb_times,u=r.send;return C=W,Y=q=[t(W[0],"BCDice")].concat(C),I=K=[t(q[0],"DiceTable")].concat(Y),o=[m=e(K[0],null,"D66RangeTable")].concat(I),P=r.$r(o),(V=m.$$prototype).items=V.name=$,p(m,"$initialize",function(k,g){return this.name=k,this.items=g.$freeze()},2),p(m,"$roll",function(k){var w,z,_,v=$;return w=k.$roll_once(6),z=k.$roll_once(6),_=S(G(w,10),z),v=u(this.items,"find",[],function(a){return null==a&&(a=$),a["$[]"](0)["$include?"](_)},1),P("RollResult").$new(this.name,_,v["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,I,H,k,g,w,z,o,J,W=[],$=r.nil,t=r.module,e=r.klass,p=r.const_set,S=r.send,G=r.truthy,u=r.def,B=r.to_a,C=r.rb_minus,y=r.eqeqeq,q=r.rb_times,M=r.rb_plus;return F=W,I=J=[t(W[0],"BCDice")].concat(F),H=o=[t(J[0],"DiceTable")].concat(I),g=[k=e(o[0],null,"RangeTable")].concat(H),w=r.$r(g),(z=k.$$prototype).name=z.items=z.num_of_dice=z.num_of_sides=z.formatter=$,p(g[0],"RollResult",S(w("Struct"),"new",["sum","values","content","formatted"],function _(){return(null==_.$$s?this:_.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:k})),p(g[0],"Item",w("Struct").$new("range","content")),p(g[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(g[0],"DEFAULT_FORMATTER",S(k,"lambda",[],function(v,f){return null==v&&(v=$),null==f&&(f=$),v.$name()+"("+f.$sum()+") \uff1e "+f.$content()},2)),k.$attr_reader("name"),k.$attr_reader("num_of_dice"),k.$attr_reader("num_of_sides"),u(k,"$initialize",function _(v,f,a){var i,c=_.$$p||$,n=this,h=$;return delete _.$$p,n.name=v.$freeze(),n.formatter=G(i=c)?i:w("DEFAULT_FORMATTER"),h=w("DICE_ROLL_METHOD_RE").$match(f),G(h)||n.$raise(w("ArgumentError"),n.name+": invalid dice roll method: "+f),n.num_of_dice=h["$[]"](1).$to_i(),n.num_of_sides=h["$[]"](2).$to_i(),n.$store(a)},3),u(k,"$fetch",function(v){var a,f=this;return a=S(f.items,"find",[],function(n){return null==n&&(n=$),n.$range()["$include?"](v)},1),G(a)||f.$raise(w("RangeError"),f.name+": value is out of range: "+v),a},1),u(k,"$roll",function(v){var c,n,i,f=this,a=$;return c=(a=v.$roll_barabara(f.num_of_dice,f.num_of_sides)).$sum(),n=w("RollResult").$new(c,a,f.$fetch(c).$content()),i=[f.formatter["$[]"](f,n)],S(n,"formatted=",B(i)),C(i.length,1),n},1),k.$private(),u(k,"$store",function(v){var a,c,f=this;return a=S(v,"map",[],function n(i,h){return null==i&&(i=$),null==h&&(h=$),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),h]},{$$arity:2,$$s:f}),c=S(a,"sort_by",[],function(i,h){return null==i&&(i=$),null==h&&(h=$),i.$min()},2),f.$assert_min_sum_is_covered(c),f.$assert_max_sum_is_covered(c),f.$assert_no_gap_or_overlap_in_ranges(c),f.items=S(c,"map",[],function(i,h){return null==i&&(i=$),null==h&&(h=$),w("Item").$new(i,h.$freeze()).$freeze()},2).$freeze(),f},1),u(k,"$coerce_to_int_range",function(v){var a;return y(w("Integer"),a=v)?w("Range").$new(v,v):y(w("Range"),a)&&G(v.$begin()["$is_a?"](w("Integer")))&&G(v.$end()["$is_a?"](w("Integer")))?v:this.$raise(w("TypeError"),this.name+": "+v+" ("+v.$class()+") must be an Integer or a Range with Integers ")},1),u(k,"$assert_min_sum_is_covered",function(v){var a,f=this,c=$;return a=f.num_of_dice,c=v.$first()["$[]"](0),G(c["$include?"](a))||f.$raise(w("RangeError"),f.name+": min value ("+a+") is not covered: "+c),f},1),u(k,"$assert_max_sum_is_covered",function(v){var a,f=this,c=$;return a=q(f.num_of_dice,f.num_of_sides),c=v.$last()["$[]"](0),G(c["$include?"](a))||f.$raise(w("RangeError"),f.name+": max value ("+a+") is not covered: "+c),f},1),u(k,"$assert_no_gap_or_overlap_in_ranges",function(v){return S(v,"each_cons",[2],function a(c,n){var b,l,i=null==a.$$s?this:a.$$s,h=$,x=$;return null==i.name&&(i.name=$),null==c&&(c=$),null==n&&(n=$),h=c["$[]"](0),x=n["$[]"](0),b=h.$max(),l=M(b,1),G(x["$include?"](b))&&i.$raise(w("RangeError"),i.name+": Range overlap: "+h+" and "+x),G(x["$include?"](l))?$:i.$raise(w("RangeError"),i.name+": Range gap: "+h+" and "+x)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var C,Y,I,H,k,g,w,o,K,q,W=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,S=r.send,G=r.def,u=r.rb_minus;return C=W,Y=q=[e(W[0],"BCDice")].concat(C),I=K=[e(q[0],"DiceTable")].concat(Y),H=o=[p(K[0],null,"SaiFicSkillTable")].concat(I),g=[k=p(o[0],null,"Category")].concat(H),w=r.$r(g),k.$$prototype.name=$,G(k,"$initialize",function(v,f,a,c){var n=this;return n.name=v,n.skills=S(f.$map(),"with_index",[2],function(h,x){return null==h&&(h=$),null==x&&(x=$),t(w("SaiFicSkillTable"),"Skill").$new(v,h,a,x,c)},2),n.dice=a},4),G(k,"$roll",function(v){return this.$skills()["$[]"](u(v.$roll_sum(2,6),2))},1),G(k,"$to_s",function(){return this.name},0),k.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var u,q,J,P,V,I,Y,C,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.hash2;return u=W,q=C=[t(W[0],"BCDice")].concat(u),J=Y=[t(C[0],"DiceTable")].concat(q),I=[e(Y[0],null,"SaiFicSkillTable")].concat(J),(V=(P=e(I[0],null,"Skill")).$$prototype).s_format=V.category_dice=V.row_dice=V.category_name=V.name=$,p(P,"$initialize",function(k,g,w,z,_){var v=this;return v.category_name=k,v.name=g,v.category_dice=w,v.row_dice=z,v.s_format=_},5),p(P,"$to_s",function(){var k=this;return k.$format(k.s_format,S(["category_dice","row_dice","category_name","skill_name"],{category_dice:k.category_dice,row_dice:k.row_dice,category_name:k.category_name,skill_name:k.name}))},0),P.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var Z,P,w,z,_,v,f,H,m,W=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,S=r.klass,G=r.hash2,u=r.send,C=r.defs,y=r.const_set,q=r.to_ary,M=r.def,Y=r.truthy,F=r.rb_minus,K=r.rb_plus;return W.$require("bcdice/dice_table/sai_fic_skill_table/category"),W.$require("bcdice/dice_table/sai_fic_skill_table/skill"),Z=$,P=m=[p($[0],"BCDice")].concat(Z),w=H=[p(m[0],"DiceTable")].concat(P),_=[z=S(H[0],null,"SaiFicSkillTable")].concat(w),v=r.$r(_),(f=z.$$prototype).rtt=f.rtt_format=f.rct=f.rct_format=f.rttn=f.rttn_format=f.categories=t,C(z,"$from_i18n",function(c,n,i){var h,x,b,s,L=t;if(null==i)i=G([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(h=i.$$smap.rtt)&&(h=t),null==(x=i.$$smap.rct)&&(x=t),null==(b=i.$$smap.rttn)&&(b=t),s=(L=v("I18n").$t("RTT",G(["locale","raise","default"],{locale:n,raise:!1,default:G([],{})})).$merge(v("I18n").$t(c,G(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),L=u(L,"select",[],function(R,ie){return null==R&&(R=t),null==ie&&(ie=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](R)},2),this.$new(s,r.to_hash(L).$merge(G(["rtt","rct","rttn"],{rtt:h,rct:x,rttn:b})))},-3),y(_[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),y(_[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),y(_[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),y(_[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),M(z,"$initialize",function(c,n){var i,h,x,b,l,A,L,s=this;if(null==n)n=G([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=t),null==(h=n.$$smap.rct)&&(h=t),null==(x=n.$$smap.rttn)&&(x=t),null==(b=n.$$smap.rtt_format)&&(b=v("DEFAULT_RTT")),null==(l=n.$$smap.rct_format)&&(l=v("DEFAULT_RCT")),null==(A=n.$$smap.rttn_format)&&(A=v("DEFAULT_RTTN")),null==(L=n.$$smap.s_format)&&(L=v("DEFAULT_S")),s.categories=u(c.$map(),"with_index",[1],function(R,ie){var le,oe,ue;return null==R&&(R=t),null==ie&&(ie=t),oe=null==(le=q(R))[0]?t:le[0],ue=null==le[1]?t:le[1],e(v("SaiFicSkillTable"),"Category").$new(oe,ue,ie,L)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),s.rtt=i,s.rct=h,s.rttn=x.$to_a(),s.rtt_format=b,s.rct_format=l,s.rttn_format=A},-2),y(_[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),z.$attr_reader("categories"),M(z,"$roll_command",function(c,n){var h,i=this,x=t,b=t;return Y(["RTT",i.rtt]["$include?"](h=n))?i.$format_skill(i.rtt_format,i.$roll_skill(c)):Y(["RCT",i.rct]["$include?"](h))?(x=i.$roll_category(c),i.$format(i.rct_format,G(["category_dice","category_name"],{category_dice:x.$dice(),category_name:x.$name()}))):Y(b=v("RTTN").$index(h))||Y(b=i.rttn.$index(h))?i.$format_skill(i.rttn_format,i.categories["$[]"](b).$roll(c)):t},2),M(z,"$roll_category",function(c){return this.categories["$[]"](F(c.$roll_once(6),1))},1),M(z,"$roll_skill",function(c){return this.$roll_category(c).$roll(c)},1),M(z,"$prefixes",function(){var c=this;return K(["RTT[1-6]?","RCT",c.rtt,c.rct],c.rttn).$compact()},0),z.$private(),M(z,"$format_skill",function(c,n){return this.$format(c,G(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var y,F,m,o,P,V,H,J,M,W=[],$=r.nil,t=r.module,e=r.klass,p=r.hash2,S=r.defs,G=r.truthy,u=r.def,B=r.rb_minus;return y=W,F=M=[t(W[0],"BCDice")].concat(y),m=J=[t(M[0],"DiceTable")].concat(F),P=[o=e(J[0],null,"Table")].concat(m),V=r.$r(P),(H=o.$$prototype).times=H.sides=H.name=H.items=$,S(o,"$from_i18n",function(g,w){var _=$;return _=V("I18n").$t(g,p(["locale"],{locale:w})),this.$new(_["$[]"]("name"),_["$[]"]("type"),_["$[]"]("items"))},2),u(o,"$initialize",function(g,w,z){var _=this,v=$;return _.name=g,_.items=z.$freeze(),v=/(\d+)D(\d+)/i.$match(w),G(v)||_.$raise(V("ArgumentError"),"Unexpected table type: "+w),_.times=v["$[]"](1).$to_i(),_.sides=v["$[]"](2).$to_i()},3),u(o,"$roll",function(g){var z,w=this;return z=g.$roll_sum(w.times,w.sides),w.$choice(z)},1),u(o,"$choice",function(g){var z,w=this;return z=B(g,w.times),V("RollResult").$new(w.name,g,w.items["$[]"](z))},1)},Opal.modules["bcdice/dice_table"]=function(r){var W=r.top;return W.$require("bcdice/dice_table/roll_result"),W.$require("bcdice/dice_table/chain_table"),W.$require("bcdice/dice_table/d66_grid_table"),W.$require("bcdice/dice_table/d66_half_grid_table"),W.$require("bcdice/dice_table/d66_one_third_table"),W.$require("bcdice/dice_table/d66_left_range_table"),W.$require("bcdice/dice_table/d66_parity_table"),W.$require("bcdice/dice_table/d66_range_table"),W.$require("bcdice/dice_table/d66_table"),W.$require("bcdice/dice_table/range_table"),W.$require("bcdice/dice_table/sai_fic_skill_table"),W.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var S,C,q,u,W=[],t=r.module,e=r.const_set;return S=W,C=u=[t(W[0],"BCDice")].concat(S),q=[t(u[0],"D66SortType")].concat(C),e(q[0],"NO_SORT","no_sort"),e(q[0],"ASC","asc"),e(q[0],"DESC","desc"),function(B,C){var q=[t(B,"RoundType")].concat(C);return e(q[0],"CEIL","ceil"),e(q[0],"FLOOR","floor"),e(q[0],"ROUND","round")}(u[0],u)},Opal.modules["bcdice/translate"]=function(r){var u,q,M,Y,F,C,W=[],$=r.nil,t=r.module,e=r.hash2,S=r.def;return u=W,q=C=[t(W[0],"BCDice")].concat(u),Y=[M=t(C[0],"Translate")].concat(q),F=r.$r(Y),S(M,"$translate",function(J,Z){var I,m=this;if(null==m.locale&&(m.locale=$),null==Z)Z=e([],{});else if(!Z.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return I=r.kwrestargs(Z,{}),F("I18n").$translate(J,e(["locale","raise"],{locale:m.locale,raise:!0}).$merge(r.to_hash(I)))},-2)},Opal.modules["bcdice/result"]=function(r){var C,F,I,K,Z,q,W=[],$=r.nil,e=r.klass,p=r.send,S=r.to_a,G=r.rb_minus,u=r.def;return C=W,F=q=[(0,r.module)(W[0],"BCDice")].concat(C),[K=e(q[0],null,"Result")].concat(F),(Z=K.$$prototype).secret=Z.success=Z.failure=Z.critical=Z.fumble=$,u(I=r.get_singleton_class(K),"$success",function(P){return p(this.$new(),"tap",[],function(k){var g=$;return null==k&&(k=$),p(k,"text=",S(g=[P])),G(g.length,1),p(k,"success=",S(g=[!0])),g[G(g.length,1)]},1)},1),u(I,"$failure",function(P){return p(this.$new(),"tap",[],function(k){var g=$;return null==k&&(k=$),p(k,"text=",S(g=[P])),G(g.length,1),p(k,"failure=",S(g=[!0])),g[G(g.length,1)]},1)},1),u(I,"$critical",function(P){return p(this.$new(),"tap",[],function(k){var g=$;return null==k&&(k=$),p(k,"text=",S(g=[P])),G(g.length,1),p(k,"critical=",S(g=[!0])),G(g.length,1),p(k,"success=",S(g=[!0])),g[G(g.length,1)]},1)},1),u(I,"$fumble",function(P){return p(this.$new(),"tap",[],function(k){var g=$;return null==k&&(k=$),p(k,"text=",S(g=[P])),G(g.length,1),p(k,"fumble=",S(g=[!0])),G(g.length,1),p(k,"failure=",S(g=[!0])),g[G(g.length,1)]},1)},1),u(I,"$nothing",function(){return"nothing"},0),u(K,"$initialize",function(m){var o=this;return null==m&&(m=$),o.text=m,o.rands=$,o.detailed_rands=$,o.secret=!1,o.success=!1,o.failure=!1,o.critical=!1,o.fumble=!1},-1),K.$attr_accessor("text","rands","detailed_rands"),K.$attr_writer("secret","success","failure","critical","fumble"),u(K,"$secret?",function(){return this.secret},0),u(K,"$success?",function(){return this.success},0),u(K,"$failure?",function(){return this.failure},0),u(K,"$critical?",function(){return this.critical},0),u(K,"$fumble?",function(){return this.fumble},0),u(K,"$condition=",function(m){return this.success=m,this.failure=m["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var w,_,v,$=[],t=r.$r($),e=r.nil,p=r.$$$,S=r.module,G=r.klass,u=r.truthy,B=r.const_set,C=r.defs,y=r.gvars,q=r.rb_lt,M=r.send,Y=r.to_a,F=r.rb_minus,K=r.def,J=r.to_ary,Z=r.neqeq,I=r.rb_plus,m=r.eqeq,o=r.rb_ge,P=r.rb_gt,V=r.eqeqeq,H=r.rb_le,k=r.rb_times;return w=$,_=[S($[0],"Racc")].concat(w),v=r.$r(_),G(_[0],v("StandardError"),"ParseError"),u(p("::","ParseError","skip_raise")?"constant":e)||B($[0],"ParseError",p(t("Racc"),"ParseError")),function(g,w){var n,i,h,x,b,v=[S(g,"Racc")].concat(w),f=r.$r(v);return u(f("Racc_No_Extensions","skip_raise")?"constant":e)||B(v[0],"Racc_No_Extensions",!1),n=v,h=[i=G(v[0],null,"Parser")].concat(n),x=r.$r(h),(b=i.$$prototype).yydebug=b.racc_debug_out=b.racc_error_status=b.racc_t=b.racc_vstack=b.racc_val=b.racc_state=b.racc_tstack=e,B(h[0],"Racc_Runtime_Version","1.4.6"),B(h[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),B(h[0],"Racc_Runtime_Core_Version_R","1.4.6"),B(h[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),B(h[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),B(h[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),B(h[0],"Racc_Runtime_Core_Version",x("Racc_Runtime_Core_Version_R")),B(h[0],"Racc_Runtime_Core_Revision",x("Racc_Runtime_Core_Revision_R")),B(h[0],"Racc_Runtime_Type","ruby"),C(x("Parser"),"$racc_runtime_type",function(){return x("Racc_Runtime_Type")},0),K(i,"$_racc_setup",function(){var A,L,s=this,j=e,R=e,ie=e;return null==y.stderr&&(y.stderr=e),u(p(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),u(null!=(A=s.yydebug)&&A!==e?"instance-variable":e)||(s.yydebug=!1),u(s.yydebug)&&(u(null!=(L=s.racc_debug_out)&&L!==e?"instance-variable":e)||(s.racc_debug_out=y.stderr),s.racc_debug_out=u(j=s.racc_debug_out)?j:y.stderr),R=p(s.$class(),"Racc_arg"),u(q(R.$size(),14))&&(M(R,"[]=",Y(ie=[13,!0])),F(ie.length,1)),R},0),K(i,"$_racc_init_sysvars",function(){var A=this;return A.racc_state=[0],A.racc_tstack=[],A.racc_vstack=[],A.racc_t=e,A.racc_val=e,A.racc_read_next=!0,A.racc_user_yyerror=!1,A.racc_error_status=0},0),K(i,"$do_parse",function(){return this.$__send__(x("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),K(i,"$next_token",function(){return this.$raise(x("NotImplementedError"),this.$class()+"#next_token is not defined")},0),K(i,"$_racc_do_parse_rb",function(A,L){var s,R=this,ie=e,le=e,_e=e,oe=e,$e=e,E=e,re=e,T=e;return s=J(A),ie=null==s[0]?e:s[0],le=null==s[1]?e:s[1],_e=null==s[2]?e:s[2],oe=null==s[3]?e:s[3],$e=null==s[10]?e:s[10],R.$_racc_init_sysvars(),E=re=T=e,M(R,"catch",["racc_end_parse"],function N(){var U,O,d=null==N.$$s?this:N.$$s,D=e;for(null==d.racc_state&&(d.racc_state=e),null==d.racc_read_next&&(d.racc_read_next=e),null==d.racc_t&&(d.racc_t=e),null==d.yydebug&&(d.yydebug=e),null==d.racc_val&&(d.racc_val=e);u(!0);)for(u(T=oe["$[]"](d.racc_state["$[]"](-1)))?(u(d.racc_read_next)&&Z(d.racc_t,0)&&(O=d.$next_token(),U=J(O),E=null==U[0]?e:U[0],d.racc_val=null==U[1]?e:U[1],d.racc_t=u(E)?u(D=$e["$[]"](E))?D:1:0,u(d.yydebug)&&d.$racc_read_token(d.racc_t,E,d.racc_val),d.racc_read_next=!1),T=I(T,d.racc_t),u(o(T,0))&&u(re=ie["$[]"](T))&&m(le["$[]"](T),d.racc_state["$[]"](-1))||(re=_e["$[]"](d.racc_state["$[]"](-1)))):re=_e["$[]"](d.racc_state["$[]"](-1));u(re=d.$_racc_evalact(re,A)););},{$$arity:0,$$s:R})},2),K(i,"$yyparse",function(A,L){return this.$__send__(x("Racc_YY_Parse_Method"),A,L,this.$_racc_setup(),!0)},2),K(i,"$_racc_yyparse_rb",function(A,L,s,j){var R,_e=e,oe=e,ue=e,$e=e,re=e,T=e,N=e;return R=J(s),_e=null==R[0]?e:R[0],oe=null==R[1]?e:R[1],ue=null==R[2]?e:R[2],$e=null==R[3]?e:R[3],re=null==R[10]?e:R[10],this.$_racc_init_sysvars(),T=e,N=e,M(this,"catch",["racc_end_parse"],function ne(){var d=null==ne.$$s?this:ne.$$s;for(null==d.racc_state&&(d.racc_state=e);!u(N=$e["$[]"](d.racc_state["$[]"](-1)));)for(;u(T=d.$_racc_evalact(ue["$[]"](d.racc_state["$[]"](-1)),s)););return M(A,"__send__",[L],function D(ee,ae){var X=null==D.$$s?this:D.$$s,Q=e,fe=e;for(null==X.racc_t&&(X.racc_t=e),null==X.racc_state&&(X.racc_state=e),null==X.racc_read_next&&(X.racc_read_next=e),null==ee&&(ee=e),null==ae&&(ae=e),X.racc_t=u(ee)?u(Q=re["$[]"](ee))?Q:1:0,X.racc_val=ae,X.racc_read_next=!1,N=I(N,X.racc_t),u(o(N,0))&&u(T=_e["$[]"](N))&&m(oe["$[]"](N),X.racc_state["$[]"](-1))||(T=ue["$[]"](X.racc_state["$[]"](-1)));u(T=X.$_racc_evalact(T,s)););for(;u(u(Q=u(fe=(N=$e["$[]"](X.racc_state["$[]"](-1)))["$!"]())?fe:X.racc_read_next["$!"]())?Q:X.racc_t["$=="](0));)for(u(N)&&u(N=I(N,X.racc_t))&&u(o(N,0))&&u(T=_e["$[]"](N))&&m(oe["$[]"](N),X.racc_state["$[]"](-1))||(T=ue["$[]"](X.racc_state["$[]"](-1)));u(T=X.$_racc_evalact(T,s)););},{$$arity:2,$$s:d})},{$$arity:0,$$s:this})},4),K(i,"$_racc_evalact",function(A,L){var s,ue,R=this,ie=e,le=e,oe=e,$e=e,E=e,re=e,T=e;if(ie=null==(s=J(L))[0]?e:s[0],le=null==s[1]?e:s[1],oe=null==s[3]?e:s[3],ue=null==s[11]?e:s[11],$e=null==s[12]?e:s[12],u(P(A,0))&&u(q(A,ue)))u(P(R.racc_error_status,0))&&(m(R.racc_t,1)||(R.racc_error_status=F(R.racc_error_status,1))),R.racc_vstack.$push(R.racc_val),R.racc_state.$push(A),R.racc_read_next=!0,u(R.yydebug)&&(R.racc_tstack.$push(R.racc_t),R.$racc_shift(R.racc_t,R.racc_tstack,R.racc_vstack));else if(u(q(A,0))&&u(P(A,$e["$-@"]()))){if(E=M(R,"catch",["racc_jump"],function N(){var ne=null==N.$$s?this:N.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(L,A)),!1},{$$arity:0,$$s:R}),u(E)){if(V(1,re=E))return R.racc_user_yyerror=!0,$e["$-@"]();if(V(2,re))return ue;R.$raise("[Racc Bug] unknown jump code")}}else if(m(A,ue))u(R.yydebug)&&R.$racc_accept(),R.$throw("racc_end_parse",R.racc_vstack["$[]"](0));else{if(m(A,$e["$-@"]())){for(V(0,re=R.racc_error_status)?u(L["$[]"](21))||R.$on_error(R.racc_t,R.racc_val,R.racc_vstack):V(3,re)&&(m(R.racc_t,0)&&R.$throw("racc_end_parse",e),R.racc_read_next=!0),R.racc_user_yyerror=!1,R.racc_error_status=3;u(!0)&&!(u(T=oe["$[]"](R.racc_state["$[]"](-1)))&&(T=I(T,1),u(o(T,0))&&u(A=ie["$[]"](T))&&m(le["$[]"](T),R.racc_state["$[]"](-1))));)u(H(R.racc_state.$size(),1))&&R.$throw("racc_end_parse",e),R.racc_state.$pop(),R.racc_vstack.$pop(),u(R.yydebug)&&(R.racc_tstack.$pop(),R.$racc_e_pop(R.racc_state,R.racc_tstack,R.racc_vstack));return A}R.$raise("[Racc Bug] unknown action "+A.$inspect())}return u(R.yydebug)&&R.$racc_next_state(R.racc_state["$[]"](-1),R.racc_state),e},2),K(i,"$_racc_do_reduce",function(A,L){var s,$e,re,d,D,ee,X,R=this,le=e,_e=e,oe=e,ue=e,E=e,T=e,N=e,ne=e,U=e,O=e,ae=e,te=e,se=e,Q=e;return le=null==(s=J(A))[4]?e:s[4],_e=null==s[5]?e:s[5],oe=null==s[6]?e:s[6],ue=null==s[7]?e:s[7],$e=null==s[8]?e:s[8],E=null==s[9]?e:s[9],re=null==s[13]?e:s[13],T=R.racc_state,N=R.racc_vstack,ne=R.racc_tstack,U=k(L,-3),O=E["$[]"](U),d=E["$[]"](I(U,1)),D=E["$[]"](I(U,2)),ee=[],u(R.yydebug)&&(ae=ne["$[]"](O["$-@"](),O)),te=N["$[]"](O["$-@"](),O),u(R.yydebug)&&(se=[O["$-@"](),O,ee],M(ne,"[]=",Y(se)),F(se.length,1)),se=[O["$-@"](),O,ee],M(N,"[]=",Y(se)),F(se.length,1),se=[O["$-@"](),O,ee],M(T,"[]=",Y(se)),F(se.length,1),u(re)?N.$push(R.$__send__(D,te,N,te["$[]"](0))):N.$push(R.$__send__(D,te,N)),ne.$push(d),u(R.yydebug)&&R.$racc_reduce(ae,d,ne,N),X=F(d,$e),u(U=ue["$[]"](X))&&(U=I(U,T["$[]"](-1)),u(o(U,0))&&u(Q=le["$[]"](U))&&m(_e["$[]"](U),X))?Q:oe["$[]"](X)},2),K(i,"$on_error",function(A,L,s){var R,j=this;return j.$raise(x("ParseError"),j.$sprintf("\nparse error on value %s (%s)",L.$inspect(),u(R=j.$token_to_str(A))?R:"?"))},3),K(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),K(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),K(i,"$yyerrok",function(){return this.racc_error_status=0},0),K(i,"$racc_read_token",function(A,L,s){var j=this;return j.racc_debug_out.$print("read    "),j.racc_debug_out.$print(L.$inspect(),"(",j.$racc_token2str(A),") "),j.racc_debug_out.$puts(s.$inspect()),j.racc_debug_out.$puts()},3),K(i,"$racc_shift",function(A,L,s){var j=this;return j.racc_debug_out.$puts("shift   "+j.$racc_token2str(A)),j.$racc_print_stacks(L,s),j.racc_debug_out.$puts()},3),K(i,"$racc_reduce",function(A,L,s,j){var R=this,ie=e;return(ie=R.racc_debug_out).$print("reduce "),u(A["$empty?"]())?ie.$print(" <none>"):M(A,"each",[],function le(_e){return null==_e&&(_e=e),ie.$print(" ",(null==le.$$s?this:le.$$s).$racc_token2str(_e))},{$$arity:1,$$s:R}),ie.$puts(" --\x3e "+R.$racc_token2str(L)),R.$racc_print_stacks(s,j),R.racc_debug_out.$puts()},4),K(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),K(i,"$racc_e_pop",function(A,L,s){var j=this;return j.racc_debug_out.$puts("error recovering mode: pop token"),j.$racc_print_states(A),j.$racc_print_stacks(L,s),j.racc_debug_out.$puts()},3),K(i,"$racc_next_state",function(A,L){var s=this;return s.racc_debug_out.$puts("goto    "+A),s.$racc_print_states(L),s.racc_debug_out.$puts()},2),K(i,"$racc_print_stacks",function(A,L){var j=e;return(j=this.racc_debug_out).$print("        ["),M(A,"each_index",[],function R(ie){return null==ie&&(ie=e),j.$print(" (",(null==R.$$s?this:R.$$s).$racc_token2str(A["$[]"](ie))," ",L["$[]"](ie).$inspect(),")")},{$$arity:1,$$s:this}),j.$puts(" ]")},2),K(i,"$racc_print_states",function(A){var s=e;return(s=this.racc_debug_out).$print("        ["),M(A,"each",[],function(R){return null==R&&(R=e),s.$print(" ",R)},1),s.$puts(" ]")},1),K(i,"$racc_token2str",function(A){var s;return u(s=p(this.$class(),"Racc_token_to_s_table")["$[]"](A))?s:this.$raise("[Racc Bug] can't convert token "+A+" to string")},1),K(i,"$token_to_str",function(A){return p(this.$class(),"Racc_token_to_s_table")["$[]"](A)},1)}($[0],$)},Opal.modules["bcdice/arithmetic/node"]=function(r){var F,I,V,_,v,k,g,o,J,W=[],$=r.nil,t=r.$$$,e=r.module,p=r.klass,S=r.def,G=r.send2,u=r.find_super,B=r.eqeq,C=r.const_set,y=r.eqeqeq,q=r.rb_divide,M=r.alias;return F=W,I=J=[e(W[0],"BCDice")].concat(F),V=o=[e(J[0],"Arithmetic")].concat(I),k=[e(o[0],"Node")].concat(V),g=r.$r(k),(v=(_=p(k[0],null,"BinaryOp")).$$prototype).lhs=v.rhs=v.op=$,S(_,"$initialize",function(a,c,n){var i=this;return i.lhs=a,i.op=c,i.rhs=n},3),S(_,"$eval",function(a){var i,c=this,n=$;return n=c.lhs.$eval(a),i=c.rhs.$eval(a),n.$send(c.op,i)},1),S(_,"$output",function(){var a=this;return""+a.lhs.$output()+a.op+a.rhs.$output()},0),S(_,"$s_exp",function(){var a=this;return"("+a.$op_for_s_exp()+" "+a.lhs.$s_exp()+" "+a.rhs.$s_exp()+")"},0),S(_,"$op_for_s_exp",function(){return this.op},0),function(w,z,_){var v=p(w,z,"DivideBase"),f=[v].concat(_),a=r.$r(f),c=v.$$prototype;c.lhs=c.rhs=c.op=$,S(v,"$initialize",function n(i,h){return delete n.$$p,G(this,u(this,"initialize",n,!1,!0),"initialize",[i,"/",h],null)},2),S(v,"$eval",function(i){var x,b,h=this;return x=h.lhs.$eval(i),b=h.rhs.$eval(i),B(b,0)&&h.$raise(a("ZeroDivisionError")),h.$divide_and_round(x,b,i)},1),S(v,"$output",function n(){var i=n.$$p||$,h=this;return delete n.$$p,""+G(h,u(h,"output",n,!1,!0),"output",[],i)+h.$rounding_method()},0),v.$private(),S(v,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")},0),S(v,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),S(v,"$divide_and_round",function(i,h,x){return this.$raise(a("NotImplementedError"))},3)}(k[0],g("BinaryOp"),k),function(w,z,_){var v=p(w,z,"DivideWithGameSystemDefault"),f=[v].concat(_),a=r.$r(f);C(f[0],"ROUNDING_METHOD",""),v.$private(),S(v,"$divide_and_round",function(n,i,h){var x;return y(t(a("RoundType"),"CEIL"),x=h)?q(n.$to_f(),i).$ceil():y(t(a("RoundType"),"ROUND"),x)?q(n.$to_f(),i).$round():q(n,i).$floor()},3)}(k[0],g("DivideBase"),k),function(w,z,_){var v=p(w,z,"DivideWithCeil"),f=[v].concat(_);C(f[0],"ROUNDING_METHOD","C"),v.$private(),S(v,"$divide_and_round",function(c,n,i){return q(c.$to_f(),n).$ceil()},3)}(k[0],g("DivideBase"),k),function(w,z,_){var v=p(w,z,"DivideWithRound"),f=[v].concat(_);C(f[0],"ROUNDING_METHOD","R"),v.$private(),S(v,"$divide_and_round",function(c,n,i){return q(c.$to_f(),n).$round()},3)}(k[0],g("DivideBase"),k),function(w,z,_){var v=p(w,z,"DivideWithFloor"),f=[v].concat(_);C(f[0],"ROUNDING_METHOD","F"),v.$private(),S(v,"$divide_and_round",function(c,n,i){return q(c,n).$to_i()},3)}(k[0],g("DivideBase"),k),function(w,z){var _=p(w,null,"Negative");_.$$prototype.body=$,S(_,"$initialize",function(a){return this.body=a},1),S(_,"$eval",function(a){return this.body.$eval(a)["$-@"]()},1),S(_,"$output",function(){return"-"+this.body.$output()},0),S(_,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(k[0]),function(w,z){var _=p(w,null,"Parenthesis");_.$$prototype.expr=$,S(_,"$initialize",function(a){return this.expr=a},1),S(_,"$eval",function(a){return this.expr.$eval(a)},1),S(_,"$output",function(){return"("+this.expr.$output()+")"},0),S(_,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(k[0]),function(w,z){var _=p(w,null,"Number");return _.$$prototype.value=$,S(_,"$initialize",function(a){return this.value=a},1),S(_,"$eval",function(a){return this.value},1),S(_,"$output",function(){return this.value.$to_s()},0),M(_,"s_exp","output")}(k[0])},Opal.modules.strscan=function(r){var Y,F,K,J,Z,W=[],$=r.nil,e=r.def,p=r.truthy,S=r.eqeqeq,G=r.Opal,u=r.send,B=r.to_a,C=r.rb_minus,y=r.alias;return Y=W,K=[F=(0,r.klass)(W[0],null,"StringScanner")].concat(Y),J=r.$r(K),(Z=F.$$prototype).pos=Z.string=Z.working=Z.matched=Z.prev_pos=Z.match=$,F.$attr_reader("pos","matched"),e(F,"$initialize",function(m){var o=this;return o.string=m,o.pos=0,o.matched=$,o.working=m,o.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var m=this;return 0===m.pos||"\n"===m.string.charAt(m.pos-1)},0),e(F,"$scan",function(m){var o=this,P=(m=o.$anchor(m)).exec(o.working);return null==P?o.matched=$:"object"==typeof P?(o.prev_pos=o.pos,o.pos+=P[0].length,o.working=o.working.substring(P[0].length),o.matched=P[0],o.match=P,P[0]):"string"==typeof P?(o.pos+=P.length,o.working=o.working.substring(P.length),P):$},1),e(F,"$scan_until",function(m){var o=this;m=o.$anchor(m);for(var H,P=o.pos,V=o.working;;){if(H=m.exec(V),P+=1,V=V.substr(1),null!=H)return o.matched=o.string.substr(o.pos,P-o.pos-1+H[0].length),o.match=H,o.prev_pos=P-1,o.pos=P,o.working=V.substr(H[0].length),o.matched;if(0===V.length)return o.match=[],o.matched=$}},1),e(F,"$[]",function(m){var P;if(p(this.match["$empty?"]()))return $;S(J("Symbol"),P=m)?m=m.$to_s():S(J("String"),P)||(m=G["$coerce_to!"](m,J("Integer"),"to_int"));var V=this.match;return m<0&&(m+=V.length),m<0||m>=V.length||null==V[m]?$:V[m]},1),e(F,"$check",function(m){var o=this,P=(m=o.$anchor(m)).exec(o.working);return o.matched=null==P?$:P[0]},1),e(F,"$check_until",function(m){var o=this,P=o.prev_pos,V=o.pos,H=o.$scan_until(m);return H!==$&&(o.matched=H.substr(-1),o.working=o.string.substr(V)),o.prev_pos=P,o.pos=V,H},1),e(F,"$peek",function(m){return this.working.substring(0,m)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(m){var P=m.exec(this.working);return null==P?$:0==P.index?0:P.index+1},1),e(F,"$skip",function(m){var o=this,P=(m=o.$anchor(m)).exec(o.working);if(null==P)return o.match=[],o.matched=$;var V=P[0],H=V.length;return o.matched=V,o.match=P,o.prev_pos=o.pos,o.pos+=H,o.working=o.working.substring(H),H},1),e(F,"$skip_until",function(m){var P=this.$scan_until(m);return P===$?$:(this.matched=P.substr(-1),P.length)},1),e(F,"$get_byte",function(){var m=this,o=$;return m.pos<m.string.length?(m.prev_pos=m.pos,m.pos+=1,o=m.matched=m.working.substring(0,1),m.working=m.working.substring(1)):m.matched=$,o},0),e(F,"$match?",function(m){var o=this,P=(m=o.$anchor(m)).exec(o.working);return null==P?$:(o.prev_pos=o.pos,P[0].length)},1),e(F,"$pos=",function(m){var o=this;return m<0&&(m+=o.string.$length()),o.pos=m,o.working=o.string.slice(m)},1),e(F,"$matched_size",function(){return this.matched===$?$:this.matched.length},0),e(F,"$post_match",function(){var m=this;return m.matched===$?$:m.string.substr(m.pos)},0),e(F,"$pre_match",function(){var m=this;return m.matched===$?$:m.string.substr(0,m.prev_pos)},0),e(F,"$reset",function(){var m=this;return m.working=m.string,m.matched=$,m.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var o,m=this;return m.match=$,o=[m.string.$length()],u(m,"pos=",B(o)),o[C(o.length,1)]},0),e(F,"$unscan",function(){var m=this;return m.pos=m.prev_pos,m.prev_pos=$,m.match=$,m},0),y(F,"bol?","beginning_of_line?"),y(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(m){var o=m.toString().match(/\/([^\/]+)$/);return o=o?o[1]:void 0,new RegExp("^(?:"+m.source+")",o)},1)},Opal.modules["bcdice/normalize"]=function(r){var u,q,C,W=[],$=r.nil,t=r.module,e=r.eqeqeq,p=r.def,S=r.eqeq;return u=W,C=[t(W[0],"BCDice")].concat(u),(q=t(C[0],"Normalize")).$module_function(),p(q,"$comparison_operator",function(Y){var F;return e(/<=|=</,F=Y)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":$},1),p(q,"$target_number",function(Y){return S(Y,"?")?Y:Y.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var q,K,o,P,V,H,k,Z,Y,W=r.top,$=[],t=r.nil,e=r.module,p=r.klass,S=r.const_set,G=r.hash2,u=r.truthy,B=r.send,C=r.def;return W.$require("strscan"),W.$require("bcdice/normalize"),q=$,K=Y=[e($[0],"BCDice")].concat(q),o=Z=[e(Y[0],"Command")].concat(K),V=[P=p(Z[0],null,"Lexer")].concat(o),H=r.$r(V),(k=P.$$prototype).scanner=k.notations=t,S(V[0],"SYMBOLS",G(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),C(P,"$initialize",function(w,z){var _,v,a;return w=u(a=(v=(_=w)===t||null==_?t:B(_,"split",[" ",2]))===t||null==v?t:B(v,"first",[]))?a:"",this.scanner=H("StringScanner").$new(w),this.notations=B(z,"map",[],function(n){return null==n&&(n=t),u(n["$is_a?"](H("String")))?H("Regexp").$new(n):n},1)},2),C(P,"$next_token",function(){try{var w=this,z=t,_=t,f=t,a=t;return u(w.scanner["$eos?"]())?[!1,"$"]:(B(w.notations,"each",[],function c(n){var h,i=null==c.$$s?this:c.$$s;if(null==i.scanner&&(i.scanner=t),null==n&&(n=t),h=i.scanner.$scan(n),!u(h))return t;r.ret(["NOTATION",h])},{$$arity:1,$$s:w}),u(z=w.scanner.$scan(/\d+/))?["NUMBER",z.$to_i()]:u(_=w.scanner.$scan(/[<>!=]+/))?(_=H("Normalize").$comparison_operator(_),[u(_)?"CMP_OP":"ILLEGAL",_]):(f=w.scanner.$getch().$upcase(),[u(a=H("SYMBOLS")["$[]"](f))?a:f.$to_sym(),f]))}catch(c){if(c===r.returner)return c.$v;throw c}},0),C(P,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var B,M,Z,I,m,o,P,F,y,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.truthy,G=r.eqeqeq;return B=W,M=y=[t(W[0],"BCDice")].concat(B),Z=F=[t(y[0],"Command")].concat(M),m=[I=e(F[0],null,"Parsed")].concat(Z),o=r.$r(m),(P=I.$$prototype).question_target=P.critical=P.fumble=P.dollar=P.modify_number=P.target_number=P.prefix_number=P.command=P.suffix_number=P.cmp_op=$,I.$attr_accessor("command"),I.$attr_accessor("prefix_number"),I.$attr_accessor("suffix_number"),I.$attr_accessor("critical"),I.$attr_accessor("fumble"),I.$attr_accessor("dollar"),I.$attr_accessor("modify_number"),I.$attr_accessor("cmp_op"),I.$attr_accessor("target_number"),I.$attr_writer("question_target"),p(I,"$initialize",function(){var H=this;return H.prefix_number=$,H.suffix_number=$,H.critical=$,H.fumble=$,H.dollar=$,H.cmp_op=$,H.target_number=$,H.question_target=!1},0),p(I,"$question_target?",function(){return this.question_target},0),p(I,"$to_s",function(H){var f,k=this,g=$,w=$,z=$,_=$,v=$;return null==H&&(H="after_command"),g=S(k.critical)?"@"+k.critical:$,w=S(k.fumble)?"#"+k.fumble:$,z=S(k.dollar)?"$"+k.dollar:$,_=o("Format").$modifier(k.modify_number),v=S(k.question_target)?"?":k.target_number,G("after_command",f=H)?[k.prefix_number,k.command,k.suffix_number,g,w,z,_,k.cmp_op,v].$join():G("after_modify_number",f)?[k.prefix_number,k.command,k.suffix_number,_,g,w,z,k.cmp_op,v].$join():G("after_target_number",f)?[k.prefix_number,k.command,k.suffix_number,_,k.cmp_op,v,g,w,z].$join():$},-1)},Opal.modules["bcdice/command/parser"]=function(r){var o,k,f,i,h,x,b,l,A,L,s,j,le,a,c,n,ue,w,z,V,W=r.top,$=[],t=r.$r($),e=r.nil,p=r.$$$,S=r.klass,G=r.module,u=r.hash2,B=r.send2,C=r.find_super,y=r.def,q=r.send,M=r.to_a,Y=r.rb_minus,F=r.eqeq,K=r.hash,J=r.const_set,Z=r.truthy,I=r.to_ary;return W.$require("racc/parser.rb"),W.$require("bcdice/arithmetic/node"),W.$require("bcdice/command/lexer"),W.$require("bcdice/command/parsed"),S(p(t("BCDice"),"Command"),p(t("Racc"),"Parser"),"Parser"),o=$,k=V=[G($[0],"BCDice")].concat(o),w=[G(V[0],"Command")].concat(k),z=r.$r(w),f=w,c=[a=S(w[0],p(z("Racc"),"Parser"),"Parser")].concat(f),n=r.$r(c),(ue=a.$$prototype).notations=ue.lexer=ue.modifier=ue.suffix_number=ue.prefix_number=ue.need_suffix_number=ue.need_prefix_number=ue.critical=ue.fumble=ue.dollar=ue.allowed_cmp_op=ue.question_target=e,y(a,"$initialize",function $e(E,re){var T,N,ne,U,d=this;if(delete $e.$$p,T=r.slice.call(arguments),null==(N=r.extract_kwargs(T)))N=u([],{});else if(!N.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=T,!r.hasOwnProperty.call(N.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return U=N.$$smap.round_type,B(d,C(d,"initialize",$e,!1,!0),"initialize",[],null),d.notations=ne,d.round_type=U,d.prefix_number=!1,d.suffix_number=!1,d.need_prefix_number=!1,d.need_suffix_number=!1,d.modifier=!0,d.critical=!1,d.fumble=!1,d.dollar=!1,d.allowed_cmp_op=[e,">=",">","<=","<","==","!="],d.question_target=!1},-2),y(a,"$disable_modifier",function(){return this.modifier=!1,this},0),y(a,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),y(a,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),y(a,"$has_prefix_number",function(){var E=this;return E.prefix_number=!0,E.need_prefix_number=!0,E},0),y(a,"$has_suffix_number",function(){var E=this;return E.suffix_number=!0,E.need_suffix_number=!0,E},0),y(a,"$enable_critical",function(){return this.critical=!0,this},0),y(a,"$enable_fumble",function(){return this.fumble=!0,this},0),y(a,"$enable_dollar",function(){return this.dollar=!0,this},0),y(a,"$restrict_cmp_op_to",function(E){var re,N=this;return re=r.slice.call(arguments),N.allowed_cmp_op=re,N},-1),y(a,"$enable_question_target",function(){return this.question_target=!0,this},0),y(a,"$parse",function(E){try{return this.lexer=n("Lexer").$new(E,this.notations),this.$do_parse()}catch(T){if(!r.rescue(T,[n("ParseError"),n("ZeroDivisionError")]))throw T;try{return e}finally{r.pop_exception()}}},1),a.$private(),y(a,"$parsed",function(E,re,T,N){return q(n("Parsed").$new(),"tap",[],function U(O){var d,D,ee,ae,te,se,X=null==U.$$s?this:U.$$s,Q=e;return null==X.round_type&&(X.round_type=e),null==O&&(O=e),Q=[E["$[]"]("command")],q(O,"command=",M(Q)),Y(Q.length,1),Q=[(d=E["$[]"]("prefix"),d===e||null==d?e:q(d,"eval",[X.round_type]))],q(O,"prefix_number=",M(Q)),Y(Q.length,1),Q=[(D=E["$[]"]("suffix"),D===e||null==D?e:q(D,"eval",[X.round_type]))],q(O,"suffix_number=",M(Q)),Y(Q.length,1),Q=[(ee=re["$[]"]("critical"),ee===e||null==ee?e:q(ee,"eval",[X.round_type]))],q(O,"critical=",M(Q)),Y(Q.length,1),Q=[(ae=re["$[]"]("fumble"),ae===e||null==ae?e:q(ae,"eval",[X.round_type]))],q(O,"fumble=",M(Q)),Y(Q.length,1),Q=[(te=re["$[]"]("dollar"),te===e||null==te?e:q(te,"eval",[X.round_type]))],q(O,"dollar=",M(Q)),Y(Q.length,1),Q=[T.$eval(X.round_type)],q(O,"modify_number=",M(Q)),Y(Q.length,1),Q=[N["$[]"]("cmp_op")],q(O,"cmp_op=",M(Q)),Y(Q.length,1),F(N["$[]"]("target"),"?")?(q(O,"question_target=",M(Q=[!0])),Y(Q.length,1),q(O,"target_number=",M(Q=[0])),Q[Y(Q.length,1)]):(q(O,"question_target=",M(Q=[!1])),Y(Q.length,1),Q=[(se=N["$[]"]("target"),se===e||null==se?e:q(se,"eval",[X.round_type]))],q(O,"target_number=",M(Q)),Q[Y(Q.length,1)])},{$$arity:1,$$s:this})},4),y(a,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],h=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],x=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],b=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],l=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],A=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],L=[e,6,13,3,9,-1,27,-15,-10,-1,-38],s=[e,e,e,e,e,e,19,16,15,e,e],j=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],le=K(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),J(c[0],"Racc_arg",[i,h,b,x,l,A,s,L,19,j,le,58,35,!0]),J(c[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),J(c[0],"Racc_debug_parser",!1),y(a,"$_reduce_1",function(E,re,T){var N,U=this;return Z(U.modifier)||U.$raise(n("ParseError")),N=I(E),U.$parsed(null==N[0]?e:N[0],null==N[1]?e:N[1],null==N[2]?e:N[2],null==N[3]?e:N[3])},3),y(a,"$_reduce_2",function(E,re,T){var N,U=this;return Z(U.modifier)||U.$raise(n("ParseError")),N=I(E),U.$parsed(null==N[0]?e:N[0],null==N[2]?e:N[2],null==N[1]?e:N[1],null==N[3]?e:N[3])},3),y(a,"$_reduce_3",function(E,re,T){var N,D;return D=null==(N=I(E))[2]?e:N[2],this.$parsed(null==N[0]?e:N[0],null==N[1]?e:N[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),D)},3),y(a,"$_reduce_4",function(E,re,T){var N=this;return Z(N.prefix_number)&&Z(N.suffix_number)||N.$raise(n("ParseError")),u(["command","prefix","suffix"],{command:E["$[]"](1),prefix:E["$[]"](0),suffix:E["$[]"](2)})},3),y(a,"$_reduce_5",function(E,re,T){var N=this;return Z(N.prefix_number)||N.$raise(n("ParseError")),Z(N.need_suffix_number)&&N.$raise(n("ParseError")),u(["command","prefix"],{command:E["$[]"](1),prefix:E["$[]"](0)})},3),y(a,"$_reduce_6",function(E,re,T){var N=this;return Z(N.suffix_number)||N.$raise(n("ParseError")),Z(N.need_prefix_number)&&N.$raise(n("ParseError")),u(["command","suffix"],{command:E["$[]"](0),suffix:E["$[]"](1)})},3),y(a,"$_reduce_7",function(E,re,T){var N=this;return(Z(N.need_prefix_number)||Z(N.need_suffix_number))&&N.$raise(n("ParseError")),u(["command"],{command:E["$[]"](0)})},3),y(a,"$_reduce_8",function(E,re,T){return u([],{})},3),y(a,"$_reduce_9",function(E,re,T){var N,D,ee,O=e;return O=null==(N=I(E))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.critical)&&Z(O["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",M(ee=["critical",D])),Y(ee.length,1),O},3),y(a,"$_reduce_10",function(E,re,T){var N,D,ee,O=e;return O=null==(N=I(E))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.fumble)&&Z(O["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",M(ee=["fumble",D])),Y(ee.length,1),O},3),y(a,"$_reduce_11",function(E,re,T){var N,D,ee,O=e;return O=null==(N=I(E))[0]?e:N[0],D=null==N[2]?e:N[2],Z(this.dollar)&&Z(O["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),q(O,"[]=",M(ee=["dollar",D])),Y(ee.length,1),O},3),y(a,"$_reduce_12",function(E,re,T){return E["$[]"](1)},3),y(a,"$_reduce_13",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"Negative").$new(E["$[]"](1))},3),y(a,"$_reduce_14",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(E["$[]"](0),"+",E["$[]"](2))},3),y(a,"$_reduce_15",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(E["$[]"](0),"-",E["$[]"](2))},3),y(a,"$_reduce_16",function(E,re,T){return Z(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),u([],{})},3),y(a,"$_reduce_17",function(E,re,T){var N,O,d;return d=null==(N=I(E))[1]?e:N[1],Z(this.allowed_cmp_op["$include?"](O=null==N[0]?e:N[0]))||this.$raise(n("ParseError")),u(["cmp_op","target"],{cmp_op:O,target:d})},3),y(a,"$_reduce_18",function(E,re,T){var ne,N=this;return ne=E["$[]"](0),Z(N.question_target)||N.$raise(n("ParseError")),Z(N.allowed_cmp_op["$include?"](ne))||N.$raise(n("ParseError")),u(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),y(a,"$_reduce_19",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(E["$[]"](0),"+",E["$[]"](2))},3),y(a,"$_reduce_20",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(E["$[]"](0),"-",E["$[]"](2))},3),y(a,"$_reduce_22",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(E["$[]"](0),"*",E["$[]"](2))},3),y(a,"$_reduce_23",function(E,re,T){return E["$[]"](3).$new(E["$[]"](0),E["$[]"](2))},3),y(a,"$_reduce_25",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),y(a,"$_reduce_26",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),y(a,"$_reduce_27",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),y(a,"$_reduce_28",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),y(a,"$_reduce_29",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),y(a,"$_reduce_30",function(E,re,T){return E["$[]"](1)},3),y(a,"$_reduce_31",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"Negative").$new(E["$[]"](1))},3),y(a,"$_reduce_33",function(E,re,T){return E["$[]"](1)},3),y(a,"$_reduce_34",function(E,re,T){return p(p(n("Arithmetic"),"Node"),"Number").$new(E["$[]"](0))},3),y(a,"$_reduce_none",function(E,re,T){return E["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var B,M,J,Z,I,m,F,y,W=[],$=r.nil,t=r.module,e=r.send,p=r.eqeqeq,S=r.truthy,G=r.def;return B=W,M=y=[t(W[0],"BCDice")].concat(B),J=F=[t(y[0],"Deprecated")].concat(M),I=[Z=t(F[0],"Checker")].concat(J),m=r.$r(I),Z.$private(),G(Z,"$check_result_legacy",function(P,V,H,k){var _,g=this,w=$,z=$,v=$,f=$;return w=e(V,"map",[],"sides".$to_proc()),_=(z=e(V,"map",[],"value".$to_proc())).$sum(),v=p([100],f=w)?g.$check_1D100(P,_,H,k):p([20],f)?g.$check_1D20(P,_,H,k):p([6,6],f)?g.$check_2D6(P,_,z,H,k):$,(S(v["$nil?"]())||S(v["$empty?"]()))&&(v=p([10],f=w.$uniq())?g.$check_nD10(P,_,z,H,k):p([6],f)?g.$check_nD6(P,_,z,H,k):$,S(v["$nil?"]())||S(v["$empty?"]()))?$:m("Result").$new(v.$delete_prefix(" \uff1e "))},4),G(Z,"$check_1D100",function(P,V,H,k){return $},4),G(Z,"$check_1D20",function(P,V,H,k){return $},4),G(Z,"$check_nD10",function(P,V,H,k,g){return $},5),G(Z,"$check_2D6",function(P,V,H,k,g){return $},5),G(Z,"$check_nD6",function(P,V,H,k,g){return $},5)},Opal.modules["bcdice/base"]=function(r){var V,z,c,i,h,_,v,f,a,k,W=r.top,$=[],t=r.$r($),e=r.nil,p=r.$$$,S=r.module,G=r.klass,u=r.truthy,B=r.def,C=r.regexp,y=r.rb_plus,q=r.send,M=r.to_a,Y=r.rb_minus,F=r.eqeqeq,K=r.eqeq,J=r.range,Z=r.rb_divide,I=r.rb_times,m=r.rb_ge,o=e;return W.$require("i18n"),W.$require("i18n/backend/fallbacks"),W.$require("bcdice/randomizer"),W.$require("bcdice/dice_table"),W.$require("bcdice/enum"),W.$require("bcdice/translate"),W.$require("bcdice/result"),W.$require("bcdice/command/parser"),W.$require("bcdice/deprecated/checker"),V=$,z=k=[S($[0],"BCDice")].concat(V),v=[_=G(k[0],null,"Base")].concat(z),f=r.$r(v),(a=_.$$prototype).sort_add_dice=a.sort_barabara_dice=a.enabled_d9=a.raw_input=a.randomizer=a.enabled_upcase_input=a.debug=e,i=[c=r.get_singleton_class(_)].concat(v),h=r.$r(i),c.$attr_reader("prefixes"),B(c,"$register_prefix",function(b){var A,L=this,s=e;return null==L.prefixes&&(L.prefixes=e),A=r.slice.call(arguments),L.prefixes=u(s=L.prefixes)?s:[],L.prefixes.$concat(A.$flatten())},-1),B(c,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),B(c,"$prefixes_pattern",function(){var b=this,l=e;return null==b.prefixes_pattern&&(b.prefixes_pattern=e),null==b.prefixes&&(b.prefixes=e),b.prefixes_pattern=u(l=b.prefixes_pattern)?l:e,u(b.prefixes_pattern)?b.prefixes_pattern:(b.prefixes=u(l=b.prefixes)?l:[],b.prefixes.$freeze(),b.prefixes_pattern=(u(b.prefixes["$empty?"]())?/(?!)/:C(["^(S)?(",b.prefixes.$join("|"),")"],"i")).$freeze())},0),B(c,"$command_pattern",function(){var b=this,l=e,A=e;return null==b.command_pattern&&(b.command_pattern=e),null==b.prefixes&&(b.prefixes=e),b.command_pattern=u(l=b.command_pattern)?l:e,u(b.command_pattern)?b.command_pattern:(b.prefixes=u(l=b.prefixes)?l:[],b.prefixes.$freeze(),A=y(q(p(h("CommonCommand"),"COMMANDS"),"map",[],function(s){return null==s&&(s=e),p(s,"PREFIX_PATTERN").$source()},1),b.prefixes),b.command_pattern=C(["^S?(",A.$join("|"),")"],"i").$freeze())},0),B(c,"$eval",function(b){return this.$new(b).$eval()},1),_.$include(f("Translate")),_.$include(p(f("Deprecated"),"Checker")),B(_,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=p(f("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=p(f("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=p(f("BCDice"),"Randomizer").$new(),i.debug=!1},1),_.$attr_accessor("randomizer"),_.$attr_reader("d66_sort_type"),_.$attr_reader("round_type"),_.$attr_reader("sides_implicit_d"),_.$attr_reader("upper_dice_reroll_threshold"),_.$attr_reader("reroll_dice_reroll_threshold"),_.$attr_reader("default_cmp_op"),_.$attr_reader("default_target_number"),B(_,"$sort_add_dice?",function(){return this.sort_add_dice},0),B(_,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),B(_,"$enabled_d9?",function(){return this.enabled_d9},0),B(_,"$enable_debug",function(){return this.debug=!0},0),B(_,"$eval",function(){var i,h,x,n=this,b=e;return i=p(f("BCDice"),"Preprocessor").$process(n.raw_input,n),h=u(x=n.$dice_command(i))?x:n.$eval_common_command(n.raw_input),u(h)?(b=[n.randomizer.$rand_results()],q(h,"rands=",M(b)),Y(b.length,1),b=[n.randomizer.$detailed_rand_results()],q(h,"detailed_rands=",M(b)),Y(b.length,1),h):e},0),B(_,"$change_text",function(n){return n},1),B(_,"$check_result",function(n,i,h,x){var b=this,l=e,A=e,L=e,s=e,j=e;return l=b.$check_result_legacy(n,i,h,x),u(l)?l:(A=q(i,"map",[],"sides".$to_proc()),s=(L=q(i,"map",[],"value".$to_proc())).$sum(),l=F([100],j=A)?b.$result_1d100(n,s,h,x):F([20],j)?b.$result_1d20(n,s,h,x):F([6,6],j)?b.$result_2d6(n,s,L,h,x):e,K(l,f("Result").$nothing())?e:u(l)?l:(l=F([10],j=A.$uniq())?b.$result_nd10(n,s,L,h,x):F([6],j)?b.$result_nd6(n,s,L,h,x):e,K(l,f("Result").$nothing())?e:u(l)?l:b.$result_ndx(n,h,x)))},4),B(_,"$grich_text",function(n,i,h){return e},3),_.$private(),B(_,"$eval_common_command",function(n){try{return n=this.$change_text(n),q(p(f("CommonCommand"),"COMMANDS"),"each",[],function h(x){var l,b=null==h.$$s?this:h.$$s;if(null==b.randomizer&&(b.randomizer=e),null==x&&(x=e),l=x.$eval(n,b,b.randomizer),!u(l))return e;r.ret(l)},{$$arity:1,$$s:this}),e}catch(h){if(h===r.returner)return h.$v;throw h}},1),B(_,"$dice_command",function(n){var i=this,h=e,x=e,b=e,l=e,A=e;return u(i.enabled_upcase_input)&&(n=n.$upcase()),h=i.$class().$prefixes_pattern().$match(n),u(h)?(x=h["$[]"](1)["$nil?"]()["$!"](),u(x)&&(n=n["$[]"](J(1,-1,!1))),b=i.$eval_game_system_specific_command(n),u(b["$is_a?"](f("Result")))?(l=[u(A=b["$secret?"]())?A:x],q(b,"secret=",M(l)),Y(l.length,1),b):u(b["$nil?"]())||u(b["$empty?"]())||K(b,"1")?e:q(f("Result").$new(),"tap",[],function(s){return null==s&&(s=e),l=[b.$to_s()],q(s,"text=",M(l)),Y(l.length,1),q(s,"secret=",M(l=[x])),l[Y(l.length,1)]},1)):e},1),B(_,"$eval_game_system_specific_command",function(n){return e},1),B(_,"$result_ndx",function(n,i,h){return u(h["$is_a?"](f("String")))?e:u(n.$send(i,h))?f("Result").$success(this.$translate("success")):f("Result").$failure(this.$translate("failure"))},3),B(_,"$result_1d100",function(n,i,h,x){return e},4),B(_,"$result_1d20",function(n,i,h,x){return e},4),B(_,"$result_nd10",function(n,i,h,x,b){return e},5),B(_,"$result_2d6",function(n,i,h,x,b){return e},5),B(_,"$result_nd6",function(n,i,h,x,b){return e},5),B(_,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),B(_,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),B(_,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),B(_,"$get_table_by_nDx",function(n,i,h){var b,l=e;return b=this.randomizer.$roll_sum(i,h),l=this.$get_table_value(n["$[]"](Y(b,i))),u(l["$nil?"]())?["1",0]:[l,b]},3),B(_,"$get_table_by_1d3",function(n){var x,b,i=this,l=e;return i.$debug("get_table_by_1d3"),x=i.randomizer.$roll_sum(1,6),i.$debug("num",x),b=Z(Y(x,1),2).$to_i(),i.$debug("index",b),l=n["$[]"](b),u(l["$nil?"]())?["1",0]:[l,x]},1),B(_,"$get_table_by_d66_swap",function(n){var h;return h=this.randomizer.$roll_d66(p(f("D66SortType"),"ASC")),[this.$get_table_by_number(h,n),h]},1),B(_,"$get_table_by_d66",function(n){var h,x,b,A,l=e;return h=this.randomizer.$roll_once(6),x=this.randomizer.$roll_once(6),b=y(I(Y(h,1),6),Y(x,1)),l=n["$[]"](b),A=""+h+x,u(l["$nil?"]())?["1",A]:[l,A]},1),B(_,"$get_table_by_number",function(n,i,h){try{return null==h&&(h="1"),q(i,"each",[],function b(l){var L,A=null==b.$$s?this:b.$$s;if(null==l&&(l=e),L=l["$[]"](0),!u(m(L,n)))return e;r.ret(A.$get_table_value(l["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(h)}catch(b){if(b===r.returner)return b.$v;throw b}},-3),B(_,"$get_table_value",function(n){return u(n["$is_a?"](f("Proc")))?n.$call():n},1),B(_,"$roll_tables",function(n,i){var x=e;return x=i["$[]"](n),u(x)?x.$roll(this.randomizer).$to_s():e},2),B(_,"$debug",function(n,i){var x,b=this,l=e,A=e;return x=r.slice.call(arguments,1),u(b.debug)?(l=u(n["$is_a?"](f("String")))?n:n.$inspect(),u(x["$empty?"]())?b.$warn(l):(A=q(x,"map",[],function(s){return null==s&&(s=e),u(s["$is_a?"](f("String")))?'"'+s+'"':s.$inspect()},1),b.$warn(l+": "+A.$join(", ")))):e},-2),p(p(t("I18n"),"Backend"),"Simple").$include(p(p(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),o=["ja_jp"],q(t("I18n"),"default_locale=",M(o)),Y(o.length,1),o=[["ja_jp"]],q(t("I18n").$fallbacks(),"defaults=",M(o)),o[Y(o.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(r){var q,K,P,w,z,_,v,H,Z,I,Y,$=[],t=r.nil,e=r.module,p=r.klass,S=r.const_set,G=r.hash2,u=r.truthy,B=r.send,C=r.def;return r.top.$require("strscan"),q=$,K=Y=[e($[0],"BCDice")].concat(q),Z=[e(Y[0],"GameSystem")].concat(K),I=r.$r(Z),P=Z,w=H=[p(Z[0],I("Base"),"SwordWorld")].concat(P),_=[z=p(H[0],null,"RatingLexer")].concat(w),v=r.$r(_),z.$$prototype.scanner=t,S(_[0],"SYMBOLS",G(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),C(z,"$initialize",function(c){var n,i,x;return c=u(x=(i=(n=c)===t||null==n?t:B(n,"split",[" ",2]))===t||null==i?t:B(i,"first",[]))?x:"",this.scanner=v("StringScanner").$new(c)},1),C(z,"$next_token",function(){var c=this,n=t,i=t,x=t;return u(c.scanner["$eos?"]())?[!1,"$"]:u(n=c.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:(i=c.scanner.$getch().$upcase(),[u(x=v("SYMBOLS")["$[]"](i))?x:i.$to_sym(),i])},0),C(z,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(r){var M,J,V,z,_,v,f,a,k,I,m,F,W=[],$=r.nil,t=r.module,e=r.klass,p=r.def,S=r.truthy,G=r.rb_lt,u=r.rb_plus,B=r.eqeq,C=r.rb_gt,y=r.neqeq;return M=W,J=F=[t(W[0],"BCDice")].concat(M),I=[t(F[0],"GameSystem")].concat(J),m=r.$r(I),V=I,z=k=[e(I[0],m("Base"),"SwordWorld")].concat(V),v=[_=e(k[0],null,"RatingParsed")].concat(z),f=r.$r(v),(a=_.$$prototype).modifier_after_half=a.critical=a.semi_fixed_val=a.kept_modify=a.first_modify=a.first_to=a.rateup=a.tmp_fixed_val=a.rate=a.greatest_fortune=a.modifier=$,_.$attr_accessor("rate"),_.$attr_writer("critical"),_.$attr_writer("kept_modify"),_.$attr_writer("first_to"),_.$attr_writer("first_modify"),_.$attr_writer("rateup"),_.$attr_accessor("greatest_fortune"),_.$attr_writer("semi_fixed_val"),_.$attr_writer("tmp_fixed_val"),_.$attr_accessor("modifier"),_.$attr_writer("modifier_after_half"),p(_,"$initialize",function(){var n=this;return n.critical=$,n.min_critical=$,n.kept_modify=$,n.first_to=$,n.first_modify=$,n.greatest_fortune=!1,n.rateup=$,n.semi_fixed_val=$,n.tmp_fixed_val=$},0),p(_,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()},0),p(_,"$critical",function(){var i;return S(i=this.critical)?i:S(this.$half())?13:10},0),p(_,"$min_critical",function(){var n=this,i=$;return i=3,S(n.semi_fixed_val["$nil?"]())||(S(n.kept_modify["$nil?"]())?S(G(i,u(n.semi_fixed_val,2)))&&(i=u(n.semi_fixed_val,2)):S(G(i,u(u(n.semi_fixed_val,n.kept_modify),2)))&&(i=u(u(n.semi_fixed_val,n.kept_modify),2)),B(n.semi_fixed_val,1)&&(i=3)),S(C(i,13))&&(i=13),i},0),p(_,"$first_modify",function(){var i;return S(i=this.first_modify)?i:0},0),p(_,"$first_to",function(){var i;return S(i=this.first_to)?i:0},0),p(_,"$rateup",function(){var i;return S(i=this.rateup)?i:0},0),p(_,"$semi_fixed_val",function(){var h,i=$;return i=S(h=this.semi_fixed_val)?h:0,S(C(i,6))&&(i=6),i},0),p(_,"$tmp_fixed_val",function(){var h,i=$;return i=S(h=this.tmp_fixed_val)?h:0,S(C(i,6))&&(i=6),i},0),p(_,"$kept_modify",function(){var i;return S(i=this.kept_modify)?i:0},0),p(_,"$modifier_after_half",function(){var i;return S(i=this.modifier_after_half)?i:0},0),p(_,"$to_s",function(){var n=this,i=$;return i="KeyNo."+n.rate,S(G(n.$critical(),13))&&(i=u(i,"c["+n.$critical()+"]")),y(n.$first_modify(),0)&&(i=u(i,"m["+f("Format").$modifier(n.$first_modify())+"]")),y(n.$first_to(),0)&&(i=u(i,"m["+n.$first_to()+"]")),y(n.$rateup(),0)&&(i=u(i,"r["+n.$rateup()+"]")),S(n.greatest_fortune)&&(i=u(i,"gf")),y(n.$semi_fixed_val(),0)&&(i=u(i,"sf["+n.$semi_fixed_val()+"]")),y(n.$tmp_fixed_val(),0)&&(i=u(i,"tf["+n.$tmp_fixed_val()+"]")),y(n.$kept_modify(),0)&&(i=u(i,"a["+f("Format").$modifier(n.$kept_modify())+"]")),y(n.modifier,0)&&(i=u(i,f("Format").$modifier(n.modifier))),i},0),p(_,"$infinite_roll?",function(){return G(this.$critical(),this.$min_critical())},0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(r){var m,H,v,h,A,L,s,j,R,ie,le,_e,oe,E,x,b,l,N,a,c,g,w,P,W=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,S=r.klass,G=r.hash2,u=r.send2,B=r.find_super,C=r.def,y=r.send,q=r.to_a,M=r.rb_minus,Y=r.hash,F=r.const_set,K=r.to_ary,J=r.truthy,Z=r.eqeq;return W.$require("racc/parser.rb"),W.$require("bcdice/arithmetic/node"),W.$require("bcdice/enum"),W.$require("bcdice/game_system/sword_world/rating_lexer"),W.$require("bcdice/game_system/sword_world/rating_parsed"),m=$,H=P=[p($[0],"BCDice")].concat(m),g=[p(P[0],"GameSystem")].concat(H),w=r.$r(g),v=g,a=[S(g[0],w("Base"),"SwordWorld")].concat(v),c=r.$r(a),h=a,b=[x=S(a[0],e(c("Racc"),"Parser"),"RatingParser")].concat(h),l=r.$r(b),(N=x.$$prototype).lexer=N.version=t,C(x,"$initialize",function ne(U){var O,d;if(delete ne.$$p,null==U)U=G([],{});else if(!U.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(O=U.$$smap.version)&&(O="v1_0"),null==(d=U.$$smap.round_type)&&(d=e(l("RoundType"),"CEIL")),u(this,B(this,"initialize",ne,!1,!0),"initialize",[],null),this.version=O,this.round_type=d},-1),C(x,"$set_debug",function(){return this.yydebug=!0,this},0),C(x,"$parse",function(U){try{return this.lexer=l("RatingLexer").$new(U),this.$do_parse()}catch(d){if(!r.rescue(d,[l("ParseError"),l("ZeroDivisionError")]))throw d;try{return t}finally{r.pop_exception()}}},1),x.$private(),C(x,"$parsed",function(U,O,d){return y(l("RatingParsed").$new(),"tap",[],function ee(ae){var te,se,X,Q,fe=null==ee.$$s?this:ee.$$s,ce=t;return null==fe.round_type&&(fe.round_type=t),null==ae&&(ae=t),y(ae,"rate=",q(ce=[U])),M(ce.length,1),ce=[(te=d["$[]"]("critical"),te===t||null==te?t:y(te,"eval",[fe.round_type]))],y(ae,"critical=",q(ce)),M(ce.length,1),ce=[(se=d["$[]"]("kept_modify"),se===t||null==se?t:y(se,"eval",[fe.round_type]))],y(ae,"kept_modify=",q(ce)),M(ce.length,1),ce=[d["$[]"]("first_to")],y(ae,"first_to=",q(ce)),M(ce.length,1),ce=[d["$[]"]("first_modify")],y(ae,"first_modify=",q(ce)),M(ce.length,1),ce=[(X=d["$[]"]("rateup"),X===t||null==X?t:y(X,"eval",[fe.round_type]))],y(ae,"rateup=",q(ce)),M(ce.length,1),ce=[d.$fetch("greatest_fortune",!1)],y(ae,"greatest_fortune=",q(ce)),M(ce.length,1),ce=[d["$[]"]("semi_fixed_val")],y(ae,"semi_fixed_val=",q(ce)),M(ce.length,1),ce=[d["$[]"]("tmp_fixed_val")],y(ae,"tmp_fixed_val=",q(ce)),M(ce.length,1),ce=[O.$eval(fe.round_type)],y(ae,"modifier=",q(ce)),M(ce.length,1),ce=[(Q=d["$[]"]("modifier_after_half"),Q===t||null==Q?t:y(Q,"eval",[fe.round_type]))],y(ae,"modifier_after_half=",q(ce)),ce[M(ce.length,1)]},{$$arity:1,$$s:this})},3),C(x,"$next_token",function(){return this.lexer.$next_token()},0),A=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],L=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],s=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],j=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],R=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],ie=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],le=[t,5,11,0,t,-11,-11,-23,t],_e=[t,t,t,t,10,42,t,t,28],oe=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],E=Y(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),F(b[0],"Racc_arg",[A,L,j,s,R,ie,_e,le,21,oe,E,64,33,!0]),F(b[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),F(b[0],"Racc_debug_parser",!1),C(x,"$_reduce_1",function(U,O,d){var D,te,X,Q,se=t;return te=null==(D=K(U))[0]?t:D[0],X=J(Q=(se=null==D[1]?t:D[1])["$[]"]("modifier"))?Q:e(e(l("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(te,X,se)},3),C(x,"$_reduce_2",function(U,O,d){var D,se,Q,ce,X=t,fe=t;return se=null==(D=K(U))[1]?t:D[1],J((X=null==D[2]?t:D[2])["$[]"]("modifier_after_half"))||(fe=["modifier_after_half",e(e(l("Arithmetic"),"Node"),"Number").$new(0)],y(X,"[]=",q(fe)),M(fe.length,1)),ce=J(Q=X["$[]"]("modifier"))?Q:e(e(l("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(se,ce,X)},3),C(x,"$_reduce_3",function(U,O,d){return U["$[]"](1).$to_i()},3),C(x,"$_reduce_4",function(U,O,d){return G([],{})},3),C(x,"$_reduce_5",function(U,O,d){var D,se,X,te=t;return se=null==(D=K(U))[1]?t:D[1],J((te=null==D[0]?t:D[0])["$[]"]("modifier")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(X=["modifier",se])),M(X.length,1),te},3),C(x,"$_reduce_6",function(U,O,d){var D,X,Q,te=t;return X=null==(D=K(U))[2]?t:D[2],J((te=null==D[0]?t:D[0])["$[]"]("critical")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(Q=["critical",X])),M(Q.length,1),te},3),C(x,"$_reduce_7",function(U,O,d){var D,X,Q,te=t;return X=null==(D=K(U))[2]?t:D[2],J((te=null==D[0]?t:D[0])["$[]"]("critical")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(Q=["critical",X])),M(Q.length,1),te},3),C(x,"$_reduce_8",function(U,O,d){var D,Q,te=t,X=t;return X=null==(D=K(U))[2]?t:D[2],J((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&J(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_to",X.$to_i()],y(te,"[]=",q(Q)),M(Q.length,1),te},3),C(x,"$_reduce_9",function(U,O,d){var D,Q,te=t,X=t;return X=null==(D=K(U))[3]?t:D[3],J((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&J(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_modify",X.$to_i()],y(te,"[]=",q(Q)),M(Q.length,1),te},3),C(x,"$_reduce_10",function(U,O,d){var D,Q,te=t,X=t;return X=null==(D=K(U))[3]?t:D[3],J((te=null==D[0]?t:D[0])["$[]"]("first_to")["$nil?"]())&&J(te["$[]"]("first_modify")["$nil?"]())||this.$raise(l("ParseError")),Q=["first_modify",X.$to_i()["$-@"]()],y(te,"[]=",q(Q)),M(Q.length,1),te},3),C(x,"$_reduce_11",function(U,O,d){var D,X,te=t;return D=K(U),J((te=null==D[0]?t:D[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(l("ParseError")),X=["modifier_after_half",e(e(l("Arithmetic"),"Node"),"Number").$new(0)],y(te,"[]=",q(X)),M(X.length,1),te},3),C(x,"$_reduce_12",function(U,O,d){var D,X,Q,te=t;return X=null==(D=K(U))[2]?t:D[2],J((te=null==D[0]?t:D[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(Q=["modifier_after_half",X])),M(Q.length,1),te},3),C(x,"$_reduce_13",function(U,O,d){var D,X,Q,te=t;return te=null==(D=K(U))[0]?t:D[0],X=null==D[2]?t:D[2],J(["v2_5","v2_0"]["$include?"](this.version))&&J(te["$[]"]("rateup")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(Q=["rateup",X])),M(Q.length,1),te},3),C(x,"$_reduce_14",function(U,O,d){var D,X,ae=this,te=t;return te=null==(D=K(U))[0]?t:D[0],J(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),J(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),y(te,"[]=",q(X=["greatest_fortune",!0])),M(X.length,1),te},3),C(x,"$_reduce_15",function(U,O,d){var D,Q,ae=this,te=t,X=t;return te=null==(D=K(U))[0]?t:D[0],X=null==D[3]?t:D[3],J(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),J(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),Q=["semi_fixed_val",X.$to_i()],y(te,"[]=",q(Q)),M(Q.length,1),te},3),C(x,"$_reduce_16",function(U,O,d){var D,Q,ae=this,te=t,X=t;return te=null==(D=K(U))[0]?t:D[0],X=null==D[3]?t:D[3],J(["v2_5","v2_0"]["$include?"](ae.version))||ae.$raise(l("ParseError")),J(te["$[]"]("greatest_fortune")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("semi_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),J(te["$[]"]("tmp_fixed_val")["$nil?"]())||ae.$raise(l("ParseError")),Q=["tmp_fixed_val",X.$to_i()],y(te,"[]=",q(Q)),M(Q.length,1),te},3),C(x,"$_reduce_17",function(U,O,d){var D,X,Q,te=t;return te=null==(D=K(U))[0]?t:D[0],X=null==D[2]?t:D[2],Z(this.version,"v2_5")&&J(te["$[]"]("kept_modify")["$nil?"]())||this.$raise(l("ParseError")),y(te,"[]=",q(Q=["kept_modify",X])),M(Q.length,1),te},3),C(x,"$_reduce_18",function(U,O,d){return U["$[]"](1)},3),C(x,"$_reduce_19",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"Negative").$new(U["$[]"](1))},3),C(x,"$_reduce_20",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(U["$[]"](0),"+",U["$[]"](2))},3),C(x,"$_reduce_21",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(U["$[]"](0),"-",U["$[]"](2))},3),C(x,"$_reduce_22",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(U["$[]"](0),"+",U["$[]"](2))},3),C(x,"$_reduce_23",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(U["$[]"](0),"-",U["$[]"](2))},3),C(x,"$_reduce_25",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"BinaryOp").$new(U["$[]"](0),"*",U["$[]"](2))},3),C(x,"$_reduce_26",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(U["$[]"](0),U["$[]"](2))},3),C(x,"$_reduce_28",function(U,O,d){return U["$[]"](1)},3),C(x,"$_reduce_29",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"Negative").$new(U["$[]"](1))},3),C(x,"$_reduce_31",function(U,O,d){return U["$[]"](1)},3),C(x,"$_reduce_32",function(U,O,d){return e(e(l("Arithmetic"),"Node"),"Number").$new(U["$[]"](0))},3),C(x,"$_reduce_none",function(U,O,d){return U["$[]"](0)},3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(r){var k,_,i,h,x,b,l,f,a,w,W=r.top,$=[],t=r.nil,e=r.module,p=r.klass,S=r.const_set,G=r.send2,u=r.find_super,B=r.def,C=r.truthy,y=r.rb_ge,q=r.rb_le,M=r.eqeq,Y=r.neqeq,F=r.rb_minus,K=r.rb_gt,J=r.send,Z=r.to_ary,I=r.rb_plus,m=r.rb_lt,o=r.rb_times,P=r.to_a,V=r.rb_divide;return W.$require("bcdice/base"),W.$require("bcdice/game_system/sword_world/rating_parser"),k=$,_=w=[e($[0],"BCDice")].concat(k),f=[e(w[0],"GameSystem")].concat(_),a=r.$r(f),i=f,x=[h=p(f[0],a("Base"),"SwordWorld")].concat(i),b=r.$r(x),(l=h.$$prototype).rating_table=l.randomizer=t,S(x[0],"ID","SwordWorld"),S(x[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),S(x[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),S(x[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),h.$register_prefix("H?K"),B(h,"$initialize",function A(L){var j=this;return delete A.$$p,G(j,u(j,"initialize",A,!1,!0),"initialize",[L],null),j.rating_table=0},1),B(h,"$result_2d6",function(L,s,j,R,ie){return C(y(s,12))?b("Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):C(q(s,2))?b("Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):Y(R,">=")||M(ie,"?")?t:C(y(L,ie))?b("Result").$success("\u6210\u529f"):b("Result").$failure("\u5931\u6557")},5),B(h,"$eval_game_system_specific_command",function(L){return this.$rating(L)},1),h.$private(),B(h,"$rating_parser",function(){return b("RatingParser").$new()},0),B(h,"$rating",function(L){var s,j,R=this,ie=t,le=t,_e=t,oe=t,ue=t,$e=t,E=t,re=t,T=t,N=t,ne=t,U=t,O=t,d=t,ee=t,ae=t;return R.$debug("rating string",L),ie=R.$rating_parser().$parse(L),C(ie)?(le=R.$getSW2_0_RatingTable(),_e=F(le.$length(),1),R.$debug("keyMax",_e),C(K(ie.$rate(),_e))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+_e+"\u307e\u3067\u3067\u3059":C(ie["$infinite_roll?"]())?b("Result").$new("C\u5024\u3092"+ie.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(oe=R.$getNewRates(le),ue=ie+" \uff1e ",$e=[],E=[],re=[],T=0,N=0,ne=0,U=0,O=ie.$first_to(),d=ie.$first_modify(),function(){var te=r.new_brk();try{J(R,"loop",[],function se(){var X,Q,ve,de,fe=null==se.$$s?this:se.$$s,ce=t,me=t;if(Q=fe.$rollDice(ie,U),me=null==(X=Z(Q))[1]?t:X[1],T=ce=null==X[0]?t:X[0],Y(O,0)?(T=ce=O,O=0):Y(d,0)&&(T=I(T,d),d=0),C(q(ce,2))&&($e["$<<"](ce.$to_s()),E["$<<"](me.$to_s()),re["$<<"]("**"),U=I(U,1),r.brk(t,te)),Y(ie.$kept_modify(),0)&&Y(T,2)&&(T=I(T,ie.$kept_modify())),C(m(T,2))&&(T=2),C(K(T,12))&&(T=12),ve=[I(ie.$rate(),o(U,ie.$rateup())),_e].$min(),fe.$debug("currentKey",ve),de=oe["$[]"](T)["$[]"](ve),fe.$debug("rateValue",de),ne=I(ne,de),N=I(N,T),$e["$<<"](T.$to_s()),E["$<<"](me.$to_s()),re["$<<"](C(K(T,2))?de:"**"),U=I(U,1),C(y(T,ie.$critical())))return t;r.brk(t,te)},{$$arity:0,$$s:R,$$brk:te})}catch(se){if(se===te)return se.$v;throw se}}(),j=R.$getResultText(ne,ie,E,$e,re,N,U),s=Z(j),ee=null==s[1]?t:s[1],ae=null==s[2]?t:s[2],ue=I(ue,null==s[0]?t:s[0]),J(b("Result").$new(),"tap",[],function(se){var X=t;return null==se&&(se=t),J(se,"text=",P(X=[ue])),F(X.length,1),J(se,"critical=",P(X=[ee])),F(X.length,1),J(se,"fumble=",P(X=[ae])),X[F(X.length,1)]},1))):(R.$debug("not matched"),"1")},1),B(h,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},0),B(h,"$getNewRates",function(L){var j=t,R=t,ie=t,le=t,_e=t,oe=t,ue=t,$e=t,E=t,re=t,T=t,N=t;return j=[],R=[],ie=[],le=[],_e=[],oe=[],ue=[],$e=[],E=[],re=[],T=[],J(L,"each",[],function(O){var d=t;return null==O&&(O=t),d=O.$split(/,/),T.$push(0),j.$push(d["$[]"](1).$to_i()),R.$push(d["$[]"](2).$to_i()),ie.$push(d["$[]"](3).$to_i()),le.$push(d["$[]"](4).$to_i()),_e.$push(d["$[]"](5).$to_i()),oe.$push(d["$[]"](6).$to_i()),ue.$push(d["$[]"](7).$to_i()),$e.$push(d["$[]"](8).$to_i()),E.$push(d["$[]"](9).$to_i()),re.$push(d["$[]"](10).$to_i())},1),M(this.rating_table,1)&&(N=[31,(N=[32,(N=[33,10],J(re,"[]=",P(N)),N[F(N.length,1)])],J(re,"[]=",P(N)),N[F(N.length,1)])],J(re,"[]=",P(N)),F(N.length,1)),[T,T,T,j,R,ie,le,_e,oe,ue,$e,E,re]},1),B(h,"$rollDice",function(L,s){var R=t;return[(R=this.randomizer.$roll_barabara(2,6)).$sum(),R.$join(",")]},2),B(h,"$getResultText",function(L,s,j,R,ie,le,_e){var oe=t,ue=t,$e=t,E=t,re=t;return(oe=[]).$push("2D:["+j.$join(" ")+"]="+R.$join(",")),C(q(le,2))?(oe.$push(ie.$join(",")),oe.$push("\u81ea\u52d5\u7684\u5931\u6557"),[oe.$join(" \uff1e "),!1,!0]):(C(K(ie.$size(),1))||Y(s.$modifier(),0)?(ue=I(ie.$join(","),b("Format").$modifier(s.$modifier())),C(s.$half())&&(ue="("+ue+")/2",Y(s.$modifier_after_half(),0)&&(ue=I(ue,b("Format").$modifier(s.$modifier_after_half())))),oe.$push(ue)):C(s.$half())&&(ue=ie.$first()+"/2",Y(s.$modifier_after_half(),0)&&(ue=I(ue,b("Format").$modifier(s.$modifier_after_half()))),oe.$push(ue)),C(K(_e,1))&&($e=F(_e,1)+"\u56de\u8ee2",oe.$push($e)),E=I(L,s.$modifier()),C(s.$half())&&(E=V(E,2).$ceil(),Y(s.$modifier_after_half(),0)&&(E=I(E,s.$modifier_after_half()))),re=E.$to_s(),oe.$push(re),[oe.$join(" \uff1e "),K(_e,1),!1])},7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(r){var Z,P,z,c,n,i,h,x,v,H,k,m,$=[],t=r.nil,e=r.module,p=r.klass,S=r.const_set,G=r.hash2,u=r.def,B=r.truthy,C=r.rb_lt,y=r.not,q=r.rb_ge,M=r.rb_plus,Y=r.send,F=r.to_a,K=r.rb_minus;return r.top.$require("bcdice/result"),Z=$,P=m=[e($[0],"BCDice")].concat(Z),H=[e(m[0],"GameSystem")].concat(P),k=r.$r(H),z=H,c=v=[p(H[0],k("SwordWorld"),"SwordWorld2_0")].concat(z),i=[n=p(v[0],null,"TranscendentTest")].concat(c),h=r.$r(i),(x=n.$$prototype).modifier=x.critical_value=x.expression=x.modifier_str=x.target=x.cmp_op=t,S(i[0],"RESULT_STR",G(["success","failure","super_success","critical","fumble"],{success:"\u6210\u529f",failure:"\u5931\u6557",super_success:"\u8d85\u6210\u529f",critical:"\u81ea\u52d5\u7684\u6210\u529f",fumble:"\u81ea\u52d5\u7684\u5931\u6557"}).$freeze()),u(n,"$initialize",function(l,A,L,s){var j=this;return j.critical_value=l,j.modifier=A,j.cmp_op=L,j.target=s,j.modifier_str=h("Format").$modifier(j.modifier),j.expression=j.$node_expression()},4),u(n,"$execute",function(l){var R,ie,le,L=this,s=t,j=t,_e=t,oe=t,ue=t;if(B(C(L.critical_value,3)))return"("+L.expression+") \uff1e \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u30023\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002";if(j=[s=l.$roll_barabara(2,6)],R=s["$=="]([1,1]),ie=s["$=="]([6,6]),y(R)&&y(ie))for(;B(q(L.$sum_of_dice(j.$last()),L.critical_value));)j.$push(l.$roll_barabara(2,6));return le=L.$sum_of_dice(j),_e=M(le,L.modifier),oe=L.$result_status(_e,j.$length(),R,ie),ue=["("+L.expression+")",""+L.$dice_str(j,le)+L.modifier_str,_e,h("RESULT_STR")["$[]"](oe)].$compact(),Y(h("Result").$new(),"tap",[],function(E){var re=t;return null==E&&(E=t),re=[ue.$join(" \uff1e ")],Y(E,"text=",F(re)),K(re.length,1),re=[oe["$=="]("fumble")],Y(E,"fumble=",F(re)),K(re.length,1),re=[oe["$=="]("critical")],Y(E,"critical=",F(re)),K(re.length,1),re=[["success","super_success","critical"]["$include?"](oe)],Y(E,"success=",F(re)),K(re.length,1),re=[["failure","fumble"]["$include?"](oe)],Y(E,"failure=",F(re)),re[K(re.length,1)]},1)},1),n.$private(),u(n,"$node_expression",function(){var A,l=this;return A="2D6@"+l.critical_value+l.modifier_str,B(l.target)?""+A+l.cmp_op+l.target:A},0),u(n,"$sum_of_dice",function(l){return l.$flatten().$sum()},1),u(n,"$dice_str",function(l,A){return""+A+Y(l,"map",[],function(j){return null==j&&(j=t),"["+j.$join(",")+"]"},1).$join()},2),u(n,"$result_status",function(l,A,L,s){var j=this;return B(j.target)?B(L)?"fumble":B(s)?"critical":B(l.$send(j.cmp_op,j.target))?B(q(A,2))&&B(q(l,41))?"super_success":"success":"failure":"no_target"},4)},Opal.queue(function(r){var V,w,c,n,i,h,_,v,k,W=r.top,$=[],t=r.nil,e=r.$$$,p=r.module,S=r.klass,G=r.const_set,u=r.send2,B=r.find_super,C=r.def,y=r.eqeqeq,q=r.truthy,M=r.hash2,Y=r.rb_gt,F=r.rb_plus,K=r.eqeq,J=r.rb_times,Z=r.send,I=r.neqeq,m=r.rb_minus,o=r.to_ary;return W.$require("bcdice/arithmetic_evaluator"),W.$require("bcdice/game_system/SwordWorld"),W.$require("bcdice/game_system/sword_world/transcendent_test"),V=$,w=k=[p($[0],"BCDice")].concat(V),_=[p(k[0],"GameSystem")].concat(w),v=r.$r(_),c=_,i=[n=S(_[0],v("SwordWorld"),"SwordWorld2_0")].concat(c),h=r.$r(i),n.$$prototype.randomizer=t,G(i[0],"ID","SwordWorld2.0"),G(i[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),G(i[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),G(i[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),n.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),C(n,"$initialize",function b(l){var L=this;return delete b.$$p,u(L,B(L,"initialize",b,!1,!0),"initialize",[l],null),L.rating_table=2},1),C(n,"$eval_game_system_specific_command",function b(l){var s,L=this,R=t;return delete b.$$p,y(/^Gr(\d+)?/i,s=l)?q(l["$=~"](/^Gr(\d+)/i))?L.$growth(h("Regexp").$last_match(1).$to_i()):L.$growth():y(/^2D6?@\d+/i,s)?(R=e(h("Command"),"Parser").$new(/2D6?/i,M(["round_type"],{round_type:e(e(h("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(t,">=",">").$parse(l),q(R)?h("TranscendentTest").$new(R.$critical(),R.$modify_number(),R.$cmp_op(),R.$target_number()).$execute(L.randomizer):t):y("FT",s)?L.$get_fumble_table():y("TT",s)?L.$get_tangle_table():u(L,B(L,"eval_game_system_specific_command",b,!1,!0),"eval_game_system_specific_command",[l],null)},1),C(n,"$rating_parser",function(){return h("RatingParser").$new(M(["version"],{version:"v2_0"}))},0),C(n,"$rollDice",function b(l,A){var s=this,j=t;return delete b.$$p,q(Y(l.$semi_fixed_val(),0))?(j=s.randomizer.$roll_once(6),[F(j,l.$semi_fixed_val()),j+","+l.$semi_fixed_val()]):K(A,0)&&q(Y(l.$tmp_fixed_val(),0))?(j=s.randomizer.$roll_once(6),[F(j,l.$tmp_fixed_val()),j+","+l.$tmp_fixed_val()]):q(l.$greatest_fortune())?q(l.$greatest_fortune())?(j=s.randomizer.$roll_once(6),[J(j,2),j+","+j]):t:u(s,B(s,"rollDice",b,!1,!0),"rollDice",[l,A],null)},2),C(n,"$growth",function(l){return null==l&&(l=1),Z(r.Range.$new(1,l,!1),"map",[],function L(){return(null==L.$$s?this:L.$$s).$growth_step()},{$$arity:0,$$s:this}).$join(" | ")},-1),C(n,"$growth_step",function(){var A,L,s,j,l=this;return A=l.randomizer.$roll_once(6),L=l.randomizer.$roll_once(6),s=l.$get_ability_by_dice(A),j=l.$get_ability_by_dice(L),I(s,j)?"["+A+","+L+"]->("+s+" or "+j+")":"["+A+","+L+"]->("+s+")"},0),C(n,"$get_ability_by_dice",function(l){return["\u5668\u7528\u5ea6","\u654f\u6377\u5ea6","\u7b4b\u529b","\u751f\u547d\u529b","\u77e5\u529b","\u7cbe\u795e\u529b"]["$[]"](m(l,1))},1),C(n,"$get_fumble_table",function(){var l,A;return A=this.$get_table_by_1d6(["\u3053\u306e\u8868\u30922\u56de\u632f\u308a\u3001\u305d\u306e\u4e21\u65b9\u3092\u9069\u7528\u3059\u308b\u3002\uff08\u540c\u3058\u51fa\u76ee\u306b\u3088\u308b\u5f71\u97ff\u306f\u7d2f\u7a4d\u3057\u306a\u3044\uff09\u3002\u3053\u306e\u81ea\u52d5\u5931\u6557\u306b\u3088\u308a\u5f97\u3089\u308c\u308b\u7d4c\u9a13\u70b9\u306f\u3001+50\u70b9\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u3092\u5f37\u5316\u3057\u3066\u3044\u308b\u300c\u5263\u306e\u304b\u3051\u3089\u300d\u306e\u6570\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u306e\u300c\u30ec\u30d9\u30eb\u300d\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u6c7a\u5b9a\u30922\u56de\u884c\u3044\u3001\u3088\u308a\u9ad8\u3044\u65b9\u3092\u63a1\u7528\u3059\u308b","\u5408\u7b97\u30c0\u30e1\u30fc\u30b8\u30922\u500d\u3059\u308b","\u9632\u8b77\u70b9\u7121\u52b9"]),"\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868("+(null==(l=o(A))[1]?t:l[1])+") \u2192 "+(null==l[0]?t:l[0])},0),C(n,"$get_tangle_table",function(){var l,A;return A=this.$get_table_by_1d6(["\u982d\u3084\u9854\uff1a\u7259\u3084\u565b\u307f\u3064\u304d\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u53ca\u3073\u3001\u9b54\u6cd5\u306e\u884c\u4f7f\u3084\u30d6\u30ec\u30b9\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u6b66\u5668\u3084\u76fe\uff1a\u6b66\u5668\u306e\u4f7f\u7528\u4e0d\u53ef\u3001\u53c8\u306f\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u8155\u3084\u624b\uff1a\u6b66\u5668\u3084\u722a\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u76fe\u3092\u6301\u3064\u8155\u65b9\u306e\u8155\u306a\u3089\u305d\u306e\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u811a\u3084\u8db3\uff1a\u79fb\u52d5\u4e0d\u53ef\u3001\u66f4\u306b\u56de\u907f\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b \u203b\u4e21\u8db3\u306b\u7d61\u3093\u3067\u3082\u7d2f\u7a4d\u3057\u306a\u3044","\u80f4\u4f53\uff1a\u751f\u547d\u30fb\u7cbe\u795e\u62b5\u6297\u529b\u3092\u57fa\u6e96\u5024\u306b\u7528\u3044\u308b\u5224\u5b9a\u3092\u9664\u304d\u3001\u3042\u3089\u3086\u308b\u884c\u70ba\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u7279\u6b8a\uff1a\u5c3b\u5c3e\u3084\u7ffc\u306a\u3069\u306b\u547d\u4e2d\u3002\u7d61\u3081\u3089\u308c\u305f\u90e8\u4f4d\u3092\u4f7f\u7528\u3059\u308b\u5224\u5b9a\u306b\u304a\u3044\u3066-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u307e\u305f\u306f\u305d\u3053\u304c\u4f7f\u3048\u3066\u3044\u305f\u3053\u3068\u306b\u3088\u308b\u30dc\u30fc\u30ca\u30b9\u4fee\u6b63\u3092\u5931\u3046 \u203b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u6c7a\u3081\u76f4\u3057"]),"\u7d61\u307f\u52b9\u679c\u8868("+(null==(l=o(A))[1]?t:l[1])+") \u2192 "+(null==l[0]?t:l[0])},0)})}}]);