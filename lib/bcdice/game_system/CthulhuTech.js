(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2555],{9818:(ne,ie,V)=>{V(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(t){var z,_,P,F,j,D,I,b,q=[],k=t.nil,e=t.$$$,A=t.module,M=t.hash2,C=t.truthy,f=t.def;return z=q,_=b=[A(q[0],"BCDice")].concat(z),I=[D=A(b[0],"ArithmeticEvaluator")].concat(_),F=[P=t.get_singleton_class(D)].concat(I),j=t.$r(F),f(P,"$eval",function(G,T){var p,L=k;if(null==T)T=M([],{});else if(!T.$$is_hash)throw t.ArgumentError.$new("expected kwargs");return null==(p=T.$$smap.round_type)&&(p=e(j("RoundType"),"FLOOR")),C(G)&&C(L=j("Arithmetic").$eval(G,p))?L:0},-2)},Opal.queue(function(t){var G,W,O,ee,te,o,n,E,h,v,y,c,R,K,Z,p,k=[],e=t.nil,A=t.$$$,M=t.module,C=t.klass,f=t.const_set,a=t.def,z=t.rb_ge,S=t.rb_divide,b=t.rb_plus,w=t.rb_minus,_=t.truthy,D=t.send,I=t.rb_lt,P=t.rb_gt,B=t.send2,F=t.find_super,j=t.eqeq;return t.top.$require("bcdice/arithmetic_evaluator"),G=k,W=p=[M(k[0],"BCDice")].concat(G),K=[M(p[0],"GameSystem")].concat(W),Z=t.$r(K),O=K[0],ee=Z("Base"),te=K,c=[y=C(O,ee,"CthulhuTech")].concat(te),R=t.$r(c),y.$$prototype.randomizer=e,y.$register_prefix("\\d+D10"),f(c[0],"ID","CthulhuTech"),f(c[0],"NAME","\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af"),f(c[0],"SORT_KEY","\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f"),f(c[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\uff08test\uff09\uff1anD10+m>=d\n\u3000n\u500b\u306e\u30c0\u30a4\u30b9\u3092\u4f7f\u7528\u3057\u3066\u3001\u4fee\u6b63\u5024m\u3001\u96e3\u6613\u5ea6d\u3067\u884c\u70ba\u5224\u5b9a\uff08test\uff09\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u4fee\u6b63\u5024m\u306f\u7701\u7565\u53ef\u80fd\u3001\u8907\u6570\u6307\u5b9a\u53ef\u80fd\uff08\u4f8b\uff1a+2-4\uff09\u3067\u3059\u3002\n\u3000\u6210\u529f\u3001\u5931\u6557\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u3092\u81ea\u52d5\u5224\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u4f8b\uff092D10>=12\u30004D10+2>=28\u30005D10+2-4>=32\n\n\u30fb\u5bfe\u6297\u5224\u5b9a\uff08contest\uff09\uff1anD10+m>d\n\u3000\u884c\u70ba\u5224\u5b9a\u3068\u540c\u69d8\u3067\u3059\u304c\u3001\u9632\u5fa1\u5074\u6709\u5229\u306e\u305f\u3081\u300c>=\u300d\u3067\u306f\u306a\u304f\u300c>\u300d\u3092\u5165\u529b\u3057\u307e\u3059\u3002\n\u3000\u30c0\u30e1\u30fc\u30b8\u30c0\u30a4\u30b9\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n"),o=c,E=[n=C(c[0],null,"Test")].concat(o),h=t.$r(E),(v=n.$$prototype).num=v.modifier=v.difficulty=e,f(E[0],"COMPARE_OP",">="),a(n,"$initialize",function(s,r,$){var i=this;return i.num=s,i.modifier=r,i.difficulty=$},3),a(n,"$execute",function(s){var u,x,l,Y,J,Q,r=this,$=e,i=e,H=e;return $=s.$roll_barabara(r.num,10),i=z($.$count(1),S(b($.$length(),1),2).$to_i()),u=$.$sort(),x=r.$calculate_roll_result(u),l=b(x,r.modifier),H=w(l,r.difficulty),Y=_(J=i["$!"]())?H.$send(A(r.$class(),"COMPARE_OP"),0):J,Q=z(H,10),["("+r.$expression()+")",r.$test_value_expression(u,x),l,r.$result_str(Y,i,Q,H)].$join(" \uff1e ")},1),n.$private(),a(n,"$expression",function(){var r,s=this;return r=h("Format").$modifier(s.modifier),s.num+"D10"+r+A(s.$class(),"COMPARE_OP")+s.difficulty},0),a(n,"$test_value_expression",function(s,r){return r+"["+s.$join(",")+"]"+h("Format").$modifier(this.modifier)},2),a(n,"$result_str",function(s,r,$,i){return _(r)?"\u30d5\u30a1\u30f3\u30d6\u30eb":_($)?"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb":_(s)?"\u6210\u529f":"\u5931\u6557"},4),a(n,"$calculate_roll_result",function(s){return[s.$last(),D(D(s,"group_by",[],"itself".$to_proc()).$values(),"map",[],"sum".$to_proc()).$max(),this.$sum_of_largest_straight(s)].$max()},1),a(n,"$sum_of_largest_straight",function(s){var r=e,$=e,i=e,u=e;return _(I(s.$length(),3))?0:(r=0,$=0,i=0,u=-1,D(s.$uniq(),"each",[],function(l){return null==l&&(l=e),_(P(w(l,u),1))?($=1,i=l,u=l,e):($=b($,1),i=b(i,l),u=l,_(z($,3))&&_(P(i,r))?r=i:e)},1),r)},1),function(d,m,o){var n=C(d,m,"Contest"),E=[n].concat(o);f(E[0],"COMPARE_OP",">"),a(n,"$result_str",function h(v,g,s,r){var u,$=h.$$p||e;return delete h.$$p,u=B(this,F(this,"result_str",h,!1,!0),"result_str",[v,g,s,r],$),_(v)?u+"\uff08\u30c0\u30e1\u30fc\u30b8\uff1a"+S(r,5).$ceil()+"D10\uff09":u},4)}(c[0],R("Test"),c),a(y,"$initialize",function d(m){var n=this;return delete d.$$p,B(n,F(n,"initialize",d,!1,!0),"initialize",[m],null),n.sort_add_dice=!0},1),a(y,"$eval_game_system_specific_command",function(m){var n=e;return n=this.$parse(m),_(n)?n.$execute(this.randomizer):e},1),y.$private(),f(c[0],"TEST_RE",/^(\d+)D10((?:[-+]\d+)+)?(>=?)(\d+)$/.$freeze()),a(y,"$parse",function(m){var o=e,n=e,E=e,h=e,v=e;return o=R("TEST_RE").$match(m),_(o)?(n=o["$[]"](1).$to_i(),E=_(o["$[]"](2))?R("ArithmeticEvaluator").$eval(o["$[]"](2)):0,h=j(o["$[]"](3),">")?R("Contest"):R("Test"),v=o["$[]"](4).$to_i(),h.$new(n,E,v)):e},1)})}}]);