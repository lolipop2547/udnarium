(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[357],{5520:(J,Q,z)=>{z(9993),Opal.queue(function(t){var w,V,Y,_,m,d,U,B,E,K=[],e=t.nil,y=t.module,N=t.klass,D=t.const_set,f=t.def,S=t.hash,c=t.truthy,q=t.rb_lt,k=t.rb_gt,b=t.send,x=t.to_a,R=t.rb_minus,j=t.to_ary,A=t.eqeq,C=t.rb_ge,H=t.rb_le,I=t.rb_times;return w=K,V=E=[y(K[0],"BCDice")].concat(w),U=[y(E[0],"GameSystem")].concat(V),B=t.$r(U),Y=U,m=[_=N(U[0],B("Base"),"Utakaze")].concat(Y),d=t.$r(m),_.$$prototype.randomizer=e,D(m[0],"ID","Utakaze"),D(m[0],"NAME","\u30a6\u30bf\u30ab\u30bc"),D(m[0],"SORT_KEY","\u3046\u305f\u304b\u305b"),D(m[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK\uff09\n  n\u500b\u306e\u30b5\u30a4\u30b3\u30ed\u3067\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\u30be\u30ed\u76ee\u306e\u6700\u5927\u500b\u6570\u3092\u6210\u529f\u30ec\u30d9\u30eb\u3068\u3057\u3066\u8868\u793a\u3002n\u3092\u7701\u7565\u3059\u308b\u30682UK\u6271\u3044\u3002\n  \u4f8b\uff093UK \uff1a\u30b5\u30a4\u30b3\u30ed3\u500b\u3067\u884c\u70ba\u5224\u5b9a\n  \u4f8b\uff09UK  \uff1a\u30b5\u30a4\u30b3\u30ed2\u500b\u3067\u884c\u70ba\u5224\u5b9a\n\u30fb\u96e3\u6613\u5ea6\u4ed8\u304d\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK>=t\uff09\n  t\u306b\u96e3\u6613\u5ea6\u3092\u6307\u5b9a\u3057\u305f\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\n  \u6210\u529f\u30ec\u30d9\u30eb\u3068\u96e3\u6613\u5ea6t\u3092\u6bd4\u3079\u3066\u6210\u5426\u3092\u5224\u5b9a\u3057\u307e\u3059\u3002\n  \u4f8b\uff096UK>=3 \uff1a\u30b5\u30a4\u30b3\u30ed6\u500b\u3067\u884c\u70ba\u5224\u5b9a\u3057\u3066\u3001\u6210\u529f\u30ec\u30d9\u30eb3\u304c\u51fa\u308c\u3070\u6210\u529f\u3002\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u4ed8\u304d\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\uff08nUK@c or nUKc\uff09\n  c\u306b\u300c\u9f8d\u306e\u30c0\u30a4\u30b9\u76ee\u300d\u3092\u6307\u5b9a\u3057\u305f\u884c\u70ba\u5224\u5b9a\u30ed\u30fc\u30eb\u3002\n  \u30be\u30ed\u76ee\u3067\u306f\u306a\u304f\u3001c\u3068\u540c\u3058\u5024\u306e\u51fa\u76ee\u6570x2\u304c\u6210\u529f\u30ec\u30d9\u30eb\u3068\u306a\u308a\u307e\u3059\u3002\u96e3\u6613\u5ea6\u306e\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3002\n  \u4f8b\uff093UK@5 \uff1a\u9f8d\u306e\u30c0\u30a4\u30b9\u300c\u6708\u300d\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u5ba3\u8a00\u3057\u305f\u30b5\u30a4\u30b3\u30ed3\u500b\u306e\u884c\u70ba\u5224\u5b9a\n"),_.$register_prefix("\\d*UK"),f(_,"$eval_game_system_specific_command",function(r){return this.$debug("eval_game_system_specific_command command",r),this.$check_roll(r)},1),_.$private(),D(m[0],"DRAGON_DICE_NAME",S(1,"\u98a8",2,"\u96e8",3,"\u96f2",4,"\u5f71",5,"\u6708",6,"\u6b4c").$freeze()),f(_,"$check_roll",function(r){var s=this,u=e,n=e,i=e,o=e,l=e,g=e,a=e,v=e;return u=/^(\d+)?UK(@?(\d))?(>=(\d+))?$/i.$match(r),!c(u)||(n=(c(i=u["$[]"](1))?i:2).$to_i(),o=u["$[]"](3).$to_i(),l=u["$[]"](5).$to_i(),n=s.$getValue(n),o=s.$getValue(o),c(q(n,1)))?e:(c(k(o,6))&&(o=6),g=s.randomizer.$roll_barabara(n,6).$sort(),a=s.$get_roll_result(g,o,l),v=[[r,"("+n+"D6)","["+g.$join(",")+"]",a.$text()].$join(" \uff1e ")],b(a,"text=",x(v)),R(v.length,1),a)},1),f(_,"$get_roll_result",function(r,s,u){var n,i,l,g,a,$=e;return i=this.$getSuccessInfo(r,s),l=null==(n=j(i))[0]?e:n[0],g=null==n[1]?e:n[1],a=null==n[2]?e:n[2],$=[],c(this.$isDragonDice(s))&&$.$push("\u9f8d\u306e\u30c0\u30a4\u30b9\u300c"+d("DRAGON_DICE_NAME")["$[]"](s)+"\u300d("+s+")\u3092\u4f7f\u7528"),c(l)?($.$push("\u6210\u529f\u30ec\u30d9\u30eb:"+g+" ("+a+"\u30bb\u30c3\u30c8)"),A(u,0)?d("Result").$success($.$join(" \uff1e ")):c(C(g,u))?($.$push("\u6210\u529f"),d("Result").$success($.$join(" \uff1e "))):($.$push("\u5931\u6557"),d("Result").$failure($.$join(" \uff1e ")))):($.$push("\u5931\u6557"),d("Result").$failure($.$join(" \uff1e ")))},3),f(_,"$getSuccessInfo",function(r,s){var n,l,u=this,i=e,o=e;return u.$debug("checkSuccess diceList, crit",r,s),n=u.$getDiceCountHash(r,s),u.$debug("diceCountHash",n),i=0,o=[],l=c(u.$isDragonDice(s))?1:2,b(n,"each",[],function(a,$){return null==a&&(a=e),null==$&&($=e),c(k($,i))&&(i=$),c(C($,l))?o["$<<"](a):e},2),u.$debug("successDiceList",o),c(H(o.$size(),0))?[!1,0,0]:(c(u.$isDragonDice(s))&&(i=I(i,2)),[!0,i,o.$size()])},2),f(_,"$getDiceCountHash",function(r,s){return b(b(b(r,"select",[],function n(i){var l;return null==i&&(i=e),c(l=(null==n.$$s?this:n.$$s).$isNomalDice(s))?l:i["$=="](s)},{$$arity:1,$$s:this}),"group_by",[],"itself".$to_proc()),"transform_values",[],"size".$to_proc())},2),f(_,"$isNomalDice",function(r){return this.$isDragonDice(r)["$!"]()},1),f(_,"$isDragonDice",function(r){return r["$!="](0)},1),f(_,"$getValue",function(r){return c(k(r,100))?0:r},1)})}}]);