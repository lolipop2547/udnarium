(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3210],{8250:(be,ge,he)=>{he(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var V,l,W,H,N,d,K=[],i=r.nil,t=r.$$$,e=r.module,g=r.class_variable_set,E=r.truthy,G=r.class_variable_get,u=r.def,B=r.send,I=r.to_a,x=r.rb_minus,A=r.send2,L=r.find_super,Q=r.hash2,F=r.find_block_super,j=r.neqeq;return V=K,d=[N=e(K[0],"I18n")].concat(V),g(d[0],"@@fallbacks",i),l=r.get_singleton_class(N),W=[l].concat(d),H=r.$r(W),u(l,"$fallbacks",function(){var y=i;return g(W[1],"@@fallbacks",E(null!=W[1].$$cvars["@@fallbacks"]?"class variable":i)&&E(y=G(W[1],"@@fallbacks",!1))?y:t(t(H("I18n"),"Locale"),"Fallbacks").$new()),E(y=H("Thread").$current()["$[]"]("i18n_fallbacks"))?y:G(W[1],"@@fallbacks",!1)},0),u(l,"$fallbacks=",function(h){var y;return g(W[1],"@@fallbacks",E(h["$is_a?"](H("Array")))?t(t(H("I18n"),"Locale"),"Fallbacks").$new(h):h),y=["i18n_fallbacks",G(W[1],"@@fallbacks",!1)],B(H("Thread").$current(),"[]=",I(y)),y[x(y.length,1)]},1),function(l,z){var h,y,T,s,H=[e(l,"Backend")].concat(z);return h=H,T=[y=e(H[0],"Fallbacks")].concat(h),s=r.$r(T),u(y,"$translate",function m(f,a,_){try{var n=m.$$p||i,$=this,v=i,p=i;return delete m.$$p,null==_&&(_=s("EMPTY_HASH")),E(_.$fetch("fallback",!0))?E(_["$[]"]("fallback_in_progress"))?A($,L($,"translate",m,!1,!0),"translate",[f,a,_],n):(E(_["$[]"]("default"))&&(v=$["$extract_non_symbol_default!"](_)),p=_.$merge(Q(["fallback_in_progress"],{fallback_in_progress:!0})),B(s("I18n").$fallbacks()["$[]"](f),"each",[],function w(q){var M=null==w.$$s?this:w.$$s;null==q&&(q=i);try{return B(M,"catch",["exception"],function re(){var c=null==re.$$s?this:re.$$s,ne=i;if(ne=A(c,F(c,"translate",re.$$def||w.$$def||m,!1,!1),"translate",[q,a,p],null),E(ne["$nil?"]()))return i;j(f.$to_s(),q.$to_s())&&c.$on_fallback(f,q,a,_),r.ret(ne)},{$$arity:0,$$s:M})}catch(re){if(!r.rescue(re,[t(s("I18n"),"InvalidLocale")]))throw re;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),E(_["$key?"]("default"))&&E(_["$[]"]("default")["$nil?"]())?i:E(v)?A($,L($,"translate",m,!1,!0),"translate",[f,i,_.$merge(Q(["default"],{default:v}))],null):$.$throw("exception",t(s("I18n"),"MissingTranslation").$new(f,a,_))):A($,L($,"translate",m,!1,!0),"translate",[f,a,_],n)}catch(w){if(w===r.returner)return w.$v;throw w}},-3),u(y,"$extract_non_symbol_default!",function(f){var _,a=i,n=i;return a=[f["$[]"]("default")].$flatten(),_=B(a,"detect",[],function(v){return null==v&&(v=i),v["$is_a?"](s("Symbol"))["$!"]()},1),E(_)&&(n=["default",a["$[]"](0,a.$index(_))],B(f,"[]=",I(n)),x(n.length,1)),_},1),u(y,"$exists?",function m(f,a,_){try{var n=m.$$p||i,$=this;return delete m.$$p,null==_&&(_=s("EMPTY_HASH")),E(_.$fetch("fallback",!0))?(B(s("I18n").$fallbacks()["$[]"](f),"each",[],function v(p){var w=null==v.$$s?this:v.$$s;null==p&&(p=i);try{if(!E(A(w,F(w,"exists?",v.$$def||m,!1,!1),"exists?",[p,a],null)))return i;r.ret(!0)}catch(q){if(!r.rescue(q,[t(s("I18n"),"InvalidLocale")]))throw q;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),!1):A($,L($,"exists?",m,!1,!0),"exists?",[f,a,_],n)}catch(v){if(v===r.returner)return v.$v;throw v}},-3),y.$private(),u(y,"$on_fallback",function(f,a,_,n){return i},4)}(d[0],d)},Opal.modules["bcdice/randomizer"]=function(r){var N,b,h,y,T,s,l,z,K=[],i=r.nil,t=r.$$$,g=r.klass,E=r.const_set,G=r.def,u=r.truthy,B=r.rb_gt,I=r.rb_plus,x=r.rb_le,A=r.send,L=r.rb_minus,Q=r.eqeq,F=r.rb_times,j=r.eqeqeq,X=r.rb_ge;return N=K,l=[(0,r.module)(K[0],"BCDice")].concat(N),z=r.$r(l),b=l,y=[h=g(l[0],null,"Randomizer")].concat(b),T=r.$r(y),(s=h.$$prototype).rand_results=s.detailed_rand_results=i,E(y[0],"UPPER_LIMIT_DICE_TIMES",200),E(y[0],"UPPER_LIMIT_DICE_SIDES",1e3),E(y[0],"UPPER_LIMIT_RANDS",1e4),G(h,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),h.$attr_reader("rand_results"),h.$attr_reader("detailed_rand_results"),E(y[0],"DetailedRandResult",T("Struct").$new("kind","sides","value")),G(h,"$roll_barabara",function(f,a){var _=this;return u(B(I(_.rand_results.$size(),f),T("UPPER_LIMIT_RANDS")))&&_.$raise(T("TooManyRandsError")),u(x(f,0))||u(B(f,T("UPPER_LIMIT_DICE_TIMES")))?[]:A(T("Array"),"new",[f],function n(){return(null==n.$$s?this:n.$$s).$roll_once(a)},{$$arity:0,$$s:_})},2),G(h,"$roll_sum",function(f,a){return this.$roll_barabara(f,a).$sum()},2),G(h,"$roll_once",function(f){var _=i;return u(x(f,0))||u(B(f,T("UPPER_LIMIT_DICE_SIDES")))?0:(_=this.$rand_inner(f),this.$push_to_detail("normal",f,_),_)},1),G(h,"$roll_index",function(f){return L(this.$roll_once(f),1)},1),G(h,"$roll_tens_d10",function(){var _,a=i;return a=this.$rand_inner(10),Q(a,10)&&(a=0),_=F(a,10),this.$push_to_detail("tens_d10",10,_),_},0),G(h,"$roll_d9",function(){var a;return a=L(this.$rand_inner(10),1),this.$push_to_detail("d9",10,a),a},0),G(h,"$roll_d66",function(f){var n,_=i;return _=A(T("Array"),"new",[2],function $(){return(null==$.$$s?this:$.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(t(T("D66SortType"),"ASC"),n=f)?_["$sort!"]():j(t(T("D66SortType"),"DESC"),n)&&_["$sort!"]()["$reverse!"](),I(F(_["$[]"](0),10),_["$[]"](1))},1),h.$private(),G(h,"$rand_inner",function(f){var _,a=this;return u(X(a.rand_results.$size(),T("UPPER_LIMIT_RANDS")))&&a.$raise(T("TooManyRandsError")),_=a.$random(f),a.rand_results["$<<"]([_,f]),_},1),G(h,"$random",function(f){return I(T("Kernel").$rand(f),1)},1),G(h,"$push_to_detail",function(f,a,_){var $;return $=T("DetailedRandResult").$new(f,a,_),this.detailed_rand_results.$push($)},3),g(l[0],z("StandardError"),"TooManyRandsError"),i},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var u,A,X,V,N,d,l,Q,I,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.truthy;return u=K,A=I=[t(K[0],"BCDice")].concat(u),X=Q=[t(I[0],"DiceTable")].concat(A),N=[V=e(Q[0],null,"RollResult")].concat(X),d=r.$r(N),(l=V.$$prototype).table_name=l.value=l.body=i,g(V,"$initialize",function(W,H,b){var h=this;return h.table_name=W,h.value=H,h.body=b},3),V.$attr_reader("table_name"),V.$attr_reader("value"),V.$attr_reader("body"),g(V,"$to_s",function(){var W=this;return W.table_name+"("+W.value+") \uff1e "+W.body},0),g(V,"$last_body",function(){var W=this;return E(W.body["$is_a?"](d("RollResult")))?W.body.$last_body():W.body},0),g(V,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var B,L,V,N,d,l,z,F,x,K=[],i=r.nil,t=r.module,e=r.klass,g=r.truthy,E=r.def,G=r.rb_minus;return B=K,L=x=[t(K[0],"BCDice")].concat(B),V=F=[t(x[0],"DiceTable")].concat(L),d=[N=e(F[0],null,"ChainTable")].concat(V),l=r.$r(d),(z=N.$$prototype).times=z.sides=z.items=z.name=i,E(N,"$initialize",function(H,b,h){var y=this,T=i;return y.name=H,y.items=h.$freeze(),T=/(\d+)D(\d+)/i.$match(b),g(T)||y.$raise(l("ArgumentError"),"Unexpected table type: "+b),y.times=T["$[]"](1).$to_i(),y.sides=T["$[]"](2).$to_i()},3),E(N,"$roll",function(H){var h,y,b=this,T=i;return h=H.$roll_sum(b.times,b.sides),y=G(h,b.times),T=b.items["$[]"](y),g(T["$respond_to?"]("roll"))&&(T=T.$roll(H)),l("RollResult").$new(b.name,h,T)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var A,j,l,z,W,H,b,V,Q,K=[],i=r.nil,t=r.module,e=r.klass,g=r.hash2,E=r.defs,G=r.def,u=r.rb_plus,B=r.rb_times,I=r.rb_minus;return A=K,j=Q=[t(K[0],"BCDice")].concat(A),l=V=[t(Q[0],"DiceTable")].concat(j),W=[z=e(V[0],null,"D66GridTable")].concat(l),H=r.$r(W),(b=z.$$prototype).name=b.items=i,E(z,"$from_i18n",function(y,T){var m=i;return m=H("I18n").$t(y,g(["locale","raise"],{locale:T,raise:!0})),this.$new(m["$[]"]("name"),m["$[]"]("items"))},2),G(z,"$initialize",function(y,T){return this.name=y,this.items=T.$freeze()},2),G(z,"$roll",function(y){var s,m,f,a,_;return s=y.$roll_once(6),m=y.$roll_once(6),f=u(B(s,10),m),a=I(s,1),_=I(m,1),H("RollResult").$new(this.name,f,this.items["$[]"](a)["$[]"](_))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var I,Q,d,l,z,W,j,X,A,i=[],t=r.nil,e=r.module,g=r.klass,E=r.hash2,G=r.defs,u=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),I=i,Q=A=[e(i[0],"BCDice")].concat(I),j=[e(A[0],"DiceTable")].concat(Q),X=r.$r(j),d=j,z=[l=g(j[0],X("D66GridTable"),"D66HalfGridTable")].concat(d),W=r.$r(z),G(l,"$from_i18n",function(b,h){var T=t;return T=W("I18n").$t(b,E(["locale","raise"],{locale:h,raise:!0})),this.$new(T["$[]"]("name"),T["$[]"]("items_1_2_3"),T["$[]"]("items_4_5_6"))},2),u(l,"$initialize",function(b,h,y){return this.name=b,this.items=[h,h,h,y,y,y].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var I,Q,d,l,z,W,j,X,A,i=[],t=r.nil,e=r.module,g=r.klass,E=r.hash2,G=r.defs,u=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),I=i,Q=A=[e(i[0],"BCDice")].concat(I),j=[e(A[0],"DiceTable")].concat(Q),X=r.$r(j),d=j,z=[l=g(j[0],X("D66GridTable"),"D66OneThirdTable")].concat(d),W=r.$r(z),G(l,"$from_i18n",function(b,h){var T=t;return T=W("I18n").$t(b,E(["locale","raise"],{locale:h,raise:!0})),this.$new(T["$[]"]("name"),T["$[]"]("items_1_2"),T["$[]"]("items_3_4"),T["$[]"]("items_5_6"))},2),u(l,"$initialize",function(b,h,y,T){return this.name=b,this.items=[h,h,y,y,T,T].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var Q,V,W,H,b,h,y,d,j,K=[],i=r.nil,t=r.$$$,e=r.module,g=r.klass,E=r.hash2,G=r.defs,u=r.def,B=r.eqeqeq,I=r.rb_plus,x=r.rb_times,A=r.truthy;return Q=K,V=j=[e(K[0],"BCDice")].concat(Q),W=d=[e(j[0],"DiceTable")].concat(V),b=[H=g(d[0],null,"D66Table")].concat(W),h=r.$r(b),(y=H.$$prototype).sort_type=y.items=y.name=i,G(H,"$from_i18n",function(s,m){var _,a=i;return a=h("I18n").$t(s,E(["locale"],{locale:m})),_=h("D66SortType").$const_get(a["$[]"]("d66_sort_type")),this.$new(a["$[]"]("name"),_,a["$[]"]("items"))},2),u(H,"$initialize",function(s,m,f){var a=this;return a.name=s,a.sort_type=m,a.items=f.$freeze()},3),u(H,"$roll",function(s){var m=this,f=i,a=i,_=i,n=i;return f=s.$roll_barabara(2,6),B(t(h("D66SortType"),"ASC"),a=m.sort_type)?f["$sort!"]():B(t(h("D66SortType"),"DESC"),a)&&f["$sort!"]()["$reverse!"](),_=I(x(f["$[]"](0),10),f["$[]"](1)),n=A(a=m.items["$[]"](_))?a:m.items["$[]"](_.$to_s()),A(n["$respond_to?"]("roll"))&&(n=n.$roll(s)),h("RollResult").$new(m.name,_,n)},1),u(H,"$choice",function(s){return h("RollResult").$new(this.name,s,this.items["$[]"](s))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var X,l,W,H,N,i=[],t=r.nil,e=r.module,g=r.klass,E=r.hash2,G=r.send,u=r.to_ary,B=r.rb_plus,I=r.rb_times,x=r.to_a,A=r.rb_minus,L=r.send2,Q=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),X=i,l=N=[e(i[0],"BCDice")].concat(X),W=[e(N[0],"DiceTable")].concat(l),H=r.$r(W),F(g(W[0],H("D66Table"),"D66LeftRangeTable"),"$initialize",function T(s,m,f){var n;return delete T.$$p,n=E([],{}),G(f,"each",[],function(v){var p,M;return null==v&&(v=t),p=u(v),M=null==p[1]?t:p[1],G(null==p[0]?t:p[0],"each",[],function(c){return null==c&&(c=t),G(M,"each_with_index",[],function(D,te){var le,_e;return null==D&&(D=t),null==te&&(te=t),le=B(I(c,10),B(te,1)),G(n,"[]=",x(_e=[le,D])),_e[A(_e.length,1)]},2)},1)},1),L(this,Q(this,"initialize",T,!1,!0),"initialize",[s,m,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var x,F,d,l,z,W,H,X,L,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.truthy,G=r.rb_minus,u=r.rb_plus,B=r.rb_times;return x=K,F=L=[t(K[0],"BCDice")].concat(x),d=X=[t(L[0],"DiceTable")].concat(F),z=[l=e(X[0],null,"D66ParityTable")].concat(d),W=r.$r(z),(H=l.$$prototype).odd=H.even=H.name=i,g(l,"$initialize",function(h,y,T){var s=this;return s.name=h,s.odd=y.$freeze(),s.even=T.$freeze()},3),g(l,"$roll",function(h){var s,f,a,y=this,T=i;return T=h.$roll_once(6),s=h.$roll_once(6),f=(E(T["$odd?"]())?y.odd:y.even)["$[]"](G(s,1)),a=u(B(T,10),s),W("RollResult").$new(y.name,a,f)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var I,Q,N,d,l,z,W,j,A,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.rb_plus,G=r.rb_times,u=r.send;return I=K,Q=A=[t(K[0],"BCDice")].concat(I),N=j=[t(A[0],"DiceTable")].concat(Q),l=[d=e(j[0],null,"D66RangeTable")].concat(N),z=r.$r(l),(W=d.$$prototype).items=W.name=i,g(d,"$initialize",function(b,h){return this.name=b,this.items=h.$freeze()},2),g(d,"$roll",function(b){var y,T,s,m=i;return y=b.$roll_once(6),T=b.$roll_once(6),s=E(G(y,10),T),m=u(this.items,"find",[],function(a){return null==a&&(a=i),a["$[]"](0)["$include?"](s)},1),z("RollResult").$new(this.name,s,m["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,N,H,b,h,y,T,l,X,K=[],i=r.nil,t=r.module,e=r.klass,g=r.const_set,E=r.send,G=r.truthy,u=r.def,B=r.to_a,I=r.rb_minus,x=r.eqeqeq,A=r.rb_times,L=r.rb_plus;return F=K,N=X=[t(K[0],"BCDice")].concat(F),H=l=[t(X[0],"DiceTable")].concat(N),h=[b=e(l[0],null,"RangeTable")].concat(H),y=r.$r(h),(T=b.$$prototype).name=T.items=T.num_of_dice=T.num_of_sides=T.formatter=i,g(h[0],"RollResult",E(y("Struct"),"new",["sum","values","content","formatted"],function s(){return(null==s.$$s?this:s.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:b})),g(h[0],"Item",y("Struct").$new("range","content")),g(h[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),g(h[0],"DEFAULT_FORMATTER",E(b,"lambda",[],function(m,f){return null==m&&(m=i),null==f&&(f=i),m.$name()+"("+f.$sum()+") \uff1e "+f.$content()},2)),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),u(b,"$initialize",function s(m,f,a){var $,_=s.$$p||i,n=this,v=i;return delete s.$$p,n.name=m.$freeze(),n.formatter=G($=_)?$:y("DEFAULT_FORMATTER"),v=y("DICE_ROLL_METHOD_RE").$match(f),G(v)||n.$raise(y("ArgumentError"),n.name+": invalid dice roll method: "+f),n.num_of_dice=v["$[]"](1).$to_i(),n.num_of_sides=v["$[]"](2).$to_i(),n.$store(a)},3),u(b,"$fetch",function(m){var a,f=this;return a=E(f.items,"find",[],function(n){return null==n&&(n=i),n.$range()["$include?"](m)},1),G(a)||f.$raise(y("RangeError"),f.name+": value is out of range: "+m),a},1),u(b,"$roll",function(m){var _,n,$,f=this,a=i;return _=(a=m.$roll_barabara(f.num_of_dice,f.num_of_sides)).$sum(),n=y("RollResult").$new(_,a,f.$fetch(_).$content()),$=[f.formatter["$[]"](f,n)],E(n,"formatted=",B($)),I($.length,1),n},1),b.$private(),u(b,"$store",function(m){var a,_,f=this;return a=E(m,"map",[],function n($,v){return null==$&&($=i),null==v&&(v=i),[(null==n.$$s?this:n.$$s).$coerce_to_int_range($),v]},{$$arity:2,$$s:f}),_=E(a,"sort_by",[],function($,v){return null==$&&($=i),null==v&&(v=i),$.$min()},2),f.$assert_min_sum_is_covered(_),f.$assert_max_sum_is_covered(_),f.$assert_no_gap_or_overlap_in_ranges(_),f.items=E(_,"map",[],function($,v){return null==$&&($=i),null==v&&(v=i),y("Item").$new($,v.$freeze()).$freeze()},2).$freeze(),f},1),u(b,"$coerce_to_int_range",function(m){var a;return x(y("Integer"),a=m)?y("Range").$new(m,m):x(y("Range"),a)&&G(m.$begin()["$is_a?"](y("Integer")))&&G(m.$end()["$is_a?"](y("Integer")))?m:this.$raise(y("TypeError"),this.name+": "+m+" ("+m.$class()+") must be an Integer or a Range with Integers ")},1),u(b,"$assert_min_sum_is_covered",function(m){var a,f=this,_=i;return a=f.num_of_dice,_=m.$first()["$[]"](0),G(_["$include?"](a))||f.$raise(y("RangeError"),f.name+": min value ("+a+") is not covered: "+_),f},1),u(b,"$assert_max_sum_is_covered",function(m){var a,f=this,_=i;return a=A(f.num_of_dice,f.num_of_sides),_=m.$last()["$[]"](0),G(_["$include?"](a))||f.$raise(y("RangeError"),f.name+": max value ("+a+") is not covered: "+_),f},1),u(b,"$assert_no_gap_or_overlap_in_ranges",function(m){return E(m,"each_cons",[2],function a(_,n){var w,q,$=null==a.$$s?this:a.$$s,v=i,p=i;return null==$.name&&($.name=i),null==_&&(_=i),null==n&&(n=i),v=_["$[]"](0),p=n["$[]"](0),w=v.$max(),q=L(w,1),G(p["$include?"](w))&&$.$raise(y("RangeError"),$.name+": Range overlap: "+v+" and "+p),G(p["$include?"](q))?i:$.$raise(y("RangeError"),$.name+": Range gap: "+v+" and "+p)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var I,Q,N,H,b,h,y,l,j,A,K=[],i=r.nil,t=r.$$$,e=r.module,g=r.klass,E=r.send,G=r.def,u=r.rb_minus;return I=K,Q=A=[e(K[0],"BCDice")].concat(I),N=j=[e(A[0],"DiceTable")].concat(Q),H=l=[g(j[0],null,"SaiFicSkillTable")].concat(N),h=[b=g(l[0],null,"Category")].concat(H),y=r.$r(h),b.$$prototype.name=i,G(b,"$initialize",function(m,f,a,_){var n=this;return n.name=m,n.skills=E(f.$map(),"with_index",[2],function(v,p){return null==v&&(v=i),null==p&&(p=i),t(y("SaiFicSkillTable"),"Skill").$new(m,v,a,p,_)},2),n.dice=a},4),G(b,"$roll",function(m){return this.$skills()["$[]"](u(m.$roll_sum(2,6),2))},1),G(b,"$to_s",function(){return this.name},0),b.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var u,A,X,z,W,N,Q,I,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.hash2;return u=K,A=I=[t(K[0],"BCDice")].concat(u),X=Q=[t(I[0],"DiceTable")].concat(A),N=[e(Q[0],null,"SaiFicSkillTable")].concat(X),(W=(z=e(N[0],null,"Skill")).$$prototype).s_format=W.category_dice=W.row_dice=W.category_name=W.name=i,g(z,"$initialize",function(b,h,y,T,s){var m=this;return m.category_name=b,m.name=h,m.category_dice=y,m.row_dice=T,m.s_format=s},5),g(z,"$to_s",function(){var b=this;return b.$format(b.s_format,E(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},0),z.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var V,z,y,T,s,m,f,H,d,K=r.top,i=[],t=r.nil,e=r.$$$,g=r.module,E=r.klass,G=r.hash2,u=r.send,I=r.defs,x=r.const_set,A=r.to_ary,L=r.def,Q=r.truthy,F=r.rb_minus,j=r.rb_plus;return K.$require("bcdice/dice_table/sai_fic_skill_table/category"),K.$require("bcdice/dice_table/sai_fic_skill_table/skill"),V=i,z=d=[g(i[0],"BCDice")].concat(V),y=H=[g(d[0],"DiceTable")].concat(z),s=[T=E(H[0],null,"SaiFicSkillTable")].concat(y),m=r.$r(s),(f=T.$$prototype).rtt=f.rtt_format=f.rct=f.rct_format=f.rttn=f.rttn_format=f.categories=t,I(T,"$from_i18n",function(_,n,$){var v,p,w,c,re=t;if(null==$)$=G([],{});else if(!$.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(v=$.$$smap.rtt)&&(v=t),null==(p=$.$$smap.rct)&&(p=t),null==(w=$.$$smap.rttn)&&(w=t),c=(re=m("I18n").$t("RTT",G(["locale","raise","default"],{locale:n,raise:!1,default:G([],{})})).$merge(m("I18n").$t(_,G(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),re=u(re,"select",[],function(D,te){return null==D&&(D=t),null==te&&(te=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](D)},2),this.$new(c,r.to_hash(re).$merge(G(["rtt","rct","rttn"],{rtt:v,rct:p,rttn:w})))},-3),x(s[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),x(s[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),x(s[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),x(s[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),L(T,"$initialize",function(_,n){var $,v,p,w,q,M,re,c=this;if(null==n)n=G([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==($=n.$$smap.rtt)&&($=t),null==(v=n.$$smap.rct)&&(v=t),null==(p=n.$$smap.rttn)&&(p=t),null==(w=n.$$smap.rtt_format)&&(w=m("DEFAULT_RTT")),null==(q=n.$$smap.rct_format)&&(q=m("DEFAULT_RCT")),null==(M=n.$$smap.rttn_format)&&(M=m("DEFAULT_RTTN")),null==(re=n.$$smap.s_format)&&(re=m("DEFAULT_S")),c.categories=u(_.$map(),"with_index",[1],function(D,te){var le,oe,ue;return null==D&&(D=t),null==te&&(te=t),oe=null==(le=A(D))[0]?t:le[0],ue=null==le[1]?t:le[1],e(m("SaiFicSkillTable"),"Category").$new(oe,ue,te,re)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),c.rtt=$,c.rct=v,c.rttn=p.$to_a(),c.rtt_format=w,c.rct_format=q,c.rttn_format=M},-2),x(s[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),T.$attr_reader("categories"),L(T,"$roll_command",function(_,n){var v,$=this,p=t,w=t;return Q(["RTT",$.rtt]["$include?"](v=n))?$.$format_skill($.rtt_format,$.$roll_skill(_)):Q(["RCT",$.rct]["$include?"](v))?(p=$.$roll_category(_),$.$format($.rct_format,G(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):Q(w=m("RTTN").$index(v))||Q(w=$.rttn.$index(v))?$.$format_skill($.rttn_format,$.categories["$[]"](w).$roll(_)):t},2),L(T,"$roll_category",function(_){return this.categories["$[]"](F(_.$roll_once(6),1))},1),L(T,"$roll_skill",function(_){return this.$roll_category(_).$roll(_)},1),L(T,"$prefixes",function(){var _=this;return j(["RTT[1-6]?","RCT",_.rtt,_.rct],_.rttn).$compact()},0),T.$private(),L(T,"$format_skill",function(_,n){return this.$format(_,G(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var x,F,d,l,z,W,H,X,L,K=[],i=r.nil,t=r.module,e=r.klass,g=r.hash2,E=r.defs,G=r.truthy,u=r.def,B=r.rb_minus;return x=K,F=L=[t(K[0],"BCDice")].concat(x),d=X=[t(L[0],"DiceTable")].concat(F),z=[l=e(X[0],null,"Table")].concat(d),W=r.$r(z),(H=l.$$prototype).times=H.sides=H.name=H.items=i,E(l,"$from_i18n",function(h,y){var s=i;return s=W("I18n").$t(h,g(["locale"],{locale:y})),this.$new(s["$[]"]("name"),s["$[]"]("type"),s["$[]"]("items"))},2),u(l,"$initialize",function(h,y,T){var s=this,m=i;return s.name=h,s.items=T.$freeze(),m=/(\d+)D(\d+)/i.$match(y),G(m)||s.$raise(W("ArgumentError"),"Unexpected table type: "+y),s.times=m["$[]"](1).$to_i(),s.sides=m["$[]"](2).$to_i()},3),u(l,"$roll",function(h){var T,y=this;return T=h.$roll_sum(y.times,y.sides),y.$choice(T)},1),u(l,"$choice",function(h){var T,y=this;return T=B(h,y.times),W("RollResult").$new(y.name,h,y.items["$[]"](T))},1)},Opal.modules["bcdice/dice_table"]=function(r){var K=r.top;return K.$require("bcdice/dice_table/roll_result"),K.$require("bcdice/dice_table/chain_table"),K.$require("bcdice/dice_table/d66_grid_table"),K.$require("bcdice/dice_table/d66_half_grid_table"),K.$require("bcdice/dice_table/d66_one_third_table"),K.$require("bcdice/dice_table/d66_left_range_table"),K.$require("bcdice/dice_table/d66_parity_table"),K.$require("bcdice/dice_table/d66_range_table"),K.$require("bcdice/dice_table/d66_table"),K.$require("bcdice/dice_table/range_table"),K.$require("bcdice/dice_table/sai_fic_skill_table"),K.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var E,I,A,u,K=[],t=r.module,e=r.const_set;return E=K,I=u=[t(K[0],"BCDice")].concat(E),A=[t(u[0],"D66SortType")].concat(I),e(A[0],"NO_SORT","no_sort"),e(A[0],"ASC","asc"),e(A[0],"DESC","desc"),function(B,I){var A=[t(B,"RoundType")].concat(I);return e(A[0],"CEIL","ceil"),e(A[0],"FLOOR","floor"),e(A[0],"ROUND","round")}(u[0],u)},Opal.modules["bcdice/translate"]=function(r){var u,A,L,Q,F,I,K=[],i=r.nil,t=r.module,e=r.hash2,E=r.def;return u=K,A=I=[t(K[0],"BCDice")].concat(u),Q=[L=t(I[0],"Translate")].concat(A),F=r.$r(Q),E(L,"$translate",function(X,V){var N,d=this;if(null==d.locale&&(d.locale=i),null==V)V=e([],{});else if(!V.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return N=r.kwrestargs(V,{}),F("I18n").$translate(X,e(["locale","raise"],{locale:d.locale,raise:!0}).$merge(r.to_hash(N)))},-2)},Opal.modules["bcdice/result"]=function(r){var I,F,N,j,V,A,K=[],i=r.nil,e=r.klass,g=r.send,E=r.to_a,G=r.rb_minus,u=r.def;return I=K,F=A=[(0,r.module)(K[0],"BCDice")].concat(I),[j=e(A[0],null,"Result")].concat(F),(V=j.$$prototype).secret=V.success=V.failure=V.critical=V.fumble=i,u(N=r.get_singleton_class(j),"$success",function(z){return g(this.$new(),"tap",[],function(b){var h=i;return null==b&&(b=i),g(b,"text=",E(h=[z])),G(h.length,1),g(b,"success=",E(h=[!0])),h[G(h.length,1)]},1)},1),u(N,"$failure",function(z){return g(this.$new(),"tap",[],function(b){var h=i;return null==b&&(b=i),g(b,"text=",E(h=[z])),G(h.length,1),g(b,"failure=",E(h=[!0])),h[G(h.length,1)]},1)},1),u(N,"$critical",function(z){return g(this.$new(),"tap",[],function(b){var h=i;return null==b&&(b=i),g(b,"text=",E(h=[z])),G(h.length,1),g(b,"critical=",E(h=[!0])),G(h.length,1),g(b,"success=",E(h=[!0])),h[G(h.length,1)]},1)},1),u(N,"$fumble",function(z){return g(this.$new(),"tap",[],function(b){var h=i;return null==b&&(b=i),g(b,"text=",E(h=[z])),G(h.length,1),g(b,"fumble=",E(h=[!0])),G(h.length,1),g(b,"failure=",E(h=[!0])),h[G(h.length,1)]},1)},1),u(N,"$nothing",function(){return"nothing"},0),u(j,"$initialize",function(d){var l=this;return null==d&&(d=i),l.text=d,l.rands=i,l.detailed_rands=i,l.secret=!1,l.success=!1,l.failure=!1,l.critical=!1,l.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),u(j,"$secret?",function(){return this.secret},0),u(j,"$success?",function(){return this.success},0),u(j,"$failure?",function(){return this.failure},0),u(j,"$critical?",function(){return this.critical},0),u(j,"$fumble?",function(){return this.fumble},0),u(j,"$condition=",function(d){return this.success=d,this.failure=d["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var y,s,m,i=[],t=r.$r(i),e=r.nil,g=r.$$$,E=r.module,G=r.klass,u=r.truthy,B=r.const_set,I=r.defs,x=r.gvars,A=r.rb_lt,L=r.send,Q=r.to_a,F=r.rb_minus,j=r.def,X=r.to_ary,V=r.neqeq,N=r.rb_plus,d=r.eqeq,l=r.rb_ge,z=r.rb_gt,W=r.eqeqeq,H=r.rb_le,b=r.rb_times;return y=i,s=[E(i[0],"Racc")].concat(y),m=r.$r(s),G(s[0],m("StandardError"),"ParseError"),u(g("::","ParseError","skip_raise")?"constant":e)||B(i[0],"ParseError",g(t("Racc"),"ParseError")),function(h,y){var n,$,v,p,w,m=[E(h,"Racc")].concat(y),f=r.$r(m);return u(f("Racc_No_Extensions","skip_raise")?"constant":e)||B(m[0],"Racc_No_Extensions",!1),n=m,v=[$=G(m[0],null,"Parser")].concat(n),p=r.$r(v),(w=$.$$prototype).yydebug=w.racc_debug_out=w.racc_error_status=w.racc_t=w.racc_vstack=w.racc_val=w.racc_state=w.racc_tstack=e,B(v[0],"Racc_Runtime_Version","1.4.6"),B(v[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),B(v[0],"Racc_Runtime_Core_Version_R","1.4.6"),B(v[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),B(v[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),B(v[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),B(v[0],"Racc_Runtime_Core_Version",p("Racc_Runtime_Core_Version_R")),B(v[0],"Racc_Runtime_Core_Revision",p("Racc_Runtime_Core_Revision_R")),B(v[0],"Racc_Runtime_Type","ruby"),I(p("Parser"),"$racc_runtime_type",function(){return p("Racc_Runtime_Type")},0),j($,"$_racc_setup",function(){var M,re,c=this,ne=e,D=e,te=e;return null==x.stderr&&(x.stderr=e),u(g(c.$class(),"Racc_debug_parser"))||(c.yydebug=!1),u(null!=(M=c.yydebug)&&M!==e?"instance-variable":e)||(c.yydebug=!1),u(c.yydebug)&&(u(null!=(re=c.racc_debug_out)&&re!==e?"instance-variable":e)||(c.racc_debug_out=x.stderr),c.racc_debug_out=u(ne=c.racc_debug_out)?ne:x.stderr),D=g(c.$class(),"Racc_arg"),u(A(D.$size(),14))&&(L(D,"[]=",Q(te=[13,!0])),F(te.length,1)),D},0),j($,"$_racc_init_sysvars",function(){var M=this;return M.racc_state=[0],M.racc_tstack=[],M.racc_vstack=[],M.racc_t=e,M.racc_val=e,M.racc_read_next=!0,M.racc_user_yyerror=!1,M.racc_error_status=0},0),j($,"$do_parse",function(){return this.$__send__(p("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j($,"$next_token",function(){return this.$raise(p("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j($,"$_racc_do_parse_rb",function(M,re){var c,D=this,te=e,le=e,_e=e,oe=e,$e=e,P=e,ie=e,k=e;return c=X(M),te=null==c[0]?e:c[0],le=null==c[1]?e:c[1],_e=null==c[2]?e:c[2],oe=null==c[3]?e:c[3],$e=null==c[10]?e:c[10],D.$_racc_init_sysvars(),P=ie=k=e,L(D,"catch",["racc_end_parse"],function S(){var C,Z,o=null==S.$$s?this:S.$$s,R=e;for(null==o.racc_state&&(o.racc_state=e),null==o.racc_read_next&&(o.racc_read_next=e),null==o.racc_t&&(o.racc_t=e),null==o.yydebug&&(o.yydebug=e),null==o.racc_val&&(o.racc_val=e);u(!0);)for(u(k=oe["$[]"](o.racc_state["$[]"](-1)))?(u(o.racc_read_next)&&V(o.racc_t,0)&&(Z=o.$next_token(),C=X(Z),P=null==C[0]?e:C[0],o.racc_val=null==C[1]?e:C[1],o.racc_t=u(P)?u(R=$e["$[]"](P))?R:1:0,u(o.yydebug)&&o.$racc_read_token(o.racc_t,P,o.racc_val),o.racc_read_next=!1),k=N(k,o.racc_t),u(l(k,0))&&u(ie=te["$[]"](k))&&d(le["$[]"](k),o.racc_state["$[]"](-1))||(ie=_e["$[]"](o.racc_state["$[]"](-1)))):ie=_e["$[]"](o.racc_state["$[]"](-1));u(ie=o.$_racc_evalact(ie,M)););},{$$arity:0,$$s:D})},2),j($,"$yyparse",function(M,re){return this.$__send__(p("Racc_YY_Parse_Method"),M,re,this.$_racc_setup(),!0)},2),j($,"$_racc_yyparse_rb",function(M,re,c,ne){var D,_e=e,oe=e,ue=e,$e=e,ie=e,k=e,S=e;return D=X(c),_e=null==D[0]?e:D[0],oe=null==D[1]?e:D[1],ue=null==D[2]?e:D[2],$e=null==D[3]?e:D[3],ie=null==D[10]?e:D[10],this.$_racc_init_sysvars(),k=e,S=e,L(this,"catch",["racc_end_parse"],function ee(){var o=null==ee.$$s?this:ee.$$s;for(null==o.racc_state&&(o.racc_state=e);!u(S=$e["$[]"](o.racc_state["$[]"](-1)));)for(;u(k=o.$_racc_evalact(ue["$[]"](o.racc_state["$[]"](-1)),c)););return L(M,"__send__",[re],function R(J,se){var Y=null==R.$$s?this:R.$$s,U=e,fe=e;for(null==Y.racc_t&&(Y.racc_t=e),null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==J&&(J=e),null==se&&(se=e),Y.racc_t=u(J)?u(U=ie["$[]"](J))?U:1:0,Y.racc_val=se,Y.racc_read_next=!1,S=N(S,Y.racc_t),u(l(S,0))&&u(k=_e["$[]"](S))&&d(oe["$[]"](S),Y.racc_state["$[]"](-1))||(k=ue["$[]"](Y.racc_state["$[]"](-1)));u(k=Y.$_racc_evalact(k,c)););for(;u(u(U=u(fe=(S=$e["$[]"](Y.racc_state["$[]"](-1)))["$!"]())?fe:Y.racc_read_next["$!"]())?U:Y.racc_t["$=="](0));)for(u(S)&&u(S=N(S,Y.racc_t))&&u(l(S,0))&&u(k=_e["$[]"](S))&&d(oe["$[]"](S),Y.racc_state["$[]"](-1))||(k=ue["$[]"](Y.racc_state["$[]"](-1)));u(k=Y.$_racc_evalact(k,c)););},{$$arity:2,$$s:o})},{$$arity:0,$$s:this})},4),j($,"$_racc_evalact",function(M,re){var c,ue,D=this,te=e,le=e,oe=e,$e=e,P=e,ie=e,k=e;if(te=null==(c=X(re))[0]?e:c[0],le=null==c[1]?e:c[1],oe=null==c[3]?e:c[3],ue=null==c[11]?e:c[11],$e=null==c[12]?e:c[12],u(z(M,0))&&u(A(M,ue)))u(z(D.racc_error_status,0))&&(d(D.racc_t,1)||(D.racc_error_status=F(D.racc_error_status,1))),D.racc_vstack.$push(D.racc_val),D.racc_state.$push(M),D.racc_read_next=!0,u(D.yydebug)&&(D.racc_tstack.$push(D.racc_t),D.$racc_shift(D.racc_t,D.racc_tstack,D.racc_vstack));else if(u(A(M,0))&&u(z(M,$e["$-@"]()))){if(P=L(D,"catch",["racc_jump"],function S(){var ee=null==S.$$s?this:S.$$s;return null==ee.racc_state&&(ee.racc_state=e),ee.racc_state.$push(ee.$_racc_do_reduce(re,M)),!1},{$$arity:0,$$s:D}),u(P)){if(W(1,ie=P))return D.racc_user_yyerror=!0,$e["$-@"]();if(W(2,ie))return ue;D.$raise("[Racc Bug] unknown jump code")}}else if(d(M,ue))u(D.yydebug)&&D.$racc_accept(),D.$throw("racc_end_parse",D.racc_vstack["$[]"](0));else{if(d(M,$e["$-@"]())){for(W(0,ie=D.racc_error_status)?u(re["$[]"](21))||D.$on_error(D.racc_t,D.racc_val,D.racc_vstack):W(3,ie)&&(d(D.racc_t,0)&&D.$throw("racc_end_parse",e),D.racc_read_next=!0),D.racc_user_yyerror=!1,D.racc_error_status=3;u(!0)&&!(u(k=oe["$[]"](D.racc_state["$[]"](-1)))&&(k=N(k,1),u(l(k,0))&&u(M=te["$[]"](k))&&d(le["$[]"](k),D.racc_state["$[]"](-1))));)u(H(D.racc_state.$size(),1))&&D.$throw("racc_end_parse",e),D.racc_state.$pop(),D.racc_vstack.$pop(),u(D.yydebug)&&(D.racc_tstack.$pop(),D.$racc_e_pop(D.racc_state,D.racc_tstack,D.racc_vstack));return M}D.$raise("[Racc Bug] unknown action "+M.$inspect())}return u(D.yydebug)&&D.$racc_next_state(D.racc_state["$[]"](-1),D.racc_state),e},2),j($,"$_racc_do_reduce",function(M,re){var c,$e,ie,o,R,J,Y,D=this,le=e,_e=e,oe=e,ue=e,P=e,k=e,S=e,ee=e,C=e,Z=e,se=e,O=e,ae=e,U=e;return le=null==(c=X(M))[4]?e:c[4],_e=null==c[5]?e:c[5],oe=null==c[6]?e:c[6],ue=null==c[7]?e:c[7],$e=null==c[8]?e:c[8],P=null==c[9]?e:c[9],ie=null==c[13]?e:c[13],k=D.racc_state,S=D.racc_vstack,ee=D.racc_tstack,C=b(re,-3),Z=P["$[]"](C),o=P["$[]"](N(C,1)),R=P["$[]"](N(C,2)),J=[],u(D.yydebug)&&(se=ee["$[]"](Z["$-@"](),Z)),O=S["$[]"](Z["$-@"](),Z),u(D.yydebug)&&(ae=[Z["$-@"](),Z,J],L(ee,"[]=",Q(ae)),F(ae.length,1)),ae=[Z["$-@"](),Z,J],L(S,"[]=",Q(ae)),F(ae.length,1),ae=[Z["$-@"](),Z,J],L(k,"[]=",Q(ae)),F(ae.length,1),u(ie)?S.$push(D.$__send__(R,O,S,O["$[]"](0))):S.$push(D.$__send__(R,O,S)),ee.$push(o),u(D.yydebug)&&D.$racc_reduce(se,o,ee,S),Y=F(o,$e),u(C=ue["$[]"](Y))&&(C=N(C,k["$[]"](-1)),u(l(C,0))&&u(U=le["$[]"](C))&&d(_e["$[]"](C),Y))?U:oe["$[]"](Y)},2),j($,"$on_error",function(M,re,c){var D;return this.$raise(p("ParseError"),this.$sprintf("\nparse error on value %s (%s)",re.$inspect(),u(D=this.$token_to_str(M))?D:"?"))},3),j($,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j($,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j($,"$yyerrok",function(){return this.racc_error_status=0},0),j($,"$racc_read_token",function(M,re,c){var ne=this;return ne.racc_debug_out.$print("read    "),ne.racc_debug_out.$print(re.$inspect(),"(",ne.$racc_token2str(M),") "),ne.racc_debug_out.$puts(c.$inspect()),ne.racc_debug_out.$puts()},3),j($,"$racc_shift",function(M,re,c){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(M)),this.$racc_print_stacks(re,c),this.racc_debug_out.$puts()},3),j($,"$racc_reduce",function(M,re,c,ne){var D=this,te=e;return(te=D.racc_debug_out).$print("reduce "),u(M["$empty?"]())?te.$print(" <none>"):L(M,"each",[],function le(_e){return null==_e&&(_e=e),te.$print(" ",(null==le.$$s?this:le.$$s).$racc_token2str(_e))},{$$arity:1,$$s:D}),te.$puts(" --\x3e "+D.$racc_token2str(re)),D.$racc_print_stacks(c,ne),D.racc_debug_out.$puts()},4),j($,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j($,"$racc_e_pop",function(M,re,c){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(M),this.$racc_print_stacks(re,c),this.racc_debug_out.$puts()},3),j($,"$racc_next_state",function(M,re){var c=this;return c.racc_debug_out.$puts("goto    "+M),c.$racc_print_states(re),c.racc_debug_out.$puts()},2),j($,"$racc_print_stacks",function(M,re){var ne=e;return(ne=this.racc_debug_out).$print("        ["),L(M,"each_index",[],function D(te){return null==te&&(te=e),ne.$print(" (",(null==D.$$s?this:D.$$s).$racc_token2str(M["$[]"](te))," ",re["$[]"](te).$inspect(),")")},{$$arity:1,$$s:this}),ne.$puts(" ]")},2),j($,"$racc_print_states",function(M){var c=e;return(c=this.racc_debug_out).$print("        ["),L(M,"each",[],function(D){return null==D&&(D=e),c.$print(" ",D)},1),c.$puts(" ]")},1),j($,"$racc_token2str",function(M){var c;return u(c=g(this.$class(),"Racc_token_to_s_table")["$[]"](M))?c:this.$raise("[Racc Bug] can't convert token "+M+" to string")},1),j($,"$token_to_str",function(M){return g(this.$class(),"Racc_token_to_s_table")["$[]"](M)},1)}(i[0],i)},Opal.modules["bcdice/arithmetic/node"]=function(r){var F,N,W,s,m,b,h,l,X,K=[],i=r.nil,t=r.$$$,e=r.module,g=r.klass,E=r.def,G=r.send2,u=r.find_super,B=r.eqeq,I=r.const_set,x=r.eqeqeq,A=r.rb_divide,L=r.alias;return F=K,N=X=[e(K[0],"BCDice")].concat(F),W=l=[e(X[0],"Arithmetic")].concat(N),b=[e(l[0],"Node")].concat(W),h=r.$r(b),(m=(s=g(b[0],null,"BinaryOp")).$$prototype).lhs=m.rhs=m.op=i,E(s,"$initialize",function(a,_,n){var $=this;return $.lhs=a,$.op=_,$.rhs=n},3),E(s,"$eval",function(a){var $,_=this,n=i;return n=_.lhs.$eval(a),$=_.rhs.$eval(a),n.$send(_.op,$)},1),E(s,"$output",function(){var a=this;return""+a.lhs.$output()+a.op+a.rhs.$output()},0),E(s,"$s_exp",function(){var a=this;return"("+a.$op_for_s_exp()+" "+a.lhs.$s_exp()+" "+a.rhs.$s_exp()+")"},0),E(s,"$op_for_s_exp",function(){return this.op},0),function(y,T,s){var m=g(y,T,"DivideBase"),f=[m].concat(s),a=r.$r(f),_=m.$$prototype;_.lhs=_.rhs=_.op=i,E(m,"$initialize",function n($,v){return delete n.$$p,G(this,u(this,"initialize",n,!1,!0),"initialize",[$,"/",v],null)},2),E(m,"$eval",function($){var p,w,v=this;return p=v.lhs.$eval($),w=v.rhs.$eval($),B(w,0)&&v.$raise(a("ZeroDivisionError")),v.$divide_and_round(p,w,$)},1),E(m,"$output",function n(){var $=n.$$p||i,v=this;return delete n.$$p,""+G(v,u(v,"output",n,!1,!0),"output",[],$)+v.$rounding_method()},0),m.$private(),E(m,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")},0),E(m,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),E(m,"$divide_and_round",function($,v,p){return this.$raise(a("NotImplementedError"))},3)}(b[0],h("BinaryOp"),b),function(y,T,s){var m=g(y,T,"DivideWithGameSystemDefault"),f=[m].concat(s),a=r.$r(f);I(f[0],"ROUNDING_METHOD",""),m.$private(),E(m,"$divide_and_round",function(n,$,v){var p;return x(t(a("RoundType"),"CEIL"),p=v)?A(n.$to_f(),$).$ceil():x(t(a("RoundType"),"ROUND"),p)?A(n.$to_f(),$).$round():A(n,$).$floor()},3)}(b[0],h("DivideBase"),b),function(y,T,s){var m=g(y,T,"DivideWithCeil"),f=[m].concat(s);I(f[0],"ROUNDING_METHOD","C"),m.$private(),E(m,"$divide_and_round",function(_,n,$){return A(_.$to_f(),n).$ceil()},3)}(b[0],h("DivideBase"),b),function(y,T,s){var m=g(y,T,"DivideWithRound"),f=[m].concat(s);I(f[0],"ROUNDING_METHOD","R"),m.$private(),E(m,"$divide_and_round",function(_,n,$){return A(_.$to_f(),n).$round()},3)}(b[0],h("DivideBase"),b),function(y,T,s){var m=g(y,T,"DivideWithFloor"),f=[m].concat(s);I(f[0],"ROUNDING_METHOD","F"),m.$private(),E(m,"$divide_and_round",function(_,n,$){return A(_,n).$to_i()},3)}(b[0],h("DivideBase"),b),function(y,T){var s=g(y,null,"Negative");s.$$prototype.body=i,E(s,"$initialize",function(a){return this.body=a},1),E(s,"$eval",function(a){return this.body.$eval(a)["$-@"]()},1),E(s,"$output",function(){return"-"+this.body.$output()},0),E(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(b[0]),function(y,T){var s=g(y,null,"Parenthesis");s.$$prototype.expr=i,E(s,"$initialize",function(a){return this.expr=a},1),E(s,"$eval",function(a){return this.expr.$eval(a)},1),E(s,"$output",function(){return"("+this.expr.$output()+")"},0),E(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(b[0]),function(y,T){var s=g(y,null,"Number");return s.$$prototype.value=i,E(s,"$initialize",function(a){return this.value=a},1),E(s,"$eval",function(a){return this.value},1),E(s,"$output",function(){return this.value.$to_s()},0),L(s,"s_exp","output")}(b[0])},Opal.modules.strscan=function(r){var Q,F,j,X,V,K=[],i=r.nil,e=r.def,g=r.truthy,E=r.eqeqeq,G=r.Opal,u=r.send,B=r.to_a,I=r.rb_minus,x=r.alias;return Q=K,j=[F=(0,r.klass)(K[0],null,"StringScanner")].concat(Q),X=r.$r(j),(V=F.$$prototype).pos=V.string=V.working=V.matched=V.prev_pos=V.match=i,F.$attr_reader("pos","matched"),e(F,"$initialize",function(d){var l=this;return l.string=d,l.pos=0,l.matched=i,l.working=d,l.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var d=this;return 0===d.pos||"\n"===d.string.charAt(d.pos-1)},0),e(F,"$scan",function(d){var l=this,z=(d=l.$anchor(d)).exec(l.working);return null==z?l.matched=i:"object"==typeof z?(l.prev_pos=l.pos,l.pos+=z[0].length,l.working=l.working.substring(z[0].length),l.matched=z[0],l.match=z,z[0]):"string"==typeof z?(l.pos+=z.length,l.working=l.working.substring(z.length),z):i},1),e(F,"$scan_until",function(d){var l=this;d=l.$anchor(d);for(var H,z=l.pos,W=l.working;;){if(H=d.exec(W),z+=1,W=W.substr(1),null!=H)return l.matched=l.string.substr(l.pos,z-l.pos-1+H[0].length),l.match=H,l.prev_pos=z-1,l.pos=z,l.working=W.substr(H[0].length),l.matched;if(0===W.length)return l.match=[],l.matched=i}},1),e(F,"$[]",function(d){var z;if(g(this.match["$empty?"]()))return i;E(X("Symbol"),z=d)?d=d.$to_s():E(X("String"),z)||(d=G["$coerce_to!"](d,X("Integer"),"to_int"));var W=this.match;return d<0&&(d+=W.length),d<0||d>=W.length||null==W[d]?i:W[d]},1),e(F,"$check",function(d){var l=this,z=(d=l.$anchor(d)).exec(l.working);return l.matched=null==z?i:z[0]},1),e(F,"$check_until",function(d){var l=this,z=l.prev_pos,W=l.pos,H=l.$scan_until(d);return H!==i&&(l.matched=H.substr(-1),l.working=l.string.substr(W)),l.prev_pos=z,l.pos=W,H},1),e(F,"$peek",function(d){return this.working.substring(0,d)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(d){var z=d.exec(this.working);return null==z?i:0==z.index?0:z.index+1},1),e(F,"$skip",function(d){var l=this,z=(d=l.$anchor(d)).exec(l.working);if(null==z)return l.match=[],l.matched=i;var W=z[0],H=W.length;return l.matched=W,l.match=z,l.prev_pos=l.pos,l.pos+=H,l.working=l.working.substring(H),H},1),e(F,"$skip_until",function(d){var z=this.$scan_until(d);return z===i?i:(this.matched=z.substr(-1),z.length)},1),e(F,"$get_byte",function(){var d=this,l=i;return d.pos<d.string.length?(d.prev_pos=d.pos,d.pos+=1,l=d.matched=d.working.substring(0,1),d.working=d.working.substring(1)):d.matched=i,l},0),e(F,"$match?",function(d){var l=this,z=(d=l.$anchor(d)).exec(l.working);return null==z?i:(l.prev_pos=l.pos,z[0].length)},1),e(F,"$pos=",function(d){var l=this;return d<0&&(d+=l.string.$length()),l.pos=d,l.working=l.string.slice(d)},1),e(F,"$matched_size",function(){return this.matched===i?i:this.matched.length},0),e(F,"$post_match",function(){var d=this;return d.matched===i?i:d.string.substr(d.pos)},0),e(F,"$pre_match",function(){var d=this;return d.matched===i?i:d.string.substr(0,d.prev_pos)},0),e(F,"$reset",function(){var d=this;return d.working=d.string,d.matched=i,d.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var l,d=this;return d.match=i,l=[d.string.$length()],u(d,"pos=",B(l)),l[I(l.length,1)]},0),e(F,"$unscan",function(){var d=this;return d.pos=d.prev_pos,d.prev_pos=i,d.match=i,d},0),x(F,"bol?","beginning_of_line?"),x(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(d){var l=d.toString().match(/\/([^\/]+)$/);return l=l?l[1]:void 0,new RegExp("^(?:"+d.source+")",l)},1)},Opal.modules["bcdice/normalize"]=function(r){var u,A,I,K=[],i=r.nil,t=r.module,e=r.eqeqeq,g=r.def,E=r.eqeq;return u=K,I=[t(K[0],"BCDice")].concat(u),(A=t(I[0],"Normalize")).$module_function(),g(A,"$comparison_operator",function(Q){var F;return e(/<=|=</,F=Q)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":i},1),g(A,"$target_number",function(Q){return E(Q,"?")?Q:Q.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var A,j,l,z,W,H,b,V,Q,K=r.top,i=[],t=r.nil,e=r.module,g=r.klass,E=r.const_set,G=r.hash2,u=r.truthy,B=r.send,I=r.def;return K.$require("strscan"),K.$require("bcdice/normalize"),A=i,j=Q=[e(i[0],"BCDice")].concat(A),l=V=[e(Q[0],"Command")].concat(j),W=[z=g(V[0],null,"Lexer")].concat(l),H=r.$r(W),(b=z.$$prototype).scanner=b.notations=t,E(W[0],"SYMBOLS",G(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),I(z,"$initialize",function(y,T){var s,m,a;return y=u(a=(m=(s=y)===t||null==s?t:B(s,"split",[" ",2]))===t||null==m?t:B(m,"first",[]))?a:"",this.scanner=H("StringScanner").$new(y),this.notations=B(T,"map",[],function(n){return null==n&&(n=t),u(n["$is_a?"](H("String")))?H("Regexp").$new(n):n},1)},2),I(z,"$next_token",function(){try{var y=this,T=t,s=t,f=t,a=t;return u(y.scanner["$eos?"]())?[!1,"$"]:(B(y.notations,"each",[],function _(n){var v,$=null==_.$$s?this:_.$$s;if(null==$.scanner&&($.scanner=t),null==n&&(n=t),v=$.scanner.$scan(n),!u(v))return t;r.ret(["NOTATION",v])},{$$arity:1,$$s:y}),u(T=y.scanner.$scan(/\d+/))?["NUMBER",T.$to_i()]:u(s=y.scanner.$scan(/[<>!=]+/))?(s=H("Normalize").$comparison_operator(s),[u(s)?"CMP_OP":"ILLEGAL",s]):(f=y.scanner.$getch().$upcase(),[u(a=H("SYMBOLS")["$[]"](f))?a:f.$to_sym(),f]))}catch(_){if(_===r.returner)return _.$v;throw _}},0),I(z,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var B,L,V,N,d,l,z,F,x,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.truthy,G=r.eqeqeq;return B=K,L=x=[t(K[0],"BCDice")].concat(B),V=F=[t(x[0],"Command")].concat(L),d=[N=e(F[0],null,"Parsed")].concat(V),l=r.$r(d),(z=N.$$prototype).question_target=z.critical=z.fumble=z.dollar=z.modify_number=z.target_number=z.prefix_number=z.command=z.suffix_number=z.cmp_op=i,N.$attr_accessor("command"),N.$attr_accessor("prefix_number"),N.$attr_accessor("suffix_number"),N.$attr_accessor("critical"),N.$attr_accessor("fumble"),N.$attr_accessor("dollar"),N.$attr_accessor("modify_number"),N.$attr_accessor("cmp_op"),N.$attr_accessor("target_number"),N.$attr_writer("question_target"),g(N,"$initialize",function(){var H=this;return H.prefix_number=i,H.suffix_number=i,H.critical=i,H.fumble=i,H.dollar=i,H.cmp_op=i,H.target_number=i,H.question_target=!1},0),g(N,"$question_target?",function(){return this.question_target},0),g(N,"$to_s",function(H){var f,b=this,h=i,y=i,T=i,s=i,m=i;return null==H&&(H="after_command"),h=E(b.critical)?"@"+b.critical:i,y=E(b.fumble)?"#"+b.fumble:i,T=E(b.dollar)?"$"+b.dollar:i,s=l("Format").$modifier(b.modify_number),m=E(b.question_target)?"?":b.target_number,G("after_command",f=H)?[b.prefix_number,b.command,b.suffix_number,h,y,T,s,b.cmp_op,m].$join():G("after_modify_number",f)?[b.prefix_number,b.command,b.suffix_number,s,h,y,T,b.cmp_op,m].$join():G("after_target_number",f)?[b.prefix_number,b.command,b.suffix_number,s,b.cmp_op,m,h,y,T].$join():i},-1)},Opal.modules["bcdice/command/parser"]=function(r){var l,b,f,$,v,p,w,q,M,re,c,ne,le,a,_,n,ue,y,T,W,K=r.top,i=[],t=r.$r(i),e=r.nil,g=r.$$$,E=r.klass,G=r.module,u=r.hash2,B=r.send2,I=r.find_super,x=r.def,A=r.send,L=r.to_a,Q=r.rb_minus,F=r.eqeq,j=r.hash,X=r.const_set,V=r.truthy,N=r.to_ary;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/command/lexer"),K.$require("bcdice/command/parsed"),E(g(t("BCDice"),"Command"),g(t("Racc"),"Parser"),"Parser"),l=i,b=W=[G(i[0],"BCDice")].concat(l),y=[G(W[0],"Command")].concat(b),T=r.$r(y),f=y,_=[a=E(y[0],g(T("Racc"),"Parser"),"Parser")].concat(f),n=r.$r(_),(ue=a.$$prototype).notations=ue.lexer=ue.modifier=ue.suffix_number=ue.prefix_number=ue.need_suffix_number=ue.need_prefix_number=ue.critical=ue.fumble=ue.dollar=ue.allowed_cmp_op=ue.question_target=e,x(a,"$initialize",function $e(P,ie){var k,S,ee,C,o=this;if(delete $e.$$p,k=r.slice.call(arguments),null==(S=r.extract_kwargs(k)))S=u([],{});else if(!S.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ee=k,!r.hasOwnProperty.call(S.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return C=S.$$smap.round_type,B(o,I(o,"initialize",$e,!1,!0),"initialize",[],null),o.notations=ee,o.round_type=C,o.prefix_number=!1,o.suffix_number=!1,o.need_prefix_number=!1,o.need_suffix_number=!1,o.modifier=!0,o.critical=!1,o.fumble=!1,o.dollar=!1,o.allowed_cmp_op=[e,">=",">","<=","<","==","!="],o.question_target=!1},-2),x(a,"$disable_modifier",function(){return this.modifier=!1,this},0),x(a,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),x(a,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),x(a,"$has_prefix_number",function(){var P=this;return P.prefix_number=!0,P.need_prefix_number=!0,P},0),x(a,"$has_suffix_number",function(){var P=this;return P.suffix_number=!0,P.need_suffix_number=!0,P},0),x(a,"$enable_critical",function(){return this.critical=!0,this},0),x(a,"$enable_fumble",function(){return this.fumble=!0,this},0),x(a,"$enable_dollar",function(){return this.dollar=!0,this},0),x(a,"$restrict_cmp_op_to",function(P){var ie,S=this;return ie=r.slice.call(arguments),S.allowed_cmp_op=ie,S},-1),x(a,"$enable_question_target",function(){return this.question_target=!0,this},0),x(a,"$parse",function(P){try{return this.lexer=n("Lexer").$new(P,this.notations),this.$do_parse()}catch(k){if(!r.rescue(k,[n("ParseError"),n("ZeroDivisionError")]))throw k;try{return e}finally{r.pop_exception()}}},1),a.$private(),x(a,"$parsed",function(P,ie,k,S){return A(n("Parsed").$new(),"tap",[],function C(Z){var o,R,J,se,O,ae,Y=null==C.$$s?this:C.$$s,U=e;return null==Y.round_type&&(Y.round_type=e),null==Z&&(Z=e),U=[P["$[]"]("command")],A(Z,"command=",L(U)),Q(U.length,1),U=[(o=P["$[]"]("prefix"),o===e||null==o?e:A(o,"eval",[Y.round_type]))],A(Z,"prefix_number=",L(U)),Q(U.length,1),U=[(R=P["$[]"]("suffix"),R===e||null==R?e:A(R,"eval",[Y.round_type]))],A(Z,"suffix_number=",L(U)),Q(U.length,1),U=[(J=ie["$[]"]("critical"),J===e||null==J?e:A(J,"eval",[Y.round_type]))],A(Z,"critical=",L(U)),Q(U.length,1),U=[(se=ie["$[]"]("fumble"),se===e||null==se?e:A(se,"eval",[Y.round_type]))],A(Z,"fumble=",L(U)),Q(U.length,1),U=[(O=ie["$[]"]("dollar"),O===e||null==O?e:A(O,"eval",[Y.round_type]))],A(Z,"dollar=",L(U)),Q(U.length,1),U=[k.$eval(Y.round_type)],A(Z,"modify_number=",L(U)),Q(U.length,1),U=[S["$[]"]("cmp_op")],A(Z,"cmp_op=",L(U)),Q(U.length,1),F(S["$[]"]("target"),"?")?(A(Z,"question_target=",L(U=[!0])),Q(U.length,1),A(Z,"target_number=",L(U=[0])),U[Q(U.length,1)]):(A(Z,"question_target=",L(U=[!1])),Q(U.length,1),U=[(ae=S["$[]"]("target"),ae===e||null==ae?e:A(ae,"eval",[Y.round_type]))],A(Z,"target_number=",L(U)),U[Q(U.length,1)])},{$$arity:1,$$s:this})},4),x(a,"$next_token",function(){return this.lexer.$next_token()},0),$=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],v=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],p=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],w=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],q=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],M=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],re=[e,6,13,3,9,-1,27,-15,-10,-1,-38],c=[e,e,e,e,e,e,19,16,15,e,e],ne=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],le=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),X(_[0],"Racc_arg",[$,v,w,p,q,M,c,re,19,ne,le,58,35,!0]),X(_[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),X(_[0],"Racc_debug_parser",!1),x(a,"$_reduce_1",function(P,ie,k){var S,C=this;return V(C.modifier)||C.$raise(n("ParseError")),S=N(P),C.$parsed(null==S[0]?e:S[0],null==S[1]?e:S[1],null==S[2]?e:S[2],null==S[3]?e:S[3])},3),x(a,"$_reduce_2",function(P,ie,k){var S,C=this;return V(C.modifier)||C.$raise(n("ParseError")),S=N(P),C.$parsed(null==S[0]?e:S[0],null==S[2]?e:S[2],null==S[1]?e:S[1],null==S[3]?e:S[3])},3),x(a,"$_reduce_3",function(P,ie,k){var S,R;return R=null==(S=N(P))[2]?e:S[2],this.$parsed(null==S[0]?e:S[0],null==S[1]?e:S[1],g(g(n("Arithmetic"),"Node"),"Number").$new(0),R)},3),x(a,"$_reduce_4",function(P,ie,k){var S=this;return V(S.prefix_number)&&V(S.suffix_number)||S.$raise(n("ParseError")),u(["command","prefix","suffix"],{command:P["$[]"](1),prefix:P["$[]"](0),suffix:P["$[]"](2)})},3),x(a,"$_reduce_5",function(P,ie,k){var S=this;return V(S.prefix_number)||S.$raise(n("ParseError")),V(S.need_suffix_number)&&S.$raise(n("ParseError")),u(["command","prefix"],{command:P["$[]"](1),prefix:P["$[]"](0)})},3),x(a,"$_reduce_6",function(P,ie,k){var S=this;return V(S.suffix_number)||S.$raise(n("ParseError")),V(S.need_prefix_number)&&S.$raise(n("ParseError")),u(["command","suffix"],{command:P["$[]"](0),suffix:P["$[]"](1)})},3),x(a,"$_reduce_7",function(P,ie,k){var S=this;return(V(S.need_prefix_number)||V(S.need_suffix_number))&&S.$raise(n("ParseError")),u(["command"],{command:P["$[]"](0)})},3),x(a,"$_reduce_8",function(P,ie,k){return u([],{})},3),x(a,"$_reduce_9",function(P,ie,k){var S,R,J,Z=e;return Z=null==(S=N(P))[0]?e:S[0],R=null==S[2]?e:S[2],V(this.critical)&&V(Z["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),A(Z,"[]=",L(J=["critical",R])),Q(J.length,1),Z},3),x(a,"$_reduce_10",function(P,ie,k){var S,R,J,Z=e;return Z=null==(S=N(P))[0]?e:S[0],R=null==S[2]?e:S[2],V(this.fumble)&&V(Z["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),A(Z,"[]=",L(J=["fumble",R])),Q(J.length,1),Z},3),x(a,"$_reduce_11",function(P,ie,k){var S,R,J,Z=e;return Z=null==(S=N(P))[0]?e:S[0],R=null==S[2]?e:S[2],V(this.dollar)&&V(Z["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),A(Z,"[]=",L(J=["dollar",R])),Q(J.length,1),Z},3),x(a,"$_reduce_12",function(P,ie,k){return P["$[]"](1)},3),x(a,"$_reduce_13",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"Negative").$new(P["$[]"](1))},3),x(a,"$_reduce_14",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"+",P["$[]"](2))},3),x(a,"$_reduce_15",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"-",P["$[]"](2))},3),x(a,"$_reduce_16",function(P,ie,k){return V(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),u([],{})},3),x(a,"$_reduce_17",function(P,ie,k){var S,Z,o;return o=null==(S=N(P))[1]?e:S[1],V(this.allowed_cmp_op["$include?"](Z=null==S[0]?e:S[0]))||this.$raise(n("ParseError")),u(["cmp_op","target"],{cmp_op:Z,target:o})},3),x(a,"$_reduce_18",function(P,ie,k){var ee,S=this;return ee=P["$[]"](0),V(S.question_target)||S.$raise(n("ParseError")),V(S.allowed_cmp_op["$include?"](ee))||S.$raise(n("ParseError")),u(["cmp_op","target"],{cmp_op:ee,target:"?"})},3),x(a,"$_reduce_19",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"+",P["$[]"](2))},3),x(a,"$_reduce_20",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"-",P["$[]"](2))},3),x(a,"$_reduce_22",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(P["$[]"](0),"*",P["$[]"](2))},3),x(a,"$_reduce_23",function(P,ie,k){return P["$[]"](3).$new(P["$[]"](0),P["$[]"](2))},3),x(a,"$_reduce_25",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),x(a,"$_reduce_26",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(a,"$_reduce_27",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(a,"$_reduce_28",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"DivideWithRound")},3),x(a,"$_reduce_29",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"DivideWithFloor")},3),x(a,"$_reduce_30",function(P,ie,k){return P["$[]"](1)},3),x(a,"$_reduce_31",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"Negative").$new(P["$[]"](1))},3),x(a,"$_reduce_33",function(P,ie,k){return P["$[]"](1)},3),x(a,"$_reduce_34",function(P,ie,k){return g(g(n("Arithmetic"),"Node"),"Number").$new(P["$[]"](0))},3),x(a,"$_reduce_none",function(P,ie,k){return P["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var B,L,X,V,N,d,F,x,K=[],i=r.nil,t=r.module,e=r.send,g=r.eqeqeq,E=r.truthy,G=r.def;return B=K,L=x=[t(K[0],"BCDice")].concat(B),X=F=[t(x[0],"Deprecated")].concat(L),N=[V=t(F[0],"Checker")].concat(X),d=r.$r(N),V.$private(),G(V,"$check_result_legacy",function(z,W,H,b){var s,h=this,y=i,T=i,m=i,f=i;return y=e(W,"map",[],"sides".$to_proc()),s=(T=e(W,"map",[],"value".$to_proc())).$sum(),m=g([100],f=y)?h.$check_1D100(z,s,H,b):g([20],f)?h.$check_1D20(z,s,H,b):g([6,6],f)?h.$check_2D6(z,s,T,H,b):i,(E(m["$nil?"]())||E(m["$empty?"]()))&&(m=g([10],f=y.$uniq())?h.$check_nD10(z,s,T,H,b):g([6],f)?h.$check_nD6(z,s,T,H,b):i,E(m["$nil?"]())||E(m["$empty?"]()))?i:d("Result").$new(m.$delete_prefix(" \uff1e "))},4),G(V,"$check_1D100",function(z,W,H,b){return i},4),G(V,"$check_1D20",function(z,W,H,b){return i},4),G(V,"$check_nD10",function(z,W,H,b,h){return i},5),G(V,"$check_2D6",function(z,W,H,b,h){return i},5),G(V,"$check_nD6",function(z,W,H,b,h){return i},5)},Opal.modules["bcdice/base"]=function(r){var W,T,_,$,v,s,m,f,a,b,K=r.top,i=[],t=r.$r(i),e=r.nil,g=r.$$$,E=r.module,G=r.klass,u=r.truthy,B=r.def,I=r.regexp,x=r.rb_plus,A=r.send,L=r.to_a,Q=r.rb_minus,F=r.eqeqeq,j=r.eqeq,X=r.range,V=r.rb_divide,N=r.rb_times,d=r.rb_ge,l=e;return K.$require("i18n"),K.$require("i18n/backend/fallbacks"),K.$require("bcdice/randomizer"),K.$require("bcdice/dice_table"),K.$require("bcdice/enum"),K.$require("bcdice/translate"),K.$require("bcdice/result"),K.$require("bcdice/command/parser"),K.$require("bcdice/deprecated/checker"),W=i,T=b=[E(i[0],"BCDice")].concat(W),m=[s=G(b[0],null,"Base")].concat(T),f=r.$r(m),(a=s.$$prototype).sort_add_dice=a.sort_barabara_dice=a.enabled_d9=a.raw_input=a.randomizer=a.enabled_upcase_input=a.debug=e,$=[_=r.get_singleton_class(s)].concat(m),v=r.$r($),_.$attr_reader("prefixes"),B(_,"$register_prefix",function(w){var M,re=this,c=e;return null==re.prefixes&&(re.prefixes=e),M=r.slice.call(arguments),re.prefixes=u(c=re.prefixes)?c:[],re.prefixes.$concat(M.$flatten())},-1),B(_,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),B(_,"$prefixes_pattern",function(){var w=this,q=e;return null==w.prefixes_pattern&&(w.prefixes_pattern=e),null==w.prefixes&&(w.prefixes=e),w.prefixes_pattern=u(q=w.prefixes_pattern)?q:e,u(w.prefixes_pattern)?w.prefixes_pattern:(w.prefixes=u(q=w.prefixes)?q:[],w.prefixes.$freeze(),w.prefixes_pattern=(u(w.prefixes["$empty?"]())?/(?!)/:I(["^(S)?(",w.prefixes.$join("|"),")"],"i")).$freeze())},0),B(_,"$command_pattern",function(){var w=this,q=e,M=e;return null==w.command_pattern&&(w.command_pattern=e),null==w.prefixes&&(w.prefixes=e),w.command_pattern=u(q=w.command_pattern)?q:e,u(w.command_pattern)?w.command_pattern:(w.prefixes=u(q=w.prefixes)?q:[],w.prefixes.$freeze(),M=x(A(g(v("CommonCommand"),"COMMANDS"),"map",[],function(c){return null==c&&(c=e),g(c,"PREFIX_PATTERN").$source()},1),w.prefixes),w.command_pattern=I(["^S?(",M.$join("|"),")"],"i").$freeze())},0),B(_,"$eval",function(w){return this.$new(w).$eval()},1),s.$include(f("Translate")),s.$include(g(f("Deprecated"),"Checker")),B(s,"$initialize",function(n){var $=this;return $.raw_input=n,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=g(f("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=g(f("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=e,$.reroll_dice_reroll_threshold=e,$.default_cmp_op=e,$.default_target_number=e,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=g(f("BCDice"),"Randomizer").$new(),$.debug=!1},1),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),B(s,"$sort_add_dice?",function(){return this.sort_add_dice},0),B(s,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),B(s,"$enabled_d9?",function(){return this.enabled_d9},0),B(s,"$enable_debug",function(){return this.debug=!0},0),B(s,"$eval",function(){var $,v,p,n=this,w=e;return $=g(f("BCDice"),"Preprocessor").$process(n.raw_input,n),v=u(p=n.$dice_command($))?p:n.$eval_common_command(n.raw_input),u(v)?(w=[n.randomizer.$rand_results()],A(v,"rands=",L(w)),Q(w.length,1),w=[n.randomizer.$detailed_rand_results()],A(v,"detailed_rands=",L(w)),Q(w.length,1),v):e},0),B(s,"$change_text",function(n){return n},1),B(s,"$check_result",function(n,$,v,p){var w=this,q=e,M=e,re=e,c=e,ne=e;return q=w.$check_result_legacy(n,$,v,p),u(q)?q:(M=A($,"map",[],"sides".$to_proc()),c=(re=A($,"map",[],"value".$to_proc())).$sum(),q=F([100],ne=M)?w.$result_1d100(n,c,v,p):F([20],ne)?w.$result_1d20(n,c,v,p):F([6,6],ne)?w.$result_2d6(n,c,re,v,p):e,j(q,f("Result").$nothing())?e:u(q)?q:(q=F([10],ne=M.$uniq())?w.$result_nd10(n,c,re,v,p):F([6],ne)?w.$result_nd6(n,c,re,v,p):e,j(q,f("Result").$nothing())?e:u(q)?q:w.$result_ndx(n,v,p)))},4),B(s,"$grich_text",function(n,$,v){return e},3),s.$private(),B(s,"$eval_common_command",function(n){try{return n=this.$change_text(n),A(g(f("CommonCommand"),"COMMANDS"),"each",[],function v(p){var q,w=null==v.$$s?this:v.$$s;if(null==w.randomizer&&(w.randomizer=e),null==p&&(p=e),q=p.$eval(n,w,w.randomizer),!u(q))return e;r.ret(q)},{$$arity:1,$$s:this}),e}catch(v){if(v===r.returner)return v.$v;throw v}},1),B(s,"$dice_command",function(n){var $=this,v=e,p=e,w=e,q=e,M=e;return u($.enabled_upcase_input)&&(n=n.$upcase()),v=$.$class().$prefixes_pattern().$match(n),u(v)?(p=v["$[]"](1)["$nil?"]()["$!"](),u(p)&&(n=n["$[]"](X(1,-1,!1))),w=$.$eval_game_system_specific_command(n),u(w["$is_a?"](f("Result")))?(q=[u(M=w["$secret?"]())?M:p],A(w,"secret=",L(q)),Q(q.length,1),w):u(w["$nil?"]())||u(w["$empty?"]())||j(w,"1")?e:A(f("Result").$new(),"tap",[],function(c){return null==c&&(c=e),q=[w.$to_s()],A(c,"text=",L(q)),Q(q.length,1),A(c,"secret=",L(q=[p])),q[Q(q.length,1)]},1)):e},1),B(s,"$eval_game_system_specific_command",function(n){return e},1),B(s,"$result_ndx",function(n,$,v){return u(v["$is_a?"](f("String")))?e:u(n.$send($,v))?f("Result").$success(this.$translate("success")):f("Result").$failure(this.$translate("failure"))},3),B(s,"$result_1d100",function(n,$,v,p){return e},4),B(s,"$result_1d20",function(n,$,v,p){return e},4),B(s,"$result_nd10",function(n,$,v,p,w){return e},5),B(s,"$result_2d6",function(n,$,v,p,w){return e},5),B(s,"$result_nd6",function(n,$,v,p,w){return e},5),B(s,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),B(s,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),B(s,"$get_table_by_nD6",function(n,$){return this.$get_table_by_nDx(n,$,6)},2),B(s,"$get_table_by_nDx",function(n,$,v){var w,q=e;return w=this.randomizer.$roll_sum($,v),q=this.$get_table_value(n["$[]"](Q(w,$))),u(q["$nil?"]())?["1",0]:[q,w]},3),B(s,"$get_table_by_1d3",function(n){var p,w,$=this,q=e;return $.$debug("get_table_by_1d3"),p=$.randomizer.$roll_sum(1,6),$.$debug("num",p),w=V(Q(p,1),2).$to_i(),$.$debug("index",w),q=n["$[]"](w),u(q["$nil?"]())?["1",0]:[q,p]},1),B(s,"$get_table_by_d66_swap",function(n){var v;return v=this.randomizer.$roll_d66(g(f("D66SortType"),"ASC")),[this.$get_table_by_number(v,n),v]},1),B(s,"$get_table_by_d66",function(n){var v,p,w,M,q=e;return v=this.randomizer.$roll_once(6),p=this.randomizer.$roll_once(6),w=x(N(Q(v,1),6),Q(p,1)),q=n["$[]"](w),M=""+v+p,u(q["$nil?"]())?["1",M]:[q,M]},1),B(s,"$get_table_by_number",function(n,$,v){try{return null==v&&(v="1"),A($,"each",[],function w(q){var re,M=null==w.$$s?this:w.$$s;if(null==q&&(q=e),re=q["$[]"](0),!u(d(re,n)))return e;r.ret(M.$get_table_value(q["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(v)}catch(w){if(w===r.returner)return w.$v;throw w}},-3),B(s,"$get_table_value",function(n){return u(n["$is_a?"](f("Proc")))?n.$call():n},1),B(s,"$roll_tables",function(n,$){var p=e;return p=$["$[]"](n),u(p)?p.$roll(this.randomizer).$to_s():e},2),B(s,"$debug",function(n,$){var p,w=this,q=e,M=e;return p=r.slice.call(arguments,1),u(w.debug)?(q=u(n["$is_a?"](f("String")))?n:n.$inspect(),u(p["$empty?"]())?w.$warn(q):(M=A(p,"map",[],function(c){return null==c&&(c=e),u(c["$is_a?"](f("String")))?'"'+c+'"':c.$inspect()},1),w.$warn(q+": "+M.$join(", ")))):e},-2),g(g(t("I18n"),"Backend"),"Simple").$include(g(g(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),l=["ja_jp"],A(t("I18n"),"default_locale=",L(l)),Q(l.length,1),l=[["ja_jp"]],A(t("I18n").$fallbacks(),"defaults=",L(l)),l[Q(l.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(r){var A,j,z,y,T,s,m,H,V,N,Q,i=[],t=r.nil,e=r.module,g=r.klass,E=r.const_set,G=r.hash2,u=r.truthy,B=r.send,I=r.def;return r.top.$require("strscan"),A=i,j=Q=[e(i[0],"BCDice")].concat(A),V=[e(Q[0],"GameSystem")].concat(j),N=r.$r(V),z=V,y=H=[g(V[0],N("Base"),"SwordWorld")].concat(z),s=[T=g(H[0],null,"RatingLexer")].concat(y),m=r.$r(s),T.$$prototype.scanner=t,E(s[0],"SYMBOLS",G(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),I(T,"$initialize",function(_){var n,$,p;return _=u(p=($=(n=_)===t||null==n?t:B(n,"split",[" ",2]))===t||null==$?t:B($,"first",[]))?p:"",this.scanner=m("StringScanner").$new(_)},1),I(T,"$next_token",function(){var _=this,n=t,$=t,p=t;return u(_.scanner["$eos?"]())?[!1,"$"]:u(n=_.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:($=_.scanner.$getch().$upcase(),[u(p=m("SYMBOLS")["$[]"]($))?p:$.$to_sym(),$])},0),I(T,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(r){var L,X,W,T,s,m,f,a,b,N,d,F,K=[],i=r.nil,t=r.module,e=r.klass,g=r.def,E=r.truthy,G=r.rb_lt,u=r.rb_plus,B=r.eqeq,I=r.rb_gt,x=r.neqeq;return L=K,X=F=[t(K[0],"BCDice")].concat(L),N=[t(F[0],"GameSystem")].concat(X),d=r.$r(N),W=N,T=b=[e(N[0],d("Base"),"SwordWorld")].concat(W),m=[s=e(b[0],null,"RatingParsed")].concat(T),f=r.$r(m),(a=s.$$prototype).modifier_after_half=a.critical=a.semi_fixed_val=a.kept_modify=a.first_modify=a.first_to=a.rateup=a.tmp_fixed_val=a.rate=a.greatest_fortune=a.modifier=i,s.$attr_accessor("rate"),s.$attr_writer("critical"),s.$attr_writer("kept_modify"),s.$attr_writer("first_to"),s.$attr_writer("first_modify"),s.$attr_writer("rateup"),s.$attr_accessor("greatest_fortune"),s.$attr_writer("semi_fixed_val"),s.$attr_writer("tmp_fixed_val"),s.$attr_accessor("modifier"),s.$attr_writer("modifier_after_half"),g(s,"$initialize",function(){var n=this;return n.critical=i,n.min_critical=i,n.kept_modify=i,n.first_to=i,n.first_modify=i,n.greatest_fortune=!1,n.rateup=i,n.semi_fixed_val=i,n.tmp_fixed_val=i},0),g(s,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()},0),g(s,"$critical",function(){var $;return E($=this.critical)?$:E(this.$half())?13:10},0),g(s,"$min_critical",function(){var n=this,$=i;return $=3,E(n.semi_fixed_val["$nil?"]())||(E(n.kept_modify["$nil?"]())?E(G($,u(n.semi_fixed_val,2)))&&($=u(n.semi_fixed_val,2)):E(G($,u(u(n.semi_fixed_val,n.kept_modify),2)))&&($=u(u(n.semi_fixed_val,n.kept_modify),2)),B(n.semi_fixed_val,1)&&($=3)),E(I($,13))&&($=13),$},0),g(s,"$first_modify",function(){var $;return E($=this.first_modify)?$:0},0),g(s,"$first_to",function(){var $;return E($=this.first_to)?$:0},0),g(s,"$rateup",function(){var $;return E($=this.rateup)?$:0},0),g(s,"$semi_fixed_val",function(){var v,$=i;return $=E(v=this.semi_fixed_val)?v:0,E(I($,6))&&($=6),$},0),g(s,"$tmp_fixed_val",function(){var v,$=i;return $=E(v=this.tmp_fixed_val)?v:0,E(I($,6))&&($=6),$},0),g(s,"$kept_modify",function(){var $;return E($=this.kept_modify)?$:0},0),g(s,"$modifier_after_half",function(){var $;return E($=this.modifier_after_half)?$:0},0),g(s,"$to_s",function(){var n=this,$=i;return $="KeyNo."+n.rate,E(G(n.$critical(),13))&&($=u($,"c["+n.$critical()+"]")),x(n.$first_modify(),0)&&($=u($,"m["+f("Format").$modifier(n.$first_modify())+"]")),x(n.$first_to(),0)&&($=u($,"m["+n.$first_to()+"]")),x(n.$rateup(),0)&&($=u($,"r["+n.$rateup()+"]")),E(n.greatest_fortune)&&($=u($,"gf")),x(n.$semi_fixed_val(),0)&&($=u($,"sf["+n.$semi_fixed_val()+"]")),x(n.$tmp_fixed_val(),0)&&($=u($,"tf["+n.$tmp_fixed_val()+"]")),x(n.$kept_modify(),0)&&($=u($,"a["+f("Format").$modifier(n.$kept_modify())+"]")),x(n.modifier,0)&&($=u($,f("Format").$modifier(n.modifier))),$},0),g(s,"$infinite_roll?",function(){return G(this.$critical(),this.$min_critical())},0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(r){var d,H,m,v,M,re,c,ne,D,te,le,_e,oe,P,p,w,q,S,a,_,h,y,z,K=r.top,i=[],t=r.nil,e=r.$$$,g=r.module,E=r.klass,G=r.hash2,u=r.send2,B=r.find_super,I=r.def,x=r.send,A=r.to_a,L=r.rb_minus,Q=r.hash,F=r.const_set,j=r.to_ary,X=r.truthy,V=r.eqeq;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/enum"),K.$require("bcdice/game_system/sword_world/rating_lexer"),K.$require("bcdice/game_system/sword_world/rating_parsed"),d=i,H=z=[g(i[0],"BCDice")].concat(d),h=[g(z[0],"GameSystem")].concat(H),y=r.$r(h),m=h,a=[E(h[0],y("Base"),"SwordWorld")].concat(m),_=r.$r(a),v=a,w=[p=E(a[0],e(_("Racc"),"Parser"),"RatingParser")].concat(v),q=r.$r(w),(S=p.$$prototype).lexer=S.version=t,I(p,"$initialize",function ee(C){var Z,o,J=this;if(delete ee.$$p,null==C)C=G([],{});else if(!C.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(Z=C.$$smap.version)&&(Z="v1_0"),null==(o=C.$$smap.round_type)&&(o=e(q("RoundType"),"CEIL")),u(J,B(J,"initialize",ee,!1,!0),"initialize",[],null),J.version=Z,J.round_type=o},-1),I(p,"$set_debug",function(){return this.yydebug=!0,this},0),I(p,"$parse",function(C){try{return this.lexer=q("RatingLexer").$new(C),this.$do_parse()}catch(o){if(!r.rescue(o,[q("ParseError"),q("ZeroDivisionError")]))throw o;try{return t}finally{r.pop_exception()}}},1),p.$private(),I(p,"$parsed",function(C,Z,o){return x(q("RatingParsed").$new(),"tap",[],function J(se){var O,ae,Y,U,fe=null==J.$$s?this:J.$$s,ce=t;return null==fe.round_type&&(fe.round_type=t),null==se&&(se=t),x(se,"rate=",A(ce=[C])),L(ce.length,1),ce=[(O=o["$[]"]("critical"),O===t||null==O?t:x(O,"eval",[fe.round_type]))],x(se,"critical=",A(ce)),L(ce.length,1),ce=[(ae=o["$[]"]("kept_modify"),ae===t||null==ae?t:x(ae,"eval",[fe.round_type]))],x(se,"kept_modify=",A(ce)),L(ce.length,1),ce=[o["$[]"]("first_to")],x(se,"first_to=",A(ce)),L(ce.length,1),ce=[o["$[]"]("first_modify")],x(se,"first_modify=",A(ce)),L(ce.length,1),ce=[(Y=o["$[]"]("rateup"),Y===t||null==Y?t:x(Y,"eval",[fe.round_type]))],x(se,"rateup=",A(ce)),L(ce.length,1),ce=[o.$fetch("greatest_fortune",!1)],x(se,"greatest_fortune=",A(ce)),L(ce.length,1),ce=[o["$[]"]("semi_fixed_val")],x(se,"semi_fixed_val=",A(ce)),L(ce.length,1),ce=[o["$[]"]("tmp_fixed_val")],x(se,"tmp_fixed_val=",A(ce)),L(ce.length,1),ce=[Z.$eval(fe.round_type)],x(se,"modifier=",A(ce)),L(ce.length,1),ce=[(U=o["$[]"]("modifier_after_half"),U===t||null==U?t:x(U,"eval",[fe.round_type]))],x(se,"modifier_after_half=",A(ce)),ce[L(ce.length,1)]},{$$arity:1,$$s:this})},3),I(p,"$next_token",function(){return this.lexer.$next_token()},0),M=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],re=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],c=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],ne=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],D=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],te=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],le=[t,5,11,0,t,-11,-11,-23,t],_e=[t,t,t,t,10,42,t,t,28],oe=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],P=Q(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),F(w[0],"Racc_arg",[M,re,ne,c,D,te,_e,le,21,oe,P,64,33,!0]),F(w[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),F(w[0],"Racc_debug_parser",!1),I(p,"$_reduce_1",function(C,Z,o){var R,O,Y,U,ae=t;return O=null==(R=j(C))[0]?t:R[0],Y=X(U=(ae=null==R[1]?t:R[1])["$[]"]("modifier"))?U:e(e(q("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(O,Y,ae)},3),I(p,"$_reduce_2",function(C,Z,o){var R,ae,U,ce,Y=t,fe=t;return ae=null==(R=j(C))[1]?t:R[1],X((Y=null==R[2]?t:R[2])["$[]"]("modifier_after_half"))||(fe=["modifier_after_half",e(e(q("Arithmetic"),"Node"),"Number").$new(0)],x(Y,"[]=",A(fe)),L(fe.length,1)),ce=X(U=Y["$[]"]("modifier"))?U:e(e(q("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ae,ce,Y)},3),I(p,"$_reduce_3",function(C,Z,o){return C["$[]"](1).$to_i()},3),I(p,"$_reduce_4",function(C,Z,o){return G([],{})},3),I(p,"$_reduce_5",function(C,Z,o){var R,ae,Y,O=t;return ae=null==(R=j(C))[1]?t:R[1],X((O=null==R[0]?t:R[0])["$[]"]("modifier")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(Y=["modifier",ae])),L(Y.length,1),O},3),I(p,"$_reduce_6",function(C,Z,o){var R,Y,U,O=t;return Y=null==(R=j(C))[2]?t:R[2],X((O=null==R[0]?t:R[0])["$[]"]("critical")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(U=["critical",Y])),L(U.length,1),O},3),I(p,"$_reduce_7",function(C,Z,o){var R,Y,U,O=t;return Y=null==(R=j(C))[2]?t:R[2],X((O=null==R[0]?t:R[0])["$[]"]("critical")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(U=["critical",Y])),L(U.length,1),O},3),I(p,"$_reduce_8",function(C,Z,o){var R,U,O=t,Y=t;return Y=null==(R=j(C))[2]?t:R[2],X((O=null==R[0]?t:R[0])["$[]"]("first_to")["$nil?"]())&&X(O["$[]"]("first_modify")["$nil?"]())||this.$raise(q("ParseError")),U=["first_to",Y.$to_i()],x(O,"[]=",A(U)),L(U.length,1),O},3),I(p,"$_reduce_9",function(C,Z,o){var R,U,O=t,Y=t;return Y=null==(R=j(C))[3]?t:R[3],X((O=null==R[0]?t:R[0])["$[]"]("first_to")["$nil?"]())&&X(O["$[]"]("first_modify")["$nil?"]())||this.$raise(q("ParseError")),U=["first_modify",Y.$to_i()],x(O,"[]=",A(U)),L(U.length,1),O},3),I(p,"$_reduce_10",function(C,Z,o){var R,U,O=t,Y=t;return Y=null==(R=j(C))[3]?t:R[3],X((O=null==R[0]?t:R[0])["$[]"]("first_to")["$nil?"]())&&X(O["$[]"]("first_modify")["$nil?"]())||this.$raise(q("ParseError")),U=["first_modify",Y.$to_i()["$-@"]()],x(O,"[]=",A(U)),L(U.length,1),O},3),I(p,"$_reduce_11",function(C,Z,o){var R,Y,O=t;return R=j(C),X((O=null==R[0]?t:R[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(q("ParseError")),Y=["modifier_after_half",e(e(q("Arithmetic"),"Node"),"Number").$new(0)],x(O,"[]=",A(Y)),L(Y.length,1),O},3),I(p,"$_reduce_12",function(C,Z,o){var R,Y,U,O=t;return Y=null==(R=j(C))[2]?t:R[2],X((O=null==R[0]?t:R[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(U=["modifier_after_half",Y])),L(U.length,1),O},3),I(p,"$_reduce_13",function(C,Z,o){var R,Y,U,O=t;return O=null==(R=j(C))[0]?t:R[0],Y=null==R[2]?t:R[2],X(["v2_5","v2_0"]["$include?"](this.version))&&X(O["$[]"]("rateup")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(U=["rateup",Y])),L(U.length,1),O},3),I(p,"$_reduce_14",function(C,Z,o){var R,Y,se=this,O=t;return O=null==(R=j(C))[0]?t:R[0],X(["v2_5","v2_0"]["$include?"](se.version))||se.$raise(q("ParseError")),X(O["$[]"]("greatest_fortune")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("semi_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("tmp_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),x(O,"[]=",A(Y=["greatest_fortune",!0])),L(Y.length,1),O},3),I(p,"$_reduce_15",function(C,Z,o){var R,U,se=this,O=t,Y=t;return O=null==(R=j(C))[0]?t:R[0],Y=null==R[3]?t:R[3],X(["v2_5","v2_0"]["$include?"](se.version))||se.$raise(q("ParseError")),X(O["$[]"]("greatest_fortune")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("semi_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("tmp_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),U=["semi_fixed_val",Y.$to_i()],x(O,"[]=",A(U)),L(U.length,1),O},3),I(p,"$_reduce_16",function(C,Z,o){var R,U,se=this,O=t,Y=t;return O=null==(R=j(C))[0]?t:R[0],Y=null==R[3]?t:R[3],X(["v2_5","v2_0"]["$include?"](se.version))||se.$raise(q("ParseError")),X(O["$[]"]("greatest_fortune")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("semi_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),X(O["$[]"]("tmp_fixed_val")["$nil?"]())||se.$raise(q("ParseError")),U=["tmp_fixed_val",Y.$to_i()],x(O,"[]=",A(U)),L(U.length,1),O},3),I(p,"$_reduce_17",function(C,Z,o){var R,Y,U,O=t;return O=null==(R=j(C))[0]?t:R[0],Y=null==R[2]?t:R[2],V(this.version,"v2_5")&&X(O["$[]"]("kept_modify")["$nil?"]())||this.$raise(q("ParseError")),x(O,"[]=",A(U=["kept_modify",Y])),L(U.length,1),O},3),I(p,"$_reduce_18",function(C,Z,o){return C["$[]"](1)},3),I(p,"$_reduce_19",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"Negative").$new(C["$[]"](1))},3),I(p,"$_reduce_20",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"+",C["$[]"](2))},3),I(p,"$_reduce_21",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"-",C["$[]"](2))},3),I(p,"$_reduce_22",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"+",C["$[]"](2))},3),I(p,"$_reduce_23",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"-",C["$[]"](2))},3),I(p,"$_reduce_25",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"BinaryOp").$new(C["$[]"](0),"*",C["$[]"](2))},3),I(p,"$_reduce_26",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(C["$[]"](0),C["$[]"](2))},3),I(p,"$_reduce_28",function(C,Z,o){return C["$[]"](1)},3),I(p,"$_reduce_29",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"Negative").$new(C["$[]"](1))},3),I(p,"$_reduce_31",function(C,Z,o){return C["$[]"](1)},3),I(p,"$_reduce_32",function(C,Z,o){return e(e(q("Arithmetic"),"Node"),"Number").$new(C["$[]"](0))},3),I(p,"$_reduce_none",function(C,Z,o){return C["$[]"](0)},3)},Opal.queue(function(r){var b,s,$,v,p,w,q,f,a,y,K=r.top,i=[],t=r.nil,e=r.module,g=r.klass,E=r.const_set,G=r.send2,u=r.find_super,B=r.def,I=r.truthy,x=r.rb_ge,A=r.rb_le,L=r.eqeq,Q=r.neqeq,F=r.rb_minus,j=r.rb_gt,X=r.send,V=r.to_ary,N=r.rb_plus,d=r.rb_lt,l=r.rb_times,z=r.to_a,W=r.rb_divide;return K.$require("bcdice/base"),K.$require("bcdice/game_system/sword_world/rating_parser"),b=i,s=y=[e(i[0],"BCDice")].concat(b),f=[e(y[0],"GameSystem")].concat(s),a=r.$r(f),$=f,p=[v=g(f[0],a("Base"),"SwordWorld")].concat($),w=r.$r(p),(q=v.$$prototype).rating_table=q.randomizer=t,E(p[0],"ID","SwordWorld"),E(p[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),E(p[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),E(p[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),v.$register_prefix("H?K"),B(v,"$initialize",function M(re){return delete M.$$p,G(this,u(this,"initialize",M,!1,!0),"initialize",[re],null),this.rating_table=0},1),B(v,"$result_2d6",function(re,c,ne,D,te){return I(x(c,12))?w("Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):I(A(c,2))?w("Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):Q(D,">=")||L(te,"?")?t:I(x(re,te))?w("Result").$success("\u6210\u529f"):w("Result").$failure("\u5931\u6557")},5),B(v,"$eval_game_system_specific_command",function(re){return this.$rating(re)},1),v.$private(),B(v,"$rating_parser",function(){return w("RatingParser").$new()},0),B(v,"$rating",function(re){var c,ne,D=this,te=t,le=t,_e=t,oe=t,ue=t,$e=t,P=t,ie=t,k=t,S=t,ee=t,C=t,Z=t,o=t,J=t,se=t;return D.$debug("rating string",re),te=D.$rating_parser().$parse(re),I(te)?(le=D.$getSW2_0_RatingTable(),_e=F(le.$length(),1),D.$debug("keyMax",_e),I(j(te.$rate(),_e))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+_e+"\u307e\u3067\u3067\u3059":I(te["$infinite_roll?"]())?w("Result").$new("C\u5024\u3092"+te.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(oe=D.$getNewRates(le),ue=te+" \uff1e ",$e=[],P=[],ie=[],k=0,S=0,ee=0,C=0,Z=te.$first_to(),o=te.$first_modify(),function(){var O=r.new_brk();try{X(D,"loop",[],function ae(){var Y,U,ve,de,fe=null==ae.$$s?this:ae.$$s,ce=t,me=t;if(U=fe.$rollDice(te,C),me=null==(Y=V(U))[1]?t:Y[1],k=ce=null==Y[0]?t:Y[0],Q(Z,0)?(k=ce=Z,Z=0):Q(o,0)&&(k=N(k,o),o=0),I(A(ce,2))&&($e["$<<"](ce.$to_s()),P["$<<"](me.$to_s()),ie["$<<"]("**"),C=N(C,1),r.brk(t,O)),Q(te.$kept_modify(),0)&&Q(k,2)&&(k=N(k,te.$kept_modify())),I(d(k,2))&&(k=2),I(j(k,12))&&(k=12),ve=[N(te.$rate(),l(C,te.$rateup())),_e].$min(),fe.$debug("currentKey",ve),de=oe["$[]"](k)["$[]"](ve),fe.$debug("rateValue",de),ee=N(ee,de),S=N(S,k),$e["$<<"](k.$to_s()),P["$<<"](me.$to_s()),ie["$<<"](I(j(k,2))?de:"**"),C=N(C,1),I(x(k,te.$critical())))return t;r.brk(t,O)},{$$arity:0,$$s:D,$$brk:O})}catch(ae){if(ae===O)return ae.$v;throw ae}}(),ne=D.$getResultText(ee,te,P,$e,ie,S,C),c=V(ne),J=null==c[1]?t:c[1],se=null==c[2]?t:c[2],ue=N(ue,null==c[0]?t:c[0]),X(w("Result").$new(),"tap",[],function(ae){var Y=t;return null==ae&&(ae=t),X(ae,"text=",z(Y=[ue])),F(Y.length,1),X(ae,"critical=",z(Y=[J])),F(Y.length,1),X(ae,"fumble=",z(Y=[se])),Y[F(Y.length,1)]},1))):(D.$debug("not matched"),"1")},1),B(v,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},0),B(v,"$getNewRates",function(re){var ne=t,D=t,te=t,le=t,_e=t,oe=t,ue=t,$e=t,P=t,ie=t,k=t,S=t;return ne=[],D=[],te=[],le=[],_e=[],oe=[],ue=[],$e=[],P=[],ie=[],k=[],X(re,"each",[],function(Z){var o=t;return null==Z&&(Z=t),o=Z.$split(/,/),k.$push(0),ne.$push(o["$[]"](1).$to_i()),D.$push(o["$[]"](2).$to_i()),te.$push(o["$[]"](3).$to_i()),le.$push(o["$[]"](4).$to_i()),_e.$push(o["$[]"](5).$to_i()),oe.$push(o["$[]"](6).$to_i()),ue.$push(o["$[]"](7).$to_i()),$e.$push(o["$[]"](8).$to_i()),P.$push(o["$[]"](9).$to_i()),ie.$push(o["$[]"](10).$to_i())},1),L(this.rating_table,1)&&(S=[31,(S=[32,(S=[33,10],X(ie,"[]=",z(S)),S[F(S.length,1)])],X(ie,"[]=",z(S)),S[F(S.length,1)])],X(ie,"[]=",z(S)),F(S.length,1)),[k,k,k,ne,D,te,le,_e,oe,ue,$e,P,ie]},1),B(v,"$rollDice",function(re,c){var D=t;return[(D=this.randomizer.$roll_barabara(2,6)).$sum(),D.$join(",")]},2),B(v,"$getResultText",function(re,c,ne,D,te,le,_e){var oe=t,ue=t,$e=t,P=t,ie=t;return(oe=[]).$push("2D:["+ne.$join(" ")+"]="+D.$join(",")),I(A(le,2))?(oe.$push(te.$join(",")),oe.$push("\u81ea\u52d5\u7684\u5931\u6557"),[oe.$join(" \uff1e "),!1,!0]):(I(j(te.$size(),1))||Q(c.$modifier(),0)?(ue=N(te.$join(","),w("Format").$modifier(c.$modifier())),I(c.$half())&&(ue="("+ue+")/2",Q(c.$modifier_after_half(),0)&&(ue=N(ue,w("Format").$modifier(c.$modifier_after_half())))),oe.$push(ue)):I(c.$half())&&(ue=te.$first()+"/2",Q(c.$modifier_after_half(),0)&&(ue=N(ue,w("Format").$modifier(c.$modifier_after_half()))),oe.$push(ue)),I(j(_e,1))&&($e=F(_e,1)+"\u56de\u8ee2",oe.$push($e)),P=N(re,c.$modifier()),I(c.$half())&&(P=W(P,2).$ceil(),Q(c.$modifier_after_half(),0)&&(P=N(P,c.$modifier_after_half()))),ie=P.$to_s(),oe.$push(ie),[oe.$join(" \uff1e "),j(_e,1),!1])},7)})}}]);