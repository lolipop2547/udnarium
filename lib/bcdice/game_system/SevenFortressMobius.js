(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1091],{2004:(V,X,Y)=>{Y(9993),Opal.modules["bcdice/normalize"]=function(i){var E,l,c,z=[],g=i.nil,t=i.module,b=i.eqeqeq,y=i.def,v=i.eqeq;return E=z,c=[t(z[0],"BCDice")].concat(E),(l=t(c[0],"Normalize")).$module_function(),y(l,"$comparison_operator",function(s){var u;return b(/<=|=</,u=s)?"<=":b(/>=|=>/,u)?">=":b(/<>|!=|=!/,u)?"!=":b(/</,u)?"<":b(/>/,u)?">":b(/=/,u)?"==":g},1),y(l,"$target_number",function(s){return v(s,"?")?s:s.$to_i()},1)},Opal.modules["bcdice/format"]=function(i){var c,s,u,f,F,l,z=[],g=i.nil,t=i.module,b=i.eqeqeq,y=i.def,v=i.truthy,N=i.eqeq,E=i.rb_gt;return c=z,s=l=[t(z[0],"BCDice")].concat(c),f=[u=t(l[0],"Format")].concat(s),F=i.$r(f),u.$module_function(),y(u,"$comparison_operator",function(h){var k;return b("==",k=h)?"=":b("!=",k)?"<>":b(F("Symbol"),k)?h.$to_s():g},1),y(u,"$modifier",function(h){return v(h["$nil?"]())?g:N(h,0)?"":v(E(h,0))?"+"+h:h.$to_s()},1)},Opal.modules["bcdice/game_system/NightWizard"]=function(i){var k,D,J,Q,U,n,q,w,x,R,T,B,P,z=i.top,g=[],t=i.nil,b=i.module,y=i.klass,v=i.const_set,N=i.send2,E=i.find_super,d=i.def,c=i.truthy,W=i.to_ary,l=i.rb_plus,M=i.regexp,s=i.send,u=i.to_a,f=i.rb_minus,F=i.eqeq,C=i.neqeq;return z.$require("bcdice/normalize"),z.$require("bcdice/format"),k=g,D=P=[b(g[0],"BCDice")].concat(k),T=[b(P[0],"GameSystem")].concat(D),B=i.$r(T),J=T[0],Q=B("Base"),U=T,w=[q=y(J,Q,"NightWizard")].concat(U),x=i.$r(w),(R=q.$$prototype).nw_command=R.randomizer=R.total=R.interim_expr=R.status=R.fumble_numbers=R.critical_numbers=t,v(w[0],"ID","NightWizard"),v(w[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),v(w[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),v(w[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),q.$register_prefix("([-+]?\\d+)?NW","2R6"),d(q,"$initialize",function p($){var r=this;return delete p.$$p,N(r,E(r,"initialize",p,!1,!0),"initialize",[$],null),r.nw_command="NW"},1),d(q,"$eval_game_system_specific_command",function($){var n,r,_,a=this,e=t,o=t,m=t,j=t,S=t;return e=c(_=a.$parse_nw($))?_:a.$parse_2r6($),c(e)?(r=a.$roll_nw(e),o=null==(n=W(r))[0]?t:n[0],m=null==n[1]?t:n[1],j=null==n[2]?t:n[2],S=c(e.$cmp_op())?c(o.$send(e.$cmp_op(),e.$target_number()))?"\u6210\u529f":"\u5931\u6557":t,["("+e+")",m,j,o.$to_s(),S].$compact().$join(" \uff1e ")):t},1),q.$private(),(n=y(w[0],null,"Parsed")).$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number"),function(p,$,n){var r=y(p,$,"ParsedNW"),a=[r].concat(n),e=i.$r(a),_=r.$$prototype;_.base=_.modify_number=_.active_modify_number=_.prana=_.command=_.critical_numbers=_.fumble_numbers=_.cmp_op=_.target_number=t,r.$attr_accessor("base"),r.$attr_accessor("modify_number"),d(r,"$initialize",function o(m){var S=this;return delete o.$$p,N(S,E(S,"initialize",o,!1,!0),"initialize",[],null),S.command=m},1),d(r,"$passive_modify_number",function(){return l(this.base,this.modify_number)},0),d(r,"$to_s",function(){var j,S,G,K,L,m=this;return j=c(m.base["$zero?"]())?t:m.base,S=e("Format").$modifier(m.modify_number),G=e("Format").$modifier(m.active_modify_number),K=c(L=m.prana)?"$"+m.prana:L,""+j+m.command+S+"@"+m.critical_numbers.$join(",")+"#"+m.fumble_numbers.$join(",")+K+G+m.cmp_op+m.target_number},0)}(w[0],x("Parsed"),w),function(p,$){var n=y(p,$,"Parsed2R6"),r=n.$$prototype;r.passive_modify_number=r.active_modify_number=r.critical_numbers=r.fumble_numbers=r.cmp_op=r.target_number=t,n.$attr_accessor("passive_modify_number"),d(n,"$to_s",function(){var e=this;return"2R6M["+e.passive_modify_number+","+e.active_modify_number+"]C["+e.critical_numbers.$join(",")+"]F["+e.fumble_numbers.$join(",")+"]"+e.cmp_op+e.target_number},0)}(w[0],x("Parsed")),d(q,"$parse_nw",function($){var n,r,e=t,_=t,o=t;return e=M(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match($),c(e)?(_=x("ParsedNW").$new(this.nw_command),o=[e["$[]"](1).$to_i()],s(_,"base=",u(o)),f(o.length,1),o=[x("ArithmeticEvaluator").$eval(e["$[]"](2))],s(_,"modify_number=",u(o)),f(o.length,1),o=[c(e["$[]"](3))?s(e["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],s(_,"critical_numbers=",u(o)),f(o.length,1),o=[c(e["$[]"](4))?s(e["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],s(_,"fumble_numbers=",u(o)),f(o.length,1),o=[(n=e["$[]"](5),n===t||null==n?t:s(n,"to_i",[]))],s(_,"prana=",u(o)),f(o.length,1),o=[x("ArithmeticEvaluator").$eval(e["$[]"](6))],s(_,"active_modify_number=",u(o)),f(o.length,1),o=[x("Normalize").$comparison_operator(e["$[]"](7))],s(_,"cmp_op=",u(o)),f(o.length,1),o=[(r=e["$[]"](8),r===t||null==r?t:s(r,"to_i",[]))],s(_,"target_number=",u(o)),f(o.length,1),_):t},1),d(q,"$parse_2r6",function($){var n,r=t,a=t,e=t;return r=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match($),c(r)?(a=x("Parsed2R6").$new(),e=[x("ArithmeticEvaluator").$eval(r["$[]"](1))],s(a,"passive_modify_number=",u(e)),f(e.length,1),e=[x("ArithmeticEvaluator").$eval(r["$[]"](2))],s(a,"active_modify_number=",u(e)),f(e.length,1),e=[c(r["$[]"](3))?s(r["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],s(a,"critical_numbers=",u(e)),f(e.length,1),e=[c(r["$[]"](4))?s(r["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],s(a,"fumble_numbers=",u(e)),f(e.length,1),e=[x("Normalize").$comparison_operator(r["$[]"](5))],s(a,"cmp_op=",u(e)),f(e.length,1),e=[(n=r["$[]"](6),n===t||null==n?t:s(n,"to_i",[]))],s(a,"target_number=",u(e)),f(e.length,1),a):t},1),d(q,"$roll_nw",function($){var r=this,a=t,e=t,_=t,o=t,m=t;for(r.critical_numbers=$.$critical_numbers(),r.fumble_numbers=$.$fumble_numbers(),r.total=0,r.interim_expr="",r.status=t,a=r.$roll_once_first();F(a,"critical");)a=r.$roll_once();return C(a,"fumble")&&c($.$prana())&&(_=(e=r.randomizer.$roll_barabara($.$prana(),6)).$sum(),o=e.$join(","),r.total=l(r.total,_),r.interim_expr=l(r.interim_expr,"+"+_+"["+o+"]")),m=F(a,"fumble")?r.$fumble_base_number($):l($.$passive_modify_number(),$.$active_modify_number()),r.total=l(r.total,m),r.interim_expr=l(m.$to_s(),r.interim_expr),[r.total,r.interim_expr,r.status]},1),d(q,"$roll_once",function($){var a,e,n=this,r=t;return null==$&&($=!1),a=(r=n.randomizer.$roll_barabara(2,6)).$sum(),e=r.$join(","),c($)&&c(n.fumble_numbers["$include?"](a))?(n.total=f(n.total,10),n.interim_expr=l(n.interim_expr,"-10["+e+"]"),n.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):c(n.critical_numbers["$include?"](a))?(n.total=l(n.total,10),n.interim_expr=l(n.interim_expr,"+10["+e+"]"),n.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(n.total=l(n.total,a),n.interim_expr=l(n.interim_expr,"+"+a+"["+e+"]"),t)},-1),d(q,"$roll_once_first",function(){return this.$roll_once(!0)},0),d(q,"$fumble_base_number",function($){return $.$passive_modify_number()},1)},Opal.queue(function(i){var W,u,H,P,A,F,C,M,g=[],b=i.module,y=i.klass,v=i.const_set,N=i.send2,E=i.find_super,d=i.def;return i.top.$require("bcdice/game_system/NightWizard"),W=g,u=M=[b(g[0],"BCDice")].concat(W),F=[b(M[0],"GameSystem")].concat(u),C=i.$r(F),H=F,v((A=[P=y(F[0],C("NightWizard"),"SevenFortressMobius")].concat(H))[0],"ID","SevenFortressMobius"),v(A[0],"NAME","\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9"),v(A[0],"SORT_KEY","\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059"),v(A[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(nSFM+m@x#y)\n\u3000"(\u57fa\u672c\u5024)SFM(\u5e38\u6642\u304a\u3088\u3073\u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u7b49\u53ca\u3073\u72b6\u614b\u7570\u5e38\uff08\u7701\u7565\u53ef\uff09)@(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)#(\u30d5\u30a1\u30f3\u30d6\u30eb\u5024)\uff08\u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u7b49\u53ca\u3073\u5473\u65b9\u306e\u652f\u63f4\u52b9\u679c\u7b49\u306e\u5f71\u97ff\uff08\u7701\u7565\u53ef\uff09\uff09"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000R\u30b3\u30de\u30f3\u30c9(2R6m[n,m]c[x]f[y]>=t t\u306f\u76ee\u6a19\u5024)\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912SFM-5@7#2\u3000\u30001SFM\u3000\u300050SFM+5@7,10#2,5\u300050SFM-5+10@7,10#2,5+15+25\n'),P.$register_prefix("([-+]?\\d+)?SFM","2R6"),d(P,"$initialize",function D(I){var B=this;return delete D.$$p,N(B,E(B,"initialize",D,!1,!0),"initialize",[I],null),B.nw_command="SFM"},1)})}}]);