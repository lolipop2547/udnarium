(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4788],{817:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var U,s,L,N,C,o,M=[],t=r.nil,m=r.$$$,e=r.module,p=r.class_variable_set,w=r.truthy,A=r.class_variable_get,a=r.def,P=r.send,K=r.to_a,E=r.rb_minus,S=r.send2,F=r.find_super,H=r.hash2,B=r.find_block_super,G=r.neqeq;return U=M,o=[C=e(M[0],"I18n")].concat(U),p(o[0],"@@fallbacks",t),s=r.get_singleton_class(C),L=[s].concat(o),N=r.$r(L),a(s,"$fallbacks",function(){var h=t;return p(L[1],"@@fallbacks",w(null!=L[1].$$cvars["@@fallbacks"]?"class variable":t)&&w(h=A(L[1],"@@fallbacks",!1))?h:m(m(N("I18n"),"Locale"),"Fallbacks").$new()),w(h=N("Thread").$current()["$[]"]("i18n_fallbacks"))?h:A(L[1],"@@fallbacks",!1)},0),a(s,"$fallbacks=",function(v){var h;return p(L[1],"@@fallbacks",w(v["$is_a?"](N("Array")))?m(m(N("I18n"),"Locale"),"Fallbacks").$new(v):v),h=["i18n_fallbacks",A(L[1],"@@fallbacks",!1)],P(N("Thread").$current(),"[]=",K(h)),h[E(h.length,1)]},1),function(s,R){var v,h,y,c,N=[e(s,"Backend")].concat(R);return v=N,y=[h=e(N[0],"Fallbacks")].concat(v),c=r.$r(y),a(h,"$translate",function f(_,i,u){try{var n=f.$$p||t,$=this,d=t,I=t;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),w(u.$fetch("fallback",!0))?w(u["$[]"]("fallback_in_progress"))?S($,F($,"translate",f,!1,!0),"translate",[_,i,u],n):(w(u["$[]"]("default"))&&(d=$["$extract_non_symbol_default!"](u)),I=u.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),P(c("I18n").$fallbacks()["$[]"](_),"each",[],function g(z){var T=null==g.$$s?this:g.$$s;null==z&&(z=t);try{return P(T,"catch",["exception"],function j(){var l=null==j.$$s?this:j.$$s,V=t;if(V=S(l,B(l,"translate",j.$$def||g.$$def||f,!1,!1),"translate",[z,i,I],null),w(V["$nil?"]()))return t;G(_.$to_s(),z.$to_s())&&l.$on_fallback(_,z,i,u),r.ret(V)},{$$arity:0,$$s:T})}catch(j){if(!r.rescue(j,[m(c("I18n"),"InvalidLocale")]))throw j;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),w(u["$key?"]("default"))&&w(u["$[]"]("default")["$nil?"]())?t:w(d)?S($,F($,"translate",f,!1,!0),"translate",[_,t,u.$merge(H(["default"],{default:d}))],null):$.$throw("exception",m(c("I18n"),"MissingTranslation").$new(_,i,u))):S($,F($,"translate",f,!1,!0),"translate",[_,i,u],n)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),a(h,"$extract_non_symbol_default!",function(_){var u,i=t,n=t;return i=[_["$[]"]("default")].$flatten(),u=P(i,"detect",[],function(d){return null==d&&(d=t),d["$is_a?"](c("Symbol"))["$!"]()},1),w(u)&&(n=["default",i["$[]"](0,i.$index(u))],P(_,"[]=",K(n)),E(n.length,1)),u},1),a(h,"$exists?",function f(_,i,u){try{var n=f.$$p||t,$=this;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),w(u.$fetch("fallback",!0))?(P(c("I18n").$fallbacks()["$[]"](_),"each",[],function d(I){var g=null==d.$$s?this:d.$$s;null==I&&(I=t);try{if(!w(S(g,B(g,"exists?",d.$$def||f,!1,!1),"exists?",[I,i],null)))return t;r.ret(!0)}catch(z){if(!r.rescue(z,[m(c("I18n"),"InvalidLocale")]))throw z;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),!1):S($,F($,"exists?",f,!1,!0),"exists?",[_,i,u],n)}catch(d){if(d===r.returner)return d.$v;throw d}},-3),h.$private(),a(h,"$on_fallback",function(_,i,u,n){return t},4)}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(r){var C,b,v,h,y,c,s,R,M=[],t=r.nil,m=r.$$$,p=r.klass,w=r.const_set,A=r.def,a=r.truthy,P=r.rb_gt,K=r.rb_plus,E=r.rb_le,S=r.send,F=r.rb_minus,H=r.eqeq,B=r.rb_times,G=r.eqeqeq,W=r.rb_ge;return C=M,s=[(0,r.module)(M[0],"BCDice")].concat(C),R=r.$r(s),b=s,h=[v=p(s[0],null,"Randomizer")].concat(b),y=r.$r(h),(c=v.$$prototype).rand_results=c.detailed_rand_results=t,w(h[0],"UPPER_LIMIT_DICE_TIMES",200),w(h[0],"UPPER_LIMIT_DICE_SIDES",1e3),w(h[0],"UPPER_LIMIT_RANDS",1e4),A(v,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),v.$attr_reader("rand_results"),v.$attr_reader("detailed_rand_results"),w(h[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),A(v,"$roll_barabara",function(_,i){var u=this;return a(P(K(u.rand_results.$size(),_),y("UPPER_LIMIT_RANDS")))&&u.$raise(y("TooManyRandsError")),a(E(_,0))||a(P(_,y("UPPER_LIMIT_DICE_TIMES")))?[]:S(y("Array"),"new",[_],function n(){return(null==n.$$s?this:n.$$s).$roll_once(i)},{$$arity:0,$$s:u})},2),A(v,"$roll_sum",function(_,i){return this.$roll_barabara(_,i).$sum()},2),A(v,"$roll_once",function(_){var u=t;return a(E(_,0))||a(P(_,y("UPPER_LIMIT_DICE_SIDES")))?0:(u=this.$rand_inner(_),this.$push_to_detail("normal",_,u),u)},1),A(v,"$roll_index",function(_){return F(this.$roll_once(_),1)},1),A(v,"$roll_tens_d10",function(){var u,i=t;return i=this.$rand_inner(10),H(i,10)&&(i=0),u=B(i,10),this.$push_to_detail("tens_d10",10,u),u},0),A(v,"$roll_d9",function(){var i;return i=F(this.$rand_inner(10),1),this.$push_to_detail("d9",10,i),i},0),A(v,"$roll_d66",function(_){var n,u=t;return u=S(y("Array"),"new",[2],function $(){return(null==$.$$s?this:$.$$s).$roll_once(6)},{$$arity:0,$$s:this}),G(m(y("D66SortType"),"ASC"),n=_)?u["$sort!"]():G(m(y("D66SortType"),"DESC"),n)&&u["$sort!"]()["$reverse!"](),K(B(u["$[]"](0),10),u["$[]"](1))},1),v.$private(),A(v,"$rand_inner",function(_){var u,i=this;return a(W(i.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&i.$raise(y("TooManyRandsError")),u=i.$random(_),i.rand_results["$<<"]([u,_]),u},1),A(v,"$random",function(_){return K(y("Kernel").$rand(_),1)},1),A(v,"$push_to_detail",function(_,i,u){var $;return $=y("DetailedRandResult").$new(_,i,u),this.detailed_rand_results.$push($)},3),p(s[0],R("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var a,S,W,U,C,o,s,H,K,M=[],t=r.nil,m=r.module,e=r.klass,p=r.def,w=r.truthy;return a=M,S=K=[m(M[0],"BCDice")].concat(a),W=H=[m(K[0],"DiceTable")].concat(S),C=[U=e(H[0],null,"RollResult")].concat(W),o=r.$r(C),(s=U.$$prototype).table_name=s.value=s.body=t,p(U,"$initialize",function(L,N,b){var v=this;return v.table_name=L,v.value=N,v.body=b},3),U.$attr_reader("table_name"),U.$attr_reader("value"),U.$attr_reader("body"),p(U,"$to_s",function(){var L=this;return L.table_name+"("+L.value+") \uff1e "+L.body},0),p(U,"$last_body",function(){var L=this;return w(L.body["$is_a?"](o("RollResult")))?L.body.$last_body():L.body},0),p(U,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var P,F,U,C,o,s,R,B,E,M=[],t=r.nil,m=r.module,e=r.klass,p=r.truthy,w=r.def,A=r.rb_minus;return P=M,F=E=[m(M[0],"BCDice")].concat(P),U=B=[m(E[0],"DiceTable")].concat(F),o=[C=e(B[0],null,"ChainTable")].concat(U),s=r.$r(o),(R=C.$$prototype).times=R.sides=R.items=R.name=t,w(C,"$initialize",function(N,b,v){var h=this,y=t;return h.name=N,h.items=v.$freeze(),y=/(\d+)D(\d+)/i.$match(b),p(y)||h.$raise(s("ArgumentError"),"Unexpected table type: "+b),h.times=y["$[]"](1).$to_i(),h.sides=y["$[]"](2).$to_i()},3),w(C,"$roll",function(N){var v,h,b=this,y=t;return v=N.$roll_sum(b.times,b.sides),h=A(v,b.times),y=b.items["$[]"](h),p(y["$respond_to?"]("roll"))&&(y=y.$roll(N)),s("RollResult").$new(b.name,v,y)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var S,G,s,R,L,N,b,U,H,M=[],t=r.nil,m=r.module,e=r.klass,p=r.hash2,w=r.defs,A=r.def,a=r.rb_plus,P=r.rb_times,K=r.rb_minus;return S=M,G=H=[m(M[0],"BCDice")].concat(S),s=U=[m(H[0],"DiceTable")].concat(G),L=[R=e(U[0],null,"D66GridTable")].concat(s),N=r.$r(L),(b=R.$$prototype).name=b.items=t,w(R,"$from_i18n",function(h,y){var f=t;return f=N("I18n").$t(h,p(["locale","raise"],{locale:y,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items"))},2),A(R,"$initialize",function(h,y){return this.name=h,this.items=y.$freeze()},2),A(R,"$roll",function(h){var c,f,_,i,u;return c=h.$roll_once(6),f=h.$roll_once(6),_=a(P(c,10),f),i=K(c,1),u=K(f,1),N("RollResult").$new(this.name,_,this.items["$[]"](i)["$[]"](u))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var K,H,o,s,R,L,G,W,S,t=[],m=r.nil,e=r.module,p=r.klass,w=r.hash2,A=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=S=[e(t[0],"BCDice")].concat(K),G=[e(S[0],"DiceTable")].concat(H),W=r.$r(G),o=G,R=[s=p(G[0],W("D66GridTable"),"D66HalfGridTable")].concat(o),L=r.$r(R),A(s,"$from_i18n",function(b,v){var y=m;return y=L("I18n").$t(b,w(["locale","raise"],{locale:v,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))},2),a(s,"$initialize",function(b,v,h){return this.name=b,this.items=[v,v,v,h,h,h].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var K,H,o,s,R,L,G,W,S,t=[],m=r.nil,e=r.module,p=r.klass,w=r.hash2,A=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=S=[e(t[0],"BCDice")].concat(K),G=[e(S[0],"DiceTable")].concat(H),W=r.$r(G),o=G,R=[s=p(G[0],W("D66GridTable"),"D66OneThirdTable")].concat(o),L=r.$r(R),A(s,"$from_i18n",function(b,v){var y=m;return y=L("I18n").$t(b,w(["locale","raise"],{locale:v,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))},2),a(s,"$initialize",function(b,v,h,y){return this.name=b,this.items=[v,v,h,h,y,y].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var H,U,L,N,b,v,h,o,G,M=[],t=r.nil,m=r.$$$,e=r.module,p=r.klass,w=r.hash2,A=r.defs,a=r.def,P=r.eqeqeq,K=r.rb_plus,E=r.rb_times,S=r.truthy;return H=M,U=G=[e(M[0],"BCDice")].concat(H),L=o=[e(G[0],"DiceTable")].concat(U),b=[N=p(o[0],null,"D66Table")].concat(L),v=r.$r(b),(h=N.$$prototype).sort_type=h.items=h.name=t,A(N,"$from_i18n",function(c,f){var u,i=t;return i=v("I18n").$t(c,w(["locale"],{locale:f})),u=v("D66SortType").$const_get(i["$[]"]("d66_sort_type")),this.$new(i["$[]"]("name"),u,i["$[]"]("items"))},2),a(N,"$initialize",function(c,f,_){var i=this;return i.name=c,i.sort_type=f,i.items=_.$freeze()},3),a(N,"$roll",function(c){var f=this,_=t,i=t,u=t,n=t;return _=c.$roll_barabara(2,6),P(m(v("D66SortType"),"ASC"),i=f.sort_type)?_["$sort!"]():P(m(v("D66SortType"),"DESC"),i)&&_["$sort!"]()["$reverse!"](),u=K(E(_["$[]"](0),10),_["$[]"](1)),n=S(i=f.items["$[]"](u))?i:f.items["$[]"](u.$to_s()),S(n["$respond_to?"]("roll"))&&(n=n.$roll(c)),v("RollResult").$new(f.name,u,n)},1),a(N,"$choice",function(c){return v("RollResult").$new(this.name,c,this.items["$[]"](c))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var W,s,L,N,C,t=[],m=r.nil,e=r.module,p=r.klass,w=r.hash2,A=r.send,a=r.to_ary,P=r.rb_plus,K=r.rb_times,E=r.to_a,S=r.rb_minus,F=r.send2,H=r.find_super,B=r.def;return r.top.$require("bcdice/dice_table/d66_table"),W=t,s=C=[e(t[0],"BCDice")].concat(W),L=[e(C[0],"DiceTable")].concat(s),N=r.$r(L),B(p(L[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function y(c,f,_){var n;return delete y.$$p,n=w([],{}),A(_,"each",[],function(d){var I,T;return null==d&&(d=m),I=a(d),T=null==I[1]?m:I[1],A(null==I[0]?m:I[0],"each",[],function(l){return null==l&&(l=m),A(T,"each_with_index",[],function(k,X){var ie,te;return null==k&&(k=m),null==X&&(X=m),ie=P(K(l,10),P(X,1)),A(n,"[]=",E(te=[ie,k])),te[S(te.length,1)]},2)},1)},1),F(this,H(this,"initialize",y,!1,!0),"initialize",[c,f,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var E,B,o,s,R,L,N,W,F,M=[],t=r.nil,m=r.module,e=r.klass,p=r.def,w=r.truthy,A=r.rb_minus,a=r.rb_plus,P=r.rb_times;return E=M,B=F=[m(M[0],"BCDice")].concat(E),o=W=[m(F[0],"DiceTable")].concat(B),R=[s=e(W[0],null,"D66ParityTable")].concat(o),L=r.$r(R),(N=s.$$prototype).odd=N.even=N.name=t,p(s,"$initialize",function(v,h,y){var c=this;return c.name=v,c.odd=h.$freeze(),c.even=y.$freeze()},3),p(s,"$roll",function(v){var c,_,i,h=this,y=t;return y=v.$roll_once(6),c=v.$roll_once(6),_=(w(y["$odd?"]())?h.odd:h.even)["$[]"](A(c,1)),i=a(P(y,10),c),L("RollResult").$new(h.name,i,_)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var K,H,C,o,s,R,L,G,S,M=[],t=r.nil,m=r.module,e=r.klass,p=r.def,w=r.rb_plus,A=r.rb_times,a=r.send;return K=M,H=S=[m(M[0],"BCDice")].concat(K),C=G=[m(S[0],"DiceTable")].concat(H),s=[o=e(G[0],null,"D66RangeTable")].concat(C),R=r.$r(s),(L=o.$$prototype).items=L.name=t,p(o,"$initialize",function(b,v){return this.name=b,this.items=v.$freeze()},2),p(o,"$roll",function(b){var h,y,c,f=t;return h=b.$roll_once(6),y=b.$roll_once(6),c=w(A(h,10),y),f=a(this.items,"find",[],function(i){return null==i&&(i=t),i["$[]"](0)["$include?"](c)},1),R("RollResult").$new(this.name,c,f["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var B,C,N,b,v,h,y,s,W,M=[],t=r.nil,m=r.module,e=r.klass,p=r.const_set,w=r.send,A=r.truthy,a=r.def,P=r.to_a,K=r.rb_minus,E=r.eqeqeq,S=r.rb_times,F=r.rb_plus;return B=M,C=W=[m(M[0],"BCDice")].concat(B),N=s=[m(W[0],"DiceTable")].concat(C),v=[b=e(s[0],null,"RangeTable")].concat(N),h=r.$r(v),(y=b.$$prototype).name=y.items=y.num_of_dice=y.num_of_sides=y.formatter=t,p(v[0],"RollResult",w(h("Struct"),"new",["sum","values","content","formatted"],function c(){return(null==c.$$s?this:c.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:b})),p(v[0],"Item",h("Struct").$new("range","content")),p(v[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(v[0],"DEFAULT_FORMATTER",w(b,"lambda",[],function(f,_){return null==f&&(f=t),null==_&&(_=t),f.$name()+"("+_.$sum()+") \uff1e "+_.$content()},2)),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),a(b,"$initialize",function c(f,_,i){var $,u=c.$$p||t,n=this,d=t;return delete c.$$p,n.name=f.$freeze(),n.formatter=A($=u)?$:h("DEFAULT_FORMATTER"),d=h("DICE_ROLL_METHOD_RE").$match(_),A(d)||n.$raise(h("ArgumentError"),n.name+": invalid dice roll method: "+_),n.num_of_dice=d["$[]"](1).$to_i(),n.num_of_sides=d["$[]"](2).$to_i(),n.$store(i)},3),a(b,"$fetch",function(f){var i,_=this;return i=w(_.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](f)},1),A(i)||_.$raise(h("RangeError"),_.name+": value is out of range: "+f),i},1),a(b,"$roll",function(f){var u,n,$,_=this,i=t;return u=(i=f.$roll_barabara(_.num_of_dice,_.num_of_sides)).$sum(),n=h("RollResult").$new(u,i,_.$fetch(u).$content()),$=[_.formatter["$[]"](_,n)],w(n,"formatted=",P($)),K($.length,1),n},1),b.$private(),a(b,"$store",function(f){var i,u,_=this;return i=w(f,"map",[],function n($,d){return null==$&&($=t),null==d&&(d=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range($),d]},{$$arity:2,$$s:_}),u=w(i,"sort_by",[],function($,d){return null==$&&($=t),null==d&&(d=t),$.$min()},2),_.$assert_min_sum_is_covered(u),_.$assert_max_sum_is_covered(u),_.$assert_no_gap_or_overlap_in_ranges(u),_.items=w(u,"map",[],function($,d){return null==$&&($=t),null==d&&(d=t),h("Item").$new($,d.$freeze()).$freeze()},2).$freeze(),_},1),a(b,"$coerce_to_int_range",function(f){var i;return E(h("Integer"),i=f)?h("Range").$new(f,f):E(h("Range"),i)&&A(f.$begin()["$is_a?"](h("Integer")))&&A(f.$end()["$is_a?"](h("Integer")))?f:this.$raise(h("TypeError"),this.name+": "+f+" ("+f.$class()+") must be an Integer or a Range with Integers ")},1),a(b,"$assert_min_sum_is_covered",function(f){var i,_=this,u=t;return i=_.num_of_dice,u=f.$first()["$[]"](0),A(u["$include?"](i))||_.$raise(h("RangeError"),_.name+": min value ("+i+") is not covered: "+u),_},1),a(b,"$assert_max_sum_is_covered",function(f){var i,_=this,u=t;return i=S(_.num_of_dice,_.num_of_sides),u=f.$last()["$[]"](0),A(u["$include?"](i))||_.$raise(h("RangeError"),_.name+": max value ("+i+") is not covered: "+u),_},1),a(b,"$assert_no_gap_or_overlap_in_ranges",function(f){return w(f,"each_cons",[2],function i(u,n){var g,z,$=null==i.$$s?this:i.$$s,d=t,I=t;return null==$.name&&($.name=t),null==u&&(u=t),null==n&&(n=t),d=u["$[]"](0),I=n["$[]"](0),g=d.$max(),z=F(g,1),A(I["$include?"](g))&&$.$raise(h("RangeError"),$.name+": Range overlap: "+d+" and "+I),A(I["$include?"](z))?t:$.$raise(h("RangeError"),$.name+": Range gap: "+d+" and "+I)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var K,H,C,N,b,v,h,s,G,S,M=[],t=r.nil,m=r.$$$,e=r.module,p=r.klass,w=r.send,A=r.def,a=r.rb_minus;return K=M,H=S=[e(M[0],"BCDice")].concat(K),C=G=[e(S[0],"DiceTable")].concat(H),N=s=[p(G[0],null,"SaiFicSkillTable")].concat(C),v=[b=p(s[0],null,"Category")].concat(N),h=r.$r(v),b.$$prototype.name=t,A(b,"$initialize",function(f,_,i,u){var n=this;return n.name=f,n.skills=w(_.$map(),"with_index",[2],function(d,I){return null==d&&(d=t),null==I&&(I=t),m(h("SaiFicSkillTable"),"Skill").$new(f,d,i,I,u)},2),n.dice=i},4),A(b,"$roll",function(f){return this.$skills()["$[]"](a(f.$roll_sum(2,6),2))},1),A(b,"$to_s",function(){return this.name},0),b.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var a,S,W,R,L,C,H,K,M=[],t=r.nil,m=r.module,e=r.klass,p=r.def,w=r.hash2;return a=M,S=K=[m(M[0],"BCDice")].concat(a),W=H=[m(K[0],"DiceTable")].concat(S),C=[e(H[0],null,"SaiFicSkillTable")].concat(W),(L=(R=e(C[0],null,"Skill")).$$prototype).s_format=L.category_dice=L.row_dice=L.category_name=L.name=t,p(R,"$initialize",function(b,v,h,y,c){var f=this;return f.category_name=b,f.name=v,f.category_dice=h,f.row_dice=y,f.s_format=c},5),p(R,"$to_s",function(){var b=this;return b.$format(b.s_format,w(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},0),R.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var U,R,h,y,c,f,_,N,o,M=r.top,t=[],m=r.nil,e=r.$$$,p=r.module,w=r.klass,A=r.hash2,a=r.send,K=r.defs,E=r.const_set,S=r.to_ary,F=r.def,H=r.truthy,B=r.rb_minus,G=r.rb_plus;return M.$require("bcdice/dice_table/sai_fic_skill_table/category"),M.$require("bcdice/dice_table/sai_fic_skill_table/skill"),U=t,R=o=[p(t[0],"BCDice")].concat(U),h=N=[p(o[0],"DiceTable")].concat(R),c=[y=w(N[0],null,"SaiFicSkillTable")].concat(h),f=r.$r(c),(_=y.$$prototype).rtt=_.rtt_format=_.rct=_.rct_format=_.rttn=_.rttn_format=_.categories=m,K(y,"$from_i18n",function(u,n,$){var d,I,g,l,j=m;if(null==$)$=A([],{});else if(!$.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(d=$.$$smap.rtt)&&(d=m),null==(I=$.$$smap.rct)&&(I=m),null==(g=$.$$smap.rttn)&&(g=m),l=(j=f("I18n").$t("RTT",A(["locale","raise","default"],{locale:n,raise:!1,default:A([],{})})).$merge(f("I18n").$t(u,A(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),j=a(j,"select",[],function(k,X){return null==k&&(k=m),null==X&&(X=m),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](k)},2),this.$new(l,r.to_hash(j).$merge(A(["rtt","rct","rttn"],{rtt:d,rct:I,rttn:g})))},-3),E(c[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),E(c[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),E(c[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),E(c[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),F(y,"$initialize",function(u,n){var $,d,I,g,z,T,j,l=this;if(null==n)n=A([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==($=n.$$smap.rtt)&&($=m),null==(d=n.$$smap.rct)&&(d=m),null==(I=n.$$smap.rttn)&&(I=m),null==(g=n.$$smap.rtt_format)&&(g=f("DEFAULT_RTT")),null==(z=n.$$smap.rct_format)&&(z=f("DEFAULT_RCT")),null==(T=n.$$smap.rttn_format)&&(T=f("DEFAULT_RTTN")),null==(j=n.$$smap.s_format)&&(j=f("DEFAULT_S")),l.categories=a(u.$map(),"with_index",[1],function(k,X){var ie,ce,ne;return null==k&&(k=m),null==X&&(X=m),ce=null==(ie=S(k))[0]?m:ie[0],ne=null==ie[1]?m:ie[1],e(f("SaiFicSkillTable"),"Category").$new(ce,ne,X,j)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),l.rtt=$,l.rct=d,l.rttn=I.$to_a(),l.rtt_format=g,l.rct_format=z,l.rttn_format=T},-2),E(c[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),F(y,"$roll_command",function(u,n){var d,$=this,I=m,g=m;return H(["RTT",$.rtt]["$include?"](d=n))?$.$format_skill($.rtt_format,$.$roll_skill(u)):H(["RCT",$.rct]["$include?"](d))?(I=$.$roll_category(u),$.$format($.rct_format,A(["category_dice","category_name"],{category_dice:I.$dice(),category_name:I.$name()}))):H(g=f("RTTN").$index(d))||H(g=$.rttn.$index(d))?$.$format_skill($.rttn_format,$.categories["$[]"](g).$roll(u)):m},2),F(y,"$roll_category",function(u){return this.categories["$[]"](B(u.$roll_once(6),1))},1),F(y,"$roll_skill",function(u){return this.$roll_category(u).$roll(u)},1),F(y,"$prefixes",function(){var u=this;return G(["RTT[1-6]?","RCT",u.rtt,u.rct],u.rttn).$compact()},0),y.$private(),F(y,"$format_skill",function(u,n){return this.$format(u,A(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var E,B,o,s,R,L,N,W,F,M=[],t=r.nil,m=r.module,e=r.klass,p=r.hash2,w=r.defs,A=r.truthy,a=r.def,P=r.rb_minus;return E=M,B=F=[m(M[0],"BCDice")].concat(E),o=W=[m(F[0],"DiceTable")].concat(B),R=[s=e(W[0],null,"Table")].concat(o),L=r.$r(R),(N=s.$$prototype).times=N.sides=N.name=N.items=t,w(s,"$from_i18n",function(v,h){var c=t;return c=L("I18n").$t(v,p(["locale"],{locale:h})),this.$new(c["$[]"]("name"),c["$[]"]("type"),c["$[]"]("items"))},2),a(s,"$initialize",function(v,h,y){var c=this,f=t;return c.name=v,c.items=y.$freeze(),f=/(\d+)D(\d+)/i.$match(h),A(f)||c.$raise(L("ArgumentError"),"Unexpected table type: "+h),c.times=f["$[]"](1).$to_i(),c.sides=f["$[]"](2).$to_i()},3),a(s,"$roll",function(v){var y,h=this;return y=v.$roll_sum(h.times,h.sides),h.$choice(y)},1),a(s,"$choice",function(v){var y,h=this;return y=P(v,h.times),L("RollResult").$new(h.name,v,h.items["$[]"](y))},1)},Opal.modules["bcdice/dice_table"]=function(r){var M=r.top;return M.$require("bcdice/dice_table/roll_result"),M.$require("bcdice/dice_table/chain_table"),M.$require("bcdice/dice_table/d66_grid_table"),M.$require("bcdice/dice_table/d66_half_grid_table"),M.$require("bcdice/dice_table/d66_one_third_table"),M.$require("bcdice/dice_table/d66_left_range_table"),M.$require("bcdice/dice_table/d66_parity_table"),M.$require("bcdice/dice_table/d66_range_table"),M.$require("bcdice/dice_table/d66_table"),M.$require("bcdice/dice_table/range_table"),M.$require("bcdice/dice_table/sai_fic_skill_table"),M.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var w,K,S,a,M=[],m=r.module,e=r.const_set;return w=M,K=a=[m(M[0],"BCDice")].concat(w),S=[m(a[0],"D66SortType")].concat(K),e(S[0],"NO_SORT","no_sort"),e(S[0],"ASC","asc"),e(S[0],"DESC","desc"),function(P,K){var S=[m(P,"RoundType")].concat(K);return e(S[0],"CEIL","ceil"),e(S[0],"FLOOR","floor"),e(S[0],"ROUND","round")}(a[0],a)},Opal.modules["bcdice/translate"]=function(r){var a,S,F,H,B,K,M=[],t=r.nil,m=r.module,e=r.hash2,w=r.def;return a=M,S=K=[m(M[0],"BCDice")].concat(a),H=[F=m(K[0],"Translate")].concat(S),B=r.$r(H),w(F,"$translate",function(W,U){var C,o=this;if(null==o.locale&&(o.locale=t),null==U)U=e([],{});else if(!U.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return C=r.kwrestargs(U,{}),B("I18n").$translate(W,e(["locale","raise"],{locale:o.locale,raise:!0}).$merge(r.to_hash(C)))},-2)},Opal.modules["bcdice/result"]=function(r){var K,B,C,G,U,S,M=[],t=r.nil,e=r.klass,p=r.send,w=r.to_a,A=r.rb_minus,a=r.def;return K=M,B=S=[(0,r.module)(M[0],"BCDice")].concat(K),[G=e(S[0],null,"Result")].concat(B),(U=G.$$prototype).secret=U.success=U.failure=U.critical=U.fumble=t,a(C=r.get_singleton_class(G),"$success",function(R){return p(this.$new(),"tap",[],function(b){var v=t;return null==b&&(b=t),p(b,"text=",w(v=[R])),A(v.length,1),p(b,"success=",w(v=[!0])),v[A(v.length,1)]},1)},1),a(C,"$failure",function(R){return p(this.$new(),"tap",[],function(b){var v=t;return null==b&&(b=t),p(b,"text=",w(v=[R])),A(v.length,1),p(b,"failure=",w(v=[!0])),v[A(v.length,1)]},1)},1),a(C,"$critical",function(R){return p(this.$new(),"tap",[],function(b){var v=t;return null==b&&(b=t),p(b,"text=",w(v=[R])),A(v.length,1),p(b,"critical=",w(v=[!0])),A(v.length,1),p(b,"success=",w(v=[!0])),v[A(v.length,1)]},1)},1),a(C,"$fumble",function(R){return p(this.$new(),"tap",[],function(b){var v=t;return null==b&&(b=t),p(b,"text=",w(v=[R])),A(v.length,1),p(b,"fumble=",w(v=[!0])),A(v.length,1),p(b,"failure=",w(v=[!0])),v[A(v.length,1)]},1)},1),a(C,"$nothing",function(){return"nothing"},0),a(G,"$initialize",function(o){var s=this;return null==o&&(o=t),s.text=o,s.rands=t,s.detailed_rands=t,s.secret=!1,s.success=!1,s.failure=!1,s.critical=!1,s.fumble=!1},-1),G.$attr_accessor("text","rands","detailed_rands"),G.$attr_writer("secret","success","failure","critical","fumble"),a(G,"$secret?",function(){return this.secret},0),a(G,"$success?",function(){return this.success},0),a(G,"$failure?",function(){return this.failure},0),a(G,"$critical?",function(){return this.critical},0),a(G,"$fumble?",function(){return this.fumble},0),a(G,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var h,c,f,t=[],m=r.$r(t),e=r.nil,p=r.$$$,w=r.module,A=r.klass,a=r.truthy,P=r.const_set,K=r.defs,E=r.gvars,S=r.rb_lt,F=r.send,H=r.to_a,B=r.rb_minus,G=r.def,W=r.to_ary,U=r.neqeq,C=r.rb_plus,o=r.eqeq,s=r.rb_ge,R=r.rb_gt,L=r.eqeqeq,N=r.rb_le,b=r.rb_times;return h=t,c=[w(t[0],"Racc")].concat(h),f=r.$r(c),A(c[0],f("StandardError"),"ParseError"),a(p("::","ParseError","skip_raise")?"constant":e)||P(t[0],"ParseError",p(m("Racc"),"ParseError")),function(v,h){var n,$,d,I,g,f=[w(v,"Racc")].concat(h),_=r.$r(f);return a(_("Racc_No_Extensions","skip_raise")?"constant":e)||P(f[0],"Racc_No_Extensions",!1),n=f,d=[$=A(f[0],null,"Parser")].concat(n),I=r.$r(d),(g=$.$$prototype).yydebug=g.racc_debug_out=g.racc_error_status=g.racc_t=g.racc_vstack=g.racc_val=g.racc_state=g.racc_tstack=e,P(d[0],"Racc_Runtime_Version","1.4.6"),P(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),P(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),P(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),P(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),P(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),P(d[0],"Racc_Runtime_Core_Version",I("Racc_Runtime_Core_Version_R")),P(d[0],"Racc_Runtime_Core_Revision",I("Racc_Runtime_Core_Revision_R")),P(d[0],"Racc_Runtime_Type","ruby"),K(I("Parser"),"$racc_runtime_type",function(){return I("Racc_Runtime_Type")},0),G($,"$_racc_setup",function(){var T,j,l=this,V=e,k=e,X=e;return null==E.stderr&&(E.stderr=e),a(p(l.$class(),"Racc_debug_parser"))||(l.yydebug=!1),a(null!=(T=l.yydebug)&&T!==e?"instance-variable":e)||(l.yydebug=!1),a(l.yydebug)&&(a(null!=(j=l.racc_debug_out)&&j!==e?"instance-variable":e)||(l.racc_debug_out=E.stderr),l.racc_debug_out=a(V=l.racc_debug_out)?V:E.stderr),k=p(l.$class(),"Racc_arg"),a(S(k.$size(),14))&&(F(k,"[]=",H(X=[13,!0])),B(X.length,1)),k},0),G($,"$_racc_init_sysvars",function(){var T=this;return T.racc_state=[0],T.racc_tstack=[],T.racc_vstack=[],T.racc_t=e,T.racc_val=e,T.racc_read_next=!0,T.racc_user_yyerror=!1,T.racc_error_status=0},0),G($,"$do_parse",function(){return this.$__send__(I("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),G($,"$next_token",function(){return this.$raise(I("NotImplementedError"),this.$class()+"#next_token is not defined")},0),G($,"$_racc_do_parse_rb",function(T,j){var l,k=this,X=e,ie=e,te=e,ce=e,Q=e,D=e,J=e,x=e;return l=W(T),X=null==l[0]?e:l[0],ie=null==l[1]?e:l[1],te=null==l[2]?e:l[2],ce=null==l[3]?e:l[3],Q=null==l[10]?e:l[10],k.$_racc_init_sysvars(),D=J=x=e,F(k,"catch",["racc_end_parse"],function q(){var re,Z,Y=null==q.$$s?this:q.$$s,ae=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);a(!0);)for(a(x=ce["$[]"](Y.racc_state["$[]"](-1)))?(a(Y.racc_read_next)&&U(Y.racc_t,0)&&(Z=Y.$next_token(),re=W(Z),D=null==re[0]?e:re[0],Y.racc_val=null==re[1]?e:re[1],Y.racc_t=a(D)?a(ae=Q["$[]"](D))?ae:1:0,a(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,D,Y.racc_val),Y.racc_read_next=!1),x=C(x,Y.racc_t),a(s(x,0))&&a(J=X["$[]"](x))&&o(ie["$[]"](x),Y.racc_state["$[]"](-1))||(J=te["$[]"](Y.racc_state["$[]"](-1)))):J=te["$[]"](Y.racc_state["$[]"](-1));a(J=Y.$_racc_evalact(J,T)););},{$$arity:0,$$s:k})},2),G($,"$yyparse",function(T,j){return this.$__send__(I("Racc_YY_Parse_Method"),T,j,this.$_racc_setup(),!0)},2),G($,"$_racc_yyparse_rb",function(T,j,l,V){var k,te=e,ce=e,ne=e,Q=e,J=e,x=e,q=e;return k=W(l),te=null==k[0]?e:k[0],ce=null==k[1]?e:k[1],ne=null==k[2]?e:k[2],Q=null==k[3]?e:k[3],J=null==k[10]?e:k[10],this.$_racc_init_sysvars(),x=e,q=e,F(this,"catch",["racc_end_parse"],function ee(){var Y=null==ee.$$s?this:ee.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!a(q=Q["$[]"](Y.racc_state["$[]"](-1)));)for(;a(x=Y.$_racc_evalact(ne["$[]"](Y.racc_state["$[]"](-1)),l)););return F(T,"__send__",[j],function ae(se,_e){var $e=null==ae.$$s?this:ae.$$s,O=e,oe=e;for(null==$e.racc_t&&($e.racc_t=e),null==$e.racc_state&&($e.racc_state=e),null==$e.racc_read_next&&($e.racc_read_next=e),null==se&&(se=e),null==_e&&(_e=e),$e.racc_t=a(se)?a(O=J["$[]"](se))?O:1:0,$e.racc_val=_e,$e.racc_read_next=!1,q=C(q,$e.racc_t),a(s(q,0))&&a(x=te["$[]"](q))&&o(ce["$[]"](q),$e.racc_state["$[]"](-1))||(x=ne["$[]"]($e.racc_state["$[]"](-1)));a(x=$e.$_racc_evalact(x,l)););for(;a(a(O=a(oe=(q=Q["$[]"]($e.racc_state["$[]"](-1)))["$!"]())?oe:$e.racc_read_next["$!"]())?O:$e.racc_t["$=="](0));)for(a(q)&&a(q=C(q,$e.racc_t))&&a(s(q,0))&&a(x=te["$[]"](q))&&o(ce["$[]"](q),$e.racc_state["$[]"](-1))||(x=ne["$[]"]($e.racc_state["$[]"](-1)));a(x=$e.$_racc_evalact(x,l)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),G($,"$_racc_evalact",function(T,j){var l,ne,k=this,X=e,ie=e,ce=e,Q=e,D=e,J=e,x=e;if(X=null==(l=W(j))[0]?e:l[0],ie=null==l[1]?e:l[1],ce=null==l[3]?e:l[3],ne=null==l[11]?e:l[11],Q=null==l[12]?e:l[12],a(R(T,0))&&a(S(T,ne)))a(R(k.racc_error_status,0))&&(o(k.racc_t,1)||(k.racc_error_status=B(k.racc_error_status,1))),k.racc_vstack.$push(k.racc_val),k.racc_state.$push(T),k.racc_read_next=!0,a(k.yydebug)&&(k.racc_tstack.$push(k.racc_t),k.$racc_shift(k.racc_t,k.racc_tstack,k.racc_vstack));else if(a(S(T,0))&&a(R(T,Q["$-@"]()))){if(D=F(k,"catch",["racc_jump"],function q(){var ee=null==q.$$s?this:q.$$s;return null==ee.racc_state&&(ee.racc_state=e),ee.racc_state.$push(ee.$_racc_do_reduce(j,T)),!1},{$$arity:0,$$s:k}),a(D)){if(L(1,J=D))return k.racc_user_yyerror=!0,Q["$-@"]();if(L(2,J))return ne;k.$raise("[Racc Bug] unknown jump code")}}else if(o(T,ne))a(k.yydebug)&&k.$racc_accept(),k.$throw("racc_end_parse",k.racc_vstack["$[]"](0));else{if(o(T,Q["$-@"]())){for(L(0,J=k.racc_error_status)?a(j["$[]"](21))||k.$on_error(k.racc_t,k.racc_val,k.racc_vstack):L(3,J)&&(o(k.racc_t,0)&&k.$throw("racc_end_parse",e),k.racc_read_next=!0),k.racc_user_yyerror=!1,k.racc_error_status=3;a(!0)&&!(a(x=ce["$[]"](k.racc_state["$[]"](-1)))&&(x=C(x,1),a(s(x,0))&&a(T=X["$[]"](x))&&o(ie["$[]"](x),k.racc_state["$[]"](-1))));)a(N(k.racc_state.$size(),1))&&k.$throw("racc_end_parse",e),k.racc_state.$pop(),k.racc_vstack.$pop(),a(k.yydebug)&&(k.racc_tstack.$pop(),k.$racc_e_pop(k.racc_state,k.racc_tstack,k.racc_vstack));return T}k.$raise("[Racc Bug] unknown action "+T.$inspect())}return a(k.yydebug)&&k.$racc_next_state(k.racc_state["$[]"](-1),k.racc_state),e},2),G($,"$_racc_do_reduce",function(T,j){var l,Q,J,Y,ae,se,$e,k=this,ie=e,te=e,ce=e,ne=e,D=e,x=e,q=e,ee=e,re=e,Z=e,_e=e,le=e,ue=e,O=e;return ie=null==(l=W(T))[4]?e:l[4],te=null==l[5]?e:l[5],ce=null==l[6]?e:l[6],ne=null==l[7]?e:l[7],Q=null==l[8]?e:l[8],D=null==l[9]?e:l[9],J=null==l[13]?e:l[13],x=k.racc_state,q=k.racc_vstack,ee=k.racc_tstack,re=b(j,-3),Z=D["$[]"](re),Y=D["$[]"](C(re,1)),ae=D["$[]"](C(re,2)),se=[],a(k.yydebug)&&(_e=ee["$[]"](Z["$-@"](),Z)),le=q["$[]"](Z["$-@"](),Z),a(k.yydebug)&&(ue=[Z["$-@"](),Z,se],F(ee,"[]=",H(ue)),B(ue.length,1)),ue=[Z["$-@"](),Z,se],F(q,"[]=",H(ue)),B(ue.length,1),ue=[Z["$-@"](),Z,se],F(x,"[]=",H(ue)),B(ue.length,1),a(J)?q.$push(k.$__send__(ae,le,q,le["$[]"](0))):q.$push(k.$__send__(ae,le,q)),ee.$push(Y),a(k.yydebug)&&k.$racc_reduce(_e,Y,ee,q),$e=B(Y,Q),a(re=ne["$[]"]($e))&&(re=C(re,x["$[]"](-1)),a(s(re,0))&&a(O=ie["$[]"](re))&&o(te["$[]"](re),$e))?O:ce["$[]"]($e)},2),G($,"$on_error",function(T,j,l){var k,V=this;return V.$raise(I("ParseError"),V.$sprintf("\nparse error on value %s (%s)",j.$inspect(),a(k=V.$token_to_str(T))?k:"?"))},3),G($,"$yyerror",function(){return this.$throw("racc_jump",1)},0),G($,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),G($,"$yyerrok",function(){return this.racc_error_status=0},0),G($,"$racc_read_token",function(T,j,l){var V=this;return V.racc_debug_out.$print("read    "),V.racc_debug_out.$print(j.$inspect(),"(",V.$racc_token2str(T),") "),V.racc_debug_out.$puts(l.$inspect()),V.racc_debug_out.$puts()},3),G($,"$racc_shift",function(T,j,l){var V=this;return V.racc_debug_out.$puts("shift   "+V.$racc_token2str(T)),V.$racc_print_stacks(j,l),V.racc_debug_out.$puts()},3),G($,"$racc_reduce",function(T,j,l,V){var k=this,X=e;return(X=k.racc_debug_out).$print("reduce "),a(T["$empty?"]())?X.$print(" <none>"):F(T,"each",[],function ie(te){return null==te&&(te=e),X.$print(" ",(null==ie.$$s?this:ie.$$s).$racc_token2str(te))},{$$arity:1,$$s:k}),X.$puts(" --\x3e "+k.$racc_token2str(j)),k.$racc_print_stacks(l,V),k.racc_debug_out.$puts()},4),G($,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),G($,"$racc_e_pop",function(T,j,l){var V=this;return V.racc_debug_out.$puts("error recovering mode: pop token"),V.$racc_print_states(T),V.$racc_print_stacks(j,l),V.racc_debug_out.$puts()},3),G($,"$racc_next_state",function(T,j){var l=this;return l.racc_debug_out.$puts("goto    "+T),l.$racc_print_states(j),l.racc_debug_out.$puts()},2),G($,"$racc_print_stacks",function(T,j){var V=e;return(V=this.racc_debug_out).$print("        ["),F(T,"each_index",[],function k(X){return null==X&&(X=e),V.$print(" (",(null==k.$$s?this:k.$$s).$racc_token2str(T["$[]"](X))," ",j["$[]"](X).$inspect(),")")},{$$arity:1,$$s:this}),V.$puts(" ]")},2),G($,"$racc_print_states",function(T){var l=e;return(l=this.racc_debug_out).$print("        ["),F(T,"each",[],function(k){return null==k&&(k=e),l.$print(" ",k)},1),l.$puts(" ]")},1),G($,"$racc_token2str",function(T){var l;return a(l=p(this.$class(),"Racc_token_to_s_table")["$[]"](T))?l:this.$raise("[Racc Bug] can't convert token "+T+" to string")},1),G($,"$token_to_str",function(T){return p(this.$class(),"Racc_token_to_s_table")["$[]"](T)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var B,C,L,c,f,b,v,s,W,M=[],t=r.nil,m=r.$$$,e=r.module,p=r.klass,w=r.def,A=r.send2,a=r.find_super,P=r.eqeq,K=r.const_set,E=r.eqeqeq,S=r.rb_divide,F=r.alias;return B=M,C=W=[e(M[0],"BCDice")].concat(B),L=s=[e(W[0],"Arithmetic")].concat(C),b=[e(s[0],"Node")].concat(L),v=r.$r(b),(f=(c=p(b[0],null,"BinaryOp")).$$prototype).lhs=f.rhs=f.op=t,w(c,"$initialize",function(i,u,n){var $=this;return $.lhs=i,$.op=u,$.rhs=n},3),w(c,"$eval",function(i){var $,u=this,n=t;return n=u.lhs.$eval(i),$=u.rhs.$eval(i),n.$send(u.op,$)},1),w(c,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),w(c,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),w(c,"$op_for_s_exp",function(){return this.op},0),function(h,y,c){var f=p(h,y,"DivideBase"),_=[f].concat(c),i=r.$r(_),u=f.$$prototype;u.lhs=u.rhs=u.op=t,w(f,"$initialize",function n($,d){return delete n.$$p,A(this,a(this,"initialize",n,!1,!0),"initialize",[$,"/",d],null)},2),w(f,"$eval",function($){var I,g,d=this;return I=d.lhs.$eval($),g=d.rhs.$eval($),P(g,0)&&d.$raise(i("ZeroDivisionError")),d.$divide_and_round(I,g,$)},1),w(f,"$output",function n(){var $=n.$$p||t,d=this;return delete n.$$p,""+A(d,a(d,"output",n,!1,!0),"output",[],$)+d.$rounding_method()},0),f.$private(),w(f,"$rounding_method",function(){return m(this.$class(),"ROUNDING_METHOD")},0),w(f,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),w(f,"$divide_and_round",function($,d,I){return this.$raise(i("NotImplementedError"))},3)}(b[0],v("BinaryOp"),b),function(h,y,c){var f=p(h,y,"DivideWithGameSystemDefault"),_=[f].concat(c),i=r.$r(_);K(_[0],"ROUNDING_METHOD",""),f.$private(),w(f,"$divide_and_round",function(n,$,d){var I;return E(m(i("RoundType"),"CEIL"),I=d)?S(n.$to_f(),$).$ceil():E(m(i("RoundType"),"ROUND"),I)?S(n.$to_f(),$).$round():S(n,$).$floor()},3)}(b[0],v("DivideBase"),b),function(h,y,c){var f=p(h,y,"DivideWithCeil"),_=[f].concat(c);K(_[0],"ROUNDING_METHOD","C"),f.$private(),w(f,"$divide_and_round",function(u,n,$){return S(u.$to_f(),n).$ceil()},3)}(b[0],v("DivideBase"),b),function(h,y,c){var f=p(h,y,"DivideWithRound"),_=[f].concat(c);K(_[0],"ROUNDING_METHOD","R"),f.$private(),w(f,"$divide_and_round",function(u,n,$){return S(u.$to_f(),n).$round()},3)}(b[0],v("DivideBase"),b),function(h,y,c){var f=p(h,y,"DivideWithFloor"),_=[f].concat(c);K(_[0],"ROUNDING_METHOD","F"),f.$private(),w(f,"$divide_and_round",function(u,n,$){return S(u,n).$to_i()},3)}(b[0],v("DivideBase"),b),function(h,y){var c=p(h,null,"Negative");c.$$prototype.body=t,w(c,"$initialize",function(i){return this.body=i},1),w(c,"$eval",function(i){return this.body.$eval(i)["$-@"]()},1),w(c,"$output",function(){return"-"+this.body.$output()},0),w(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(b[0]),function(h,y){var c=p(h,null,"Parenthesis");c.$$prototype.expr=t,w(c,"$initialize",function(i){return this.expr=i},1),w(c,"$eval",function(i){return this.expr.$eval(i)},1),w(c,"$output",function(){return"("+this.expr.$output()+")"},0),w(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(b[0]),function(h,y){var c=p(h,null,"Number");return c.$$prototype.value=t,w(c,"$initialize",function(i){return this.value=i},1),w(c,"$eval",function(i){return this.value},1),w(c,"$output",function(){return this.value.$to_s()},0),F(c,"s_exp","output")}(b[0])},Opal.modules.strscan=function(r){var H,B,G,W,U,M=[],t=r.nil,e=r.def,p=r.truthy,w=r.eqeqeq,A=r.Opal,a=r.send,P=r.to_a,K=r.rb_minus,E=r.alias;return H=M,G=[B=(0,r.klass)(M[0],null,"StringScanner")].concat(H),W=r.$r(G),(U=B.$$prototype).pos=U.string=U.working=U.matched=U.prev_pos=U.match=t,B.$attr_reader("pos","matched"),e(B,"$initialize",function(o){var s=this;return s.string=o,s.pos=0,s.matched=t,s.working=o,s.match=[]},1),B.$attr_reader("string"),e(B,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)},0),e(B,"$scan",function(o){var s=this,R=(o=s.$anchor(o)).exec(s.working);return null==R?s.matched=t:"object"==typeof R?(s.prev_pos=s.pos,s.pos+=R[0].length,s.working=s.working.substring(R[0].length),s.matched=R[0],s.match=R,R[0]):"string"==typeof R?(s.pos+=R.length,s.working=s.working.substring(R.length),R):t},1),e(B,"$scan_until",function(o){var s=this;o=s.$anchor(o);for(var N,R=s.pos,L=s.working;;){if(N=o.exec(L),R+=1,L=L.substr(1),null!=N)return s.matched=s.string.substr(s.pos,R-s.pos-1+N[0].length),s.match=N,s.prev_pos=R-1,s.pos=R,s.working=L.substr(N[0].length),s.matched;if(0===L.length)return s.match=[],s.matched=t}},1),e(B,"$[]",function(o){var R;if(p(this.match["$empty?"]()))return t;w(W("Symbol"),R=o)?o=o.$to_s():w(W("String"),R)||(o=A["$coerce_to!"](o,W("Integer"),"to_int"));var L=this.match;return o<0&&(o+=L.length),o<0||o>=L.length||null==L[o]?t:L[o]},1),e(B,"$check",function(o){var s=this,R=(o=s.$anchor(o)).exec(s.working);return s.matched=null==R?t:R[0]},1),e(B,"$check_until",function(o){var s=this,R=s.prev_pos,L=s.pos,N=s.$scan_until(o);return N!==t&&(s.matched=N.substr(-1),s.working=s.string.substr(L)),s.prev_pos=R,s.pos=L,N},1),e(B,"$peek",function(o){return this.working.substring(0,o)},1),e(B,"$eos?",function(){return 0===this.working.length},0),e(B,"$exist?",function(o){var R=o.exec(this.working);return null==R?t:0==R.index?0:R.index+1},1),e(B,"$skip",function(o){var s=this,R=(o=s.$anchor(o)).exec(s.working);if(null==R)return s.match=[],s.matched=t;var L=R[0],N=L.length;return s.matched=L,s.match=R,s.prev_pos=s.pos,s.pos+=N,s.working=s.working.substring(N),N},1),e(B,"$skip_until",function(o){var R=this.$scan_until(o);return R===t?t:(this.matched=R.substr(-1),R.length)},1),e(B,"$get_byte",function(){var o=this,s=t;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,s=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=t,s},0),e(B,"$match?",function(o){var s=this,R=(o=s.$anchor(o)).exec(s.working);return null==R?t:(s.prev_pos=s.pos,R[0].length)},1),e(B,"$pos=",function(o){var s=this;return o<0&&(o+=s.string.$length()),s.pos=o,s.working=s.string.slice(o)},1),e(B,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(B,"$post_match",function(){var o=this;return o.matched===t?t:o.string.substr(o.pos)},0),e(B,"$pre_match",function(){var o=this;return o.matched===t?t:o.string.substr(0,o.prev_pos)},0),e(B,"$reset",function(){var o=this;return o.working=o.string,o.matched=t,o.pos=0},0),e(B,"$rest",function(){return this.working},0),e(B,"$rest?",function(){return 0!==this.working.length},0),e(B,"$rest_size",function(){return this.$rest().$size()},0),e(B,"$terminate",function(){var s,o=this;return o.match=t,s=[o.string.$length()],a(o,"pos=",P(s)),s[K(s.length,1)]},0),e(B,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=t,o.match=t,o},0),E(B,"bol?","beginning_of_line?"),E(B,"getch","get_byte"),B.$private(),e(B,"$anchor",function(o){var s=o.toString().match(/\/([^\/]+)$/);return s=s?s[1]:void 0,new RegExp("^(?:"+o.source+")",s)},1)},Opal.modules["bcdice/normalize"]=function(r){var a,S,K,M=[],t=r.nil,m=r.module,e=r.eqeqeq,p=r.def,w=r.eqeq;return a=M,K=[m(M[0],"BCDice")].concat(a),(S=m(K[0],"Normalize")).$module_function(),p(S,"$comparison_operator",function(H){var B;return e(/<=|=</,B=H)?"<=":e(/>=|=>/,B)?">=":e(/<>|!=|=!/,B)?"!=":e(/</,B)?"<":e(/>/,B)?">":e(/=/,B)?"==":t},1),p(S,"$target_number",function(H){return w(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var S,G,s,R,L,N,b,U,H,M=r.top,t=[],m=r.nil,e=r.module,p=r.klass,w=r.const_set,A=r.hash2,a=r.truthy,P=r.send,K=r.def;return M.$require("strscan"),M.$require("bcdice/normalize"),S=t,G=H=[e(t[0],"BCDice")].concat(S),s=U=[e(H[0],"Command")].concat(G),L=[R=p(U[0],null,"Lexer")].concat(s),N=r.$r(L),(b=R.$$prototype).scanner=b.notations=m,w(L[0],"SYMBOLS",A(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(R,"$initialize",function(h,y){var c,f,i;return h=a(i=(f=(c=h)===m||null==c?m:P(c,"split",[" ",2]))===m||null==f?m:P(f,"first",[]))?i:"",this.scanner=N("StringScanner").$new(h),this.notations=P(y,"map",[],function(n){return null==n&&(n=m),a(n["$is_a?"](N("String")))?N("Regexp").$new(n):n},1)},2),K(R,"$next_token",function(){try{var h=this,y=m,c=m,_=m,i=m;return a(h.scanner["$eos?"]())?[!1,"$"]:(P(h.notations,"each",[],function u(n){var d,$=null==u.$$s?this:u.$$s;if(null==$.scanner&&($.scanner=m),null==n&&(n=m),d=$.scanner.$scan(n),!a(d))return m;r.ret(["NOTATION",d])},{$$arity:1,$$s:h}),a(y=h.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:a(c=h.scanner.$scan(/[<>!=]+/))?(c=N("Normalize").$comparison_operator(c),[a(c)?"CMP_OP":"ILLEGAL",c]):(_=h.scanner.$getch().$upcase(),[a(i=N("SYMBOLS")["$[]"](_))?i:_.$to_sym(),_]))}catch(u){if(u===r.returner)return u.$v;throw u}},0),K(R,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var P,F,U,C,o,s,R,B,E,M=[],t=r.nil,m=r.module,e=r.klass,p=r.def,w=r.truthy,A=r.eqeqeq;return P=M,F=E=[m(M[0],"BCDice")].concat(P),U=B=[m(E[0],"Command")].concat(F),o=[C=e(B[0],null,"Parsed")].concat(U),s=r.$r(o),(R=C.$$prototype).question_target=R.critical=R.fumble=R.dollar=R.modify_number=R.target_number=R.prefix_number=R.command=R.suffix_number=R.cmp_op=t,C.$attr_accessor("command"),C.$attr_accessor("prefix_number"),C.$attr_accessor("suffix_number"),C.$attr_accessor("critical"),C.$attr_accessor("fumble"),C.$attr_accessor("dollar"),C.$attr_accessor("modify_number"),C.$attr_accessor("cmp_op"),C.$attr_accessor("target_number"),C.$attr_writer("question_target"),p(C,"$initialize",function(){var N=this;return N.prefix_number=t,N.suffix_number=t,N.critical=t,N.fumble=t,N.dollar=t,N.cmp_op=t,N.target_number=t,N.question_target=!1},0),p(C,"$question_target?",function(){return this.question_target},0),p(C,"$to_s",function(N){var _,b=this,v=t,h=t,y=t,c=t,f=t;return null==N&&(N="after_command"),v=w(b.critical)?"@"+b.critical:t,h=w(b.fumble)?"#"+b.fumble:t,y=w(b.dollar)?"$"+b.dollar:t,c=s("Format").$modifier(b.modify_number),f=w(b.question_target)?"?":b.target_number,A("after_command",_=N)?[b.prefix_number,b.command,b.suffix_number,v,h,y,c,b.cmp_op,f].$join():A("after_modify_number",_)?[b.prefix_number,b.command,b.suffix_number,c,v,h,y,b.cmp_op,f].$join():A("after_target_number",_)?[b.prefix_number,b.command,b.suffix_number,c,b.cmp_op,f,v,h,y].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var s,b,_,$,d,I,g,z,T,j,l,V,ie,i,u,n,ne,h,y,L,M=r.top,t=[],m=r.$r(t),e=r.nil,p=r.$$$,w=r.klass,A=r.module,a=r.hash2,P=r.send2,K=r.find_super,E=r.def,S=r.send,F=r.to_a,H=r.rb_minus,B=r.eqeq,G=r.hash,W=r.const_set,U=r.truthy,C=r.to_ary;return M.$require("racc/parser.rb"),M.$require("bcdice/arithmetic/node"),M.$require("bcdice/command/lexer"),M.$require("bcdice/command/parsed"),w(p(m("BCDice"),"Command"),p(m("Racc"),"Parser"),"Parser"),s=t,b=L=[A(t[0],"BCDice")].concat(s),h=[A(L[0],"Command")].concat(b),y=r.$r(h),_=h,u=[i=w(h[0],p(y("Racc"),"Parser"),"Parser")].concat(_),n=r.$r(u),(ne=i.$$prototype).notations=ne.lexer=ne.modifier=ne.suffix_number=ne.prefix_number=ne.need_suffix_number=ne.need_prefix_number=ne.critical=ne.fumble=ne.dollar=ne.allowed_cmp_op=ne.question_target=e,E(i,"$initialize",function Q(D,J){var x,q,ee,re,Y=this;if(delete Q.$$p,x=r.slice.call(arguments),null==(q=r.extract_kwargs(x)))q=a([],{});else if(!q.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ee=x,!r.hasOwnProperty.call(q.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return re=q.$$smap.round_type,P(Y,K(Y,"initialize",Q,!1,!0),"initialize",[],null),Y.notations=ee,Y.round_type=re,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),E(i,"$disable_modifier",function(){return this.modifier=!1,this},0),E(i,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),E(i,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),E(i,"$has_prefix_number",function(){var D=this;return D.prefix_number=!0,D.need_prefix_number=!0,D},0),E(i,"$has_suffix_number",function(){var D=this;return D.suffix_number=!0,D.need_suffix_number=!0,D},0),E(i,"$enable_critical",function(){return this.critical=!0,this},0),E(i,"$enable_fumble",function(){return this.fumble=!0,this},0),E(i,"$enable_dollar",function(){return this.dollar=!0,this},0),E(i,"$restrict_cmp_op_to",function(D){var J,q=this;return J=r.slice.call(arguments),q.allowed_cmp_op=J,q},-1),E(i,"$enable_question_target",function(){return this.question_target=!0,this},0),E(i,"$parse",function(D){var J=this;try{return J.lexer=n("Lexer").$new(D,J.notations),J.$do_parse()}catch(x){if(!r.rescue(x,[n("ParseError"),n("ZeroDivisionError")]))throw x;try{return e}finally{r.pop_exception()}}},1),i.$private(),E(i,"$parsed",function(D,J,x,q){return S(n("Parsed").$new(),"tap",[],function re(Z){var Y,ae,se,_e,le,ue,$e=null==re.$$s?this:re.$$s,O=e;return null==$e.round_type&&($e.round_type=e),null==Z&&(Z=e),O=[D["$[]"]("command")],S(Z,"command=",F(O)),H(O.length,1),O=[(Y=D["$[]"]("prefix"),Y===e||null==Y?e:S(Y,"eval",[$e.round_type]))],S(Z,"prefix_number=",F(O)),H(O.length,1),O=[(ae=D["$[]"]("suffix"),ae===e||null==ae?e:S(ae,"eval",[$e.round_type]))],S(Z,"suffix_number=",F(O)),H(O.length,1),O=[(se=J["$[]"]("critical"),se===e||null==se?e:S(se,"eval",[$e.round_type]))],S(Z,"critical=",F(O)),H(O.length,1),O=[(_e=J["$[]"]("fumble"),_e===e||null==_e?e:S(_e,"eval",[$e.round_type]))],S(Z,"fumble=",F(O)),H(O.length,1),O=[(le=J["$[]"]("dollar"),le===e||null==le?e:S(le,"eval",[$e.round_type]))],S(Z,"dollar=",F(O)),H(O.length,1),O=[x.$eval($e.round_type)],S(Z,"modify_number=",F(O)),H(O.length,1),O=[q["$[]"]("cmp_op")],S(Z,"cmp_op=",F(O)),H(O.length,1),B(q["$[]"]("target"),"?")?(S(Z,"question_target=",F(O=[!0])),H(O.length,1),S(Z,"target_number=",F(O=[0])),O[H(O.length,1)]):(S(Z,"question_target=",F(O=[!1])),H(O.length,1),O=[(ue=q["$[]"]("target"),ue===e||null==ue?e:S(ue,"eval",[$e.round_type]))],S(Z,"target_number=",F(O)),O[H(O.length,1)])},{$$arity:1,$$s:this})},4),E(i,"$next_token",function(){return this.lexer.$next_token()},0),$=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],d=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],I=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],g=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],z=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],T=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],j=[e,6,13,3,9,-1,27,-15,-10,-1,-38],l=[e,e,e,e,e,e,19,16,15,e,e],V=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ie=G(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),W(u[0],"Racc_arg",[$,d,g,I,z,T,l,j,19,V,ie,58,35,!0]),W(u[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),W(u[0],"Racc_debug_parser",!1),E(i,"$_reduce_1",function(D,J,x){var q;return U(this.modifier)||this.$raise(n("ParseError")),q=C(D),this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],null==q[2]?e:q[2],null==q[3]?e:q[3])},3),E(i,"$_reduce_2",function(D,J,x){var q;return U(this.modifier)||this.$raise(n("ParseError")),q=C(D),this.$parsed(null==q[0]?e:q[0],null==q[2]?e:q[2],null==q[1]?e:q[1],null==q[3]?e:q[3])},3),E(i,"$_reduce_3",function(D,J,x){var q,ae;return ae=null==(q=C(D))[2]?e:q[2],this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),ae)},3),E(i,"$_reduce_4",function(D,J,x){var q=this;return U(q.prefix_number)&&U(q.suffix_number)||q.$raise(n("ParseError")),a(["command","prefix","suffix"],{command:D["$[]"](1),prefix:D["$[]"](0),suffix:D["$[]"](2)})},3),E(i,"$_reduce_5",function(D,J,x){var q=this;return U(q.prefix_number)||q.$raise(n("ParseError")),U(q.need_suffix_number)&&q.$raise(n("ParseError")),a(["command","prefix"],{command:D["$[]"](1),prefix:D["$[]"](0)})},3),E(i,"$_reduce_6",function(D,J,x){var q=this;return U(q.suffix_number)||q.$raise(n("ParseError")),U(q.need_prefix_number)&&q.$raise(n("ParseError")),a(["command","suffix"],{command:D["$[]"](0),suffix:D["$[]"](1)})},3),E(i,"$_reduce_7",function(D,J,x){var q=this;return(U(q.need_prefix_number)||U(q.need_suffix_number))&&q.$raise(n("ParseError")),a(["command"],{command:D["$[]"](0)})},3),E(i,"$_reduce_8",function(D,J,x){return a([],{})},3),E(i,"$_reduce_9",function(D,J,x){var q,ae,se,Z=e;return Z=null==(q=C(D))[0]?e:q[0],ae=null==q[2]?e:q[2],U(this.critical)&&U(Z["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),S(Z,"[]=",F(se=["critical",ae])),H(se.length,1),Z},3),E(i,"$_reduce_10",function(D,J,x){var q,ae,se,Z=e;return Z=null==(q=C(D))[0]?e:q[0],ae=null==q[2]?e:q[2],U(this.fumble)&&U(Z["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),S(Z,"[]=",F(se=["fumble",ae])),H(se.length,1),Z},3),E(i,"$_reduce_11",function(D,J,x){var q,ae,se,Z=e;return Z=null==(q=C(D))[0]?e:q[0],ae=null==q[2]?e:q[2],U(this.dollar)&&U(Z["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),S(Z,"[]=",F(se=["dollar",ae])),H(se.length,1),Z},3),E(i,"$_reduce_12",function(D,J,x){return D["$[]"](1)},3),E(i,"$_reduce_13",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))},3),E(i,"$_reduce_14",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))},3),E(i,"$_reduce_15",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))},3),E(i,"$_reduce_16",function(D,J,x){return U(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),a([],{})},3),E(i,"$_reduce_17",function(D,J,x){var q,Z,Y;return Y=null==(q=C(D))[1]?e:q[1],U(this.allowed_cmp_op["$include?"](Z=null==q[0]?e:q[0]))||this.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:Z,target:Y})},3),E(i,"$_reduce_18",function(D,J,x){var ee,q=this;return ee=D["$[]"](0),U(q.question_target)||q.$raise(n("ParseError")),U(q.allowed_cmp_op["$include?"](ee))||q.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:ee,target:"?"})},3),E(i,"$_reduce_19",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))},3),E(i,"$_reduce_20",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))},3),E(i,"$_reduce_22",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"*",D["$[]"](2))},3),E(i,"$_reduce_23",function(D,J,x){return D["$[]"](3).$new(D["$[]"](0),D["$[]"](2))},3),E(i,"$_reduce_25",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),E(i,"$_reduce_26",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),E(i,"$_reduce_27",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),E(i,"$_reduce_28",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),E(i,"$_reduce_29",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),E(i,"$_reduce_30",function(D,J,x){return D["$[]"](1)},3),E(i,"$_reduce_31",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))},3),E(i,"$_reduce_33",function(D,J,x){return D["$[]"](1)},3),E(i,"$_reduce_34",function(D,J,x){return p(p(n("Arithmetic"),"Node"),"Number").$new(D["$[]"](0))},3),E(i,"$_reduce_none",function(D,J,x){return D["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var P,F,W,U,C,o,B,E,M=[],t=r.nil,m=r.module,e=r.send,p=r.eqeqeq,w=r.truthy,A=r.def;return P=M,F=E=[m(M[0],"BCDice")].concat(P),W=B=[m(E[0],"Deprecated")].concat(F),C=[U=m(B[0],"Checker")].concat(W),o=r.$r(C),U.$private(),A(U,"$check_result_legacy",function(R,L,N,b){var c,v=this,h=t,y=t,f=t,_=t;return h=e(L,"map",[],"sides".$to_proc()),c=(y=e(L,"map",[],"value".$to_proc())).$sum(),f=p([100],_=h)?v.$check_1D100(R,c,N,b):p([20],_)?v.$check_1D20(R,c,N,b):p([6,6],_)?v.$check_2D6(R,c,y,N,b):t,(w(f["$nil?"]())||w(f["$empty?"]()))&&(f=p([10],_=h.$uniq())?v.$check_nD10(R,c,y,N,b):p([6],_)?v.$check_nD6(R,c,y,N,b):t,w(f["$nil?"]())||w(f["$empty?"]()))?t:o("Result").$new(f.$delete_prefix(" \uff1e "))},4),A(U,"$check_1D100",function(R,L,N,b){return t},4),A(U,"$check_1D20",function(R,L,N,b){return t},4),A(U,"$check_nD10",function(R,L,N,b,v){return t},5),A(U,"$check_2D6",function(R,L,N,b,v){return t},5),A(U,"$check_nD6",function(R,L,N,b,v){return t},5)},Opal.modules["bcdice/base"]=function(r){var L,y,u,$,d,c,f,_,i,b,M=r.top,t=[],m=r.$r(t),e=r.nil,p=r.$$$,w=r.module,A=r.klass,a=r.truthy,P=r.def,K=r.regexp,E=r.rb_plus,S=r.send,F=r.to_a,H=r.rb_minus,B=r.eqeqeq,G=r.eqeq,W=r.range,U=r.rb_divide,C=r.rb_times,o=r.rb_ge,s=e;return M.$require("i18n"),M.$require("i18n/backend/fallbacks"),M.$require("bcdice/randomizer"),M.$require("bcdice/dice_table"),M.$require("bcdice/enum"),M.$require("bcdice/translate"),M.$require("bcdice/result"),M.$require("bcdice/command/parser"),M.$require("bcdice/deprecated/checker"),L=t,y=b=[w(t[0],"BCDice")].concat(L),f=[c=A(b[0],null,"Base")].concat(y),_=r.$r(f),(i=c.$$prototype).sort_add_dice=i.sort_barabara_dice=i.enabled_d9=i.raw_input=i.randomizer=i.enabled_upcase_input=i.debug=e,$=[u=r.get_singleton_class(c)].concat(f),d=r.$r($),u.$attr_reader("prefixes"),P(u,"$register_prefix",function(g){var T,j=this,l=e;return null==j.prefixes&&(j.prefixes=e),T=r.slice.call(arguments),j.prefixes=a(l=j.prefixes)?l:[],j.prefixes.$concat(T.$flatten())},-1),P(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),P(u,"$prefixes_pattern",function(){var g=this,z=e;return null==g.prefixes_pattern&&(g.prefixes_pattern=e),null==g.prefixes&&(g.prefixes=e),g.prefixes_pattern=a(z=g.prefixes_pattern)?z:e,a(g.prefixes_pattern)?g.prefixes_pattern:(g.prefixes=a(z=g.prefixes)?z:[],g.prefixes.$freeze(),g.prefixes_pattern=(a(g.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",g.prefixes.$join("|"),")"],"i")).$freeze())},0),P(u,"$command_pattern",function(){var g=this,z=e,T=e;return null==g.command_pattern&&(g.command_pattern=e),null==g.prefixes&&(g.prefixes=e),g.command_pattern=a(z=g.command_pattern)?z:e,a(g.command_pattern)?g.command_pattern:(g.prefixes=a(z=g.prefixes)?z:[],g.prefixes.$freeze(),T=E(S(p(d("CommonCommand"),"COMMANDS"),"map",[],function(l){return null==l&&(l=e),p(l,"PREFIX_PATTERN").$source()},1),g.prefixes),g.command_pattern=K(["^S?(",T.$join("|"),")"],"i").$freeze())},0),P(u,"$eval",function(g){return this.$new(g).$eval()},1),c.$include(_("Translate")),c.$include(p(_("Deprecated"),"Checker")),P(c,"$initialize",function(n){var $=this;return $.raw_input=n,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=p(_("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=p(_("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=e,$.reroll_dice_reroll_threshold=e,$.default_cmp_op=e,$.default_target_number=e,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=p(_("BCDice"),"Randomizer").$new(),$.debug=!1},1),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),P(c,"$sort_add_dice?",function(){return this.sort_add_dice},0),P(c,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),P(c,"$enabled_d9?",function(){return this.enabled_d9},0),P(c,"$enable_debug",function(){return this.debug=!0},0),P(c,"$eval",function(){var $,d,I,n=this,g=e;return $=p(_("BCDice"),"Preprocessor").$process(n.raw_input,n),d=a(I=n.$dice_command($))?I:n.$eval_common_command(n.raw_input),a(d)?(g=[n.randomizer.$rand_results()],S(d,"rands=",F(g)),H(g.length,1),g=[n.randomizer.$detailed_rand_results()],S(d,"detailed_rands=",F(g)),H(g.length,1),d):e},0),P(c,"$change_text",function(n){return n},1),P(c,"$check_result",function(n,$,d,I){var g=this,z=e,T=e,j=e,l=e,V=e;return z=g.$check_result_legacy(n,$,d,I),a(z)?z:(T=S($,"map",[],"sides".$to_proc()),l=(j=S($,"map",[],"value".$to_proc())).$sum(),z=B([100],V=T)?g.$result_1d100(n,l,d,I):B([20],V)?g.$result_1d20(n,l,d,I):B([6,6],V)?g.$result_2d6(n,l,j,d,I):e,G(z,_("Result").$nothing())?e:a(z)?z:(z=B([10],V=T.$uniq())?g.$result_nd10(n,l,j,d,I):B([6],V)?g.$result_nd6(n,l,j,d,I):e,G(z,_("Result").$nothing())?e:a(z)?z:g.$result_ndx(n,d,I)))},4),P(c,"$grich_text",function(n,$,d){return e},3),c.$private(),P(c,"$eval_common_command",function(n){try{return n=this.$change_text(n),S(p(_("CommonCommand"),"COMMANDS"),"each",[],function d(I){var z,g=null==d.$$s?this:d.$$s;if(null==g.randomizer&&(g.randomizer=e),null==I&&(I=e),z=I.$eval(n,g,g.randomizer),!a(z))return e;r.ret(z)},{$$arity:1,$$s:this}),e}catch(d){if(d===r.returner)return d.$v;throw d}},1),P(c,"$dice_command",function(n){var $=this,d=e,I=e,g=e,z=e,T=e;return a($.enabled_upcase_input)&&(n=n.$upcase()),d=$.$class().$prefixes_pattern().$match(n),a(d)?(I=d["$[]"](1)["$nil?"]()["$!"](),a(I)&&(n=n["$[]"](W(1,-1,!1))),g=$.$eval_game_system_specific_command(n),a(g["$is_a?"](_("Result")))?(z=[a(T=g["$secret?"]())?T:I],S(g,"secret=",F(z)),H(z.length,1),g):a(g["$nil?"]())||a(g["$empty?"]())||G(g,"1")?e:S(_("Result").$new(),"tap",[],function(l){return null==l&&(l=e),z=[g.$to_s()],S(l,"text=",F(z)),H(z.length,1),S(l,"secret=",F(z=[I])),z[H(z.length,1)]},1)):e},1),P(c,"$eval_game_system_specific_command",function(n){return e},1),P(c,"$result_ndx",function(n,$,d){return a(d["$is_a?"](_("String")))?e:a(n.$send($,d))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))},3),P(c,"$result_1d100",function(n,$,d,I){return e},4),P(c,"$result_1d20",function(n,$,d,I){return e},4),P(c,"$result_nd10",function(n,$,d,I,g){return e},5),P(c,"$result_2d6",function(n,$,d,I,g){return e},5),P(c,"$result_nd6",function(n,$,d,I,g){return e},5),P(c,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),P(c,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),P(c,"$get_table_by_nD6",function(n,$){return this.$get_table_by_nDx(n,$,6)},2),P(c,"$get_table_by_nDx",function(n,$,d){var g,z=e;return g=this.randomizer.$roll_sum($,d),z=this.$get_table_value(n["$[]"](H(g,$))),a(z["$nil?"]())?["1",0]:[z,g]},3),P(c,"$get_table_by_1d3",function(n){var I,g,$=this,z=e;return $.$debug("get_table_by_1d3"),I=$.randomizer.$roll_sum(1,6),$.$debug("num",I),g=U(H(I,1),2).$to_i(),$.$debug("index",g),z=n["$[]"](g),a(z["$nil?"]())?["1",0]:[z,I]},1),P(c,"$get_table_by_d66_swap",function(n){var d;return d=this.randomizer.$roll_d66(p(_("D66SortType"),"ASC")),[this.$get_table_by_number(d,n),d]},1),P(c,"$get_table_by_d66",function(n){var d,I,g,T,z=e;return d=this.randomizer.$roll_once(6),I=this.randomizer.$roll_once(6),g=E(C(H(d,1),6),H(I,1)),z=n["$[]"](g),T=""+d+I,a(z["$nil?"]())?["1",T]:[z,T]},1),P(c,"$get_table_by_number",function(n,$,d){try{return null==d&&(d="1"),S($,"each",[],function g(z){var j,T=null==g.$$s?this:g.$$s;if(null==z&&(z=e),j=z["$[]"](0),!a(o(j,n)))return e;r.ret(T.$get_table_value(z["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(d)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),P(c,"$get_table_value",function(n){return a(n["$is_a?"](_("Proc")))?n.$call():n},1),P(c,"$roll_tables",function(n,$){var I=e;return I=$["$[]"](n),a(I)?I.$roll(this.randomizer).$to_s():e},2),P(c,"$debug",function(n,$){var I,g=this,z=e,T=e;return I=r.slice.call(arguments,1),a(g.debug)?(z=a(n["$is_a?"](_("String")))?n:n.$inspect(),a(I["$empty?"]())?g.$warn(z):(T=S(I,"map",[],function(l){return null==l&&(l=e),a(l["$is_a?"](_("String")))?'"'+l+'"':l.$inspect()},1),g.$warn(z+": "+T.$join(", ")))):e},-2),p(p(m("I18n"),"Backend"),"Simple").$include(p(p(m("I18n"),"Backend"),"Fallbacks")),m("I18n").$load_path()["$<<"](m("Dir")["$[]"](m("File").$join("bcdice","../../i18n/**/*.yml"))),s=["ja_jp"],S(m("I18n"),"default_locale=",F(s)),H(s.length,1),s=[["ja_jp"]],S(m("I18n").$fallbacks(),"defaults=",F(s)),s[H(s.length,1)]},Opal.modules["bcdice/game_system/DesperateRun"]=function(r){var L,h,u,n,$,d,c,f,b,t=[],m=r.nil,e=r.$$$,p=r.module,w=r.klass,A=r.const_set,a=r.hash2,P=r.send2,K=r.find_super,E=r.def,S=r.truthy,F=r.to_ary,H=r.rb_plus,B=r.range,G=r.neqeq,W=r.eqeq,U=r.rb_ge,C=r.send,o=r.to_a,s=r.rb_minus;return r.top.$require("bcdice/base"),L=t,h=b=[p(t[0],"BCDice")].concat(L),c=[p(b[0],"GameSystem")].concat(h),f=r.$r(c),u=c,$=[n=w(c[0],f("Base"),"DesperateRun")].concat(u),d=r.$r($),n.$$prototype.randomizer=m,A($[0],"ID","DesperateRun"),A($[0],"NAME","Desperate Run TRPG"),A($[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),A($[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),A($[0],"TABLES",a(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:e(d("DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:e(d("DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:e(d("DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:e(d("DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:e(d("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:e(d("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),n.$register_prefix("RC","DDC",d("TABLES").$keys()),E(n,"$initialize",function g(z){var j=this;return delete g.$$p,P(j,K(j,"initialize",g,!1,!0),"initialize",[z],null),j.sort_add_dice=!0,j.d66_sort_type=e(d("D66SortType"),"ASC")},1),n.$private(),E(n,"$eval_game_system_specific_command",function(z){var j,l,T=this;return S(j=S(l=T.$check_roll(z))?l:T.$ddc_table(z))?j:T.$roll_tables(z,e(T.$class(),"TABLES"))},1),E(n,"$check_roll",function(z){var T,j,k=m,X=m,ie=m,te=m,ce=m,ne=m,Q=m,D=m,x=m;return k=e(d("Command"),"Parser").$new(/RC\d+/,a(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(m).$parse(z),S(k)?(j=this.randomizer.$roll_barabara(2,6),T=F(j),te=H(X=null==T[0]?m:T[0],ie=null==T[1]?m:T[1]),ce=H(H(X,ie),k.$modify_number()),ne=k.$command()["$[]"](B(2,-1,!1)).$to_i(),G(k.$modify_number(),0)&&(Q="\u3000\u4fee\u6b63\u5024\uff1a"+k.$modify_number()),x=[["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+ne+Q,"\u51fa\u76ee\uff1a"+X+"\u3001"+ie,(D=W(X,ie)?d("Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):W(te,7)?d("Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):S(U(ce,ne))?d("Result").$success(ce+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):d("Result").$failure(ce+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011")).$text()].$join(" \uff1e ")],C(D,"text=",o(x)),s(x.length,1),D):m},1),E(n,"$ddc_table",function(z){var T,j,V=m,k=m,X=m,ie=m,te=m;return G(z,"DDC")?m:(j=this.randomizer.$roll_barabara(2,6),j=[V=null==(T=F(j))[0]?m:T[0],k=null==T[1]?m:T[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+V+"\u3001"+k+" \uff1e "+(ie=null==(T=F(j))[1]?m:T[1])+"-"+(X=null==T[0]?m:T[0])+"="+(te=s(ie,X))+" \uff1e \u96e3\u6613\u5ea6"+H(5,te))},1)},Opal.queue(function(r){var K,H,o,s,R,L,G,W,S,t=[],e=r.$$$,p=r.module,w=r.klass,A=r.const_set,a=r.hash2;return r.top.$require("bcdice/game_system/DesperateRun"),K=t,H=S=[p(t[0],"BCDice")].concat(K),G=[p(S[0],"GameSystem")].concat(H),W=r.$r(G),o=G,R=[s=w(G[0],W("DesperateRun"),"JekyllAndHyde")].concat(o),L=r.$r(R),A(R[0],"ID","JekyllAndHyde"),A(R[0],"NAME","\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9"),A(R[0],"SORT_KEY","\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089"),A(R[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u76ee\u6a19\u6c7a\u5b9a\u8868\u3000GOALT\n"),A(R[0],"TABLES",a(["GOALT"],{GOALT:e(L("DiceTable"),"Table").$new("\u76ee\u6a19\u6c7a\u5b9a\u8868","1D6",["\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d\u306e\u3069\u308c\u304b\u3092\u81ea\u7531\u306b\u9078\u3079\u308b"])}).$freeze()),s.$register_prefix("RC","DDC",L("TABLES").$keys())})}}]);