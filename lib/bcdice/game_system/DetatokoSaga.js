(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5413],{3264:(ne,oe,F)=>{F(9993),Opal.queue(function(n){var U,O,le,o,y,b,B,te,w,z=[],e=n.nil,v=n.$$$,J=n.module,I=n.klass,E=n.const_set,j=n.send2,G=n.find_super,_=n.def,S=n.truthy,q=n.send,c=n.hash2,$=n.rb_plus,p=n.to_ary,D=n.eqeqeq,A=n.rb_minus,W=n.eqeq,H=n.neqeq,V=n.rb_ge,K=n.rb_gt,N=n.rb_divide,P=n.rb_times,Y=n.defs;return U=z,O=w=[J(z[0],"BCDice")].concat(U),B=[J(w[0],"GameSystem")].concat(O),te=n.$r(B),le=B,y=[o=I(B[0],te("Base"),"DetatokoSaga")].concat(le),b=n.$r(y),o.$$prototype.randomizer=e,E(y[0],"ID","DetatokoSaga"),E(y[0],"NAME","\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac"),E(y[0],"SORT_KEY","\u3066\u305f\u3068\u3053\u3055\u3042\u304b"),E(y[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000xDS or xDSy or xDS>=t or xDSy>=t or xDS+z>=t or xDSy+z>=t\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10)\u3001t\uff1d\u76ee\u6a19\u5024(\u7701\u7565\u6642\uff18))\n\u3000\u4f8b\uff093DS\u30002DS5\u30000DS\u30003DS>=10\u30003DS7>=12 2DS3+1 3DS2+1>=10\n\u30fb\u5224\u5b9a\u5024\u3000xJD or xJDy or xJDy+z or xJDy-z or xJDy/z\n\u3000(x\uff1d\u30b9\u30ad\u30eb\u30e9\u30f3\u30af\u3001y\uff1d\u73fe\u5728\u30d5\u30e9\u30b0\u5024(\u7701\u7565\u66420)\u3001z\uff1d\u4fee\u6b63\u5024(\u7701\u7565\u6642\uff10))\n\u3000\u4f8b\uff093JD\u30002JD5\u30003JD7+1\u30004JD/3\n\u30fb\u4f53\u529b\u70d9\u5370\u8868\u3000SST (StrengthStigmaTable)\n\u30fb\u6c17\u529b\u70d9\u5370\u8868\u3000WST (WillStigmaTable)\n\u30fb\u4f53\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000SBET (StrengthBadEndTable)\n\u30fb\u6c17\u529b\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\u8868\u3000WBET (WillBadEndTable)\n"),o.$register_prefix("\\d+DS","\\d+JD"),_(o,"$initialize",function g(a){var t=this;return delete g.$$p,j(t,G(t,"initialize",g,!1,!0),"initialize",[a],null),t.sort_add_dice=!0,t.d66_sort_type=v(b("D66SortType"),"ASC")},1),_(o,"$eval_game_system_specific_command",function(a){var r=this,t=e,l=e;return r.$debug("eval_game_system_specific_command begin string",a),t=r.$checkRoll(a),S(t)||(t=r.$checkJudgeValue(a),S(t))?t:(r.$debug("\u5404\u7a2e\u8868\u3068\u3057\u3066\u51e6\u7406"),r.$roll_tables(S(l=b("ALIAS")["$[]"](a))?l:a,v(r.$class(),"TABLES")))},1),_(o,"$checkRoll",function(a){var r,t,l,i=this,f=e,x=e,R=e,h=e,s=e,k=e,d=e,u=e,m=e,T=e,L=e,M=e;return i.$debug("checkRoll begin string",a),f=/^(\d+)DS(\d+)?(([+-\/])(\d+))?(?:>=(\d+))?$/i.$match(a),S(f)?(x=f["$[]"](1).$to_i(),R=f["$[]"](2).$to_i(),h=f["$[]"](4),s=f["$[]"](5).$to_i(),k=S(d=(r=f["$[]"](6))===e||null==r?e:q(r,"to_i",[]))?d:8,u=i.$translate("DetatokoSaga.DS.input_options",c(["skill","flag","target"],{skill:x,flag:R,target:k})),m=i.$getModifyText(h,s),S(m["$empty?"]())||(u=$(u,i.$translate("DetatokoSaga.DS.modifier",c(["modifier"],{modifier:m})))),l=i.$getRollResult(x),t=p(l),u=$(u," \uff1e "+(T=null==t[0]?e:t[0])+"["+(null==t[1]?e:t[1])+"]"+m),L=i.$getTotalResultValue(T,s,h),u=$(u," \uff1e "+L),S(m["$empty?"]())||(D("+",d=h)?T=$(T,s):D("-",d)&&(T=A(T,s))),M=i.$getSuccess(T,k),u=$(u," \uff1e "+M),u=$(u,i.$getCheckFlagResult(T,R))):e},1),_(o,"$getRollResult",function(a){var i,t=e,l=e;return t=$(a,1),W(a,0)&&(t=3),i=(l=this.randomizer.$roll_barabara(t,6)).$join(","),l=l.$sort(),H(a,0)&&(l=l.$reverse()),[$(l["$[]"](0),l["$[]"](1)),i]},1),_(o,"$getSuccess",function(a,r){return S(V(a,r))?this.$translate("DetatokoSaga.DS.success"):this.$translate("DetatokoSaga.DS.failure")},2),_(o,"$getCheckFlagResult",function(a,r){var l=e;return S(K(a,r))?"":(l=this.$getDownWill(r),this.$translate("DetatokoSaga.less_than_flag",c(["will"],{will:l})))},2),_(o,"$getDownWill",function(a){return S(V(a,10))?"6":"1D6->"+this.randomizer.$roll_once(6)},1),_(o,"$checkJudgeValue",function(a){var r,t,l=this,i=e,f=e,x=e,R=e,h=e,s=e,k=e,d=e,m=e;return l.$debug("checkJudgeValue begin string",a),i=/^(\d+)JD(\d+)?(([+-\/])(\d+))?$/i.$match(a),S(i)?(f=i["$[]"](1).$to_i(),x=i["$[]"](2).$to_i(),R=i["$[]"](4),h=i["$[]"](5).$to_i(),s=l.$translate("DetatokoSaga.JD.input_options",c(["skill","flag"],{skill:f,flag:x})),k=l.$getModifyText(R,h),S(k["$empty?"]())||(s=$(s,l.$translate("DetatokoSaga.JD.modifier",c(["modifier"],{modifier:k})))),t=l.$getRollResult(f),r=p(t),s=$(s," \uff1e "+(d=null==r[0]?e:r[0])+"["+(null==r[1]?e:r[1])+"]"+k),m=l.$getTotalResultValue(d,h,R),s=$(s," \uff1e "+m),s=$(s,l.$getCheckFlagResult(d,x))):e},1),_(o,"$getModifyText",function(a,r){var l=e;return W(r,0)?"":(D("+",l=a)?"\uff0b":D("-",l)?"\uff0d":D("/",l)?"\xf7":"")+r},2),_(o,"$getTotalResultValue",function(a,r,t){var i,l=this;return D("+",i=t)?$(a+"+"+r+" \uff1e ",l.$translate("DetatokoSaga.total_value",c(["total"],{total:$(a,r)}))):D("-",i)?$(a+"-"+r+" \uff1e ",l.$translate("DetatokoSaga.total_value",c(["total"],{total:A(a,r)}))):D("/",i)?l.$getTotalResultValueWhenSlash(a,r):l.$translate("DetatokoSaga.total_value",c(["total"],{total:a}))},3),_(o,"$getTotalResultValueWhenSlash",function(a,r){var l=e;return W(r,0)?this.$translate("DetatokoSaga.division_by_zero_error"):(l=N(P(1,a),r).$ceil(),$(a+"\xf7"+r+" \uff1e ",this.$translate("DetatokoSaga.total_value",c(["total"],{total:l}))))},2),E(y[0],"ALIAS",q(c(["StrengthStigmaTable","WillStigmaTable","StrengthBadEndTable","WillBadEndTable"],{StrengthStigmaTable:"SST",WillStigmaTable:"WST",StrengthBadEndTable:"SBET",WillBadEndTable:"WBET"}),"transform_keys",[],"upcase".$to_proc()).$freeze()),Y(o,"$translate_tables",function(a){return c(["SST","WST","SBET","WBET"],{SST:v(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SST",a),WST:v(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WST",a),SBET:v(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.SBET",a),WBET:v(b("DiceTable"),"Table").$from_i18n("DetatokoSaga.table.WBET",a)})},1),E(y[0],"TABLES",o.$translate_tables("ja_jp").$freeze()),o.$register_prefix(b("TABLES").$keys(),b("ALIAS").$keys())})}}]);