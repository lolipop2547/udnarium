(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5811],{7740:(V,X,T)=>{T(9993),Opal.modules["bcdice/normalize"]=function(o){var k,l,c,N=[],q=o.nil,t=o.module,p=o.eqeqeq,g=o.def,w=o.eqeq;return k=N,c=[t(N[0],"BCDice")].concat(k),(l=t(c[0],"Normalize")).$module_function(),g(l,"$comparison_operator",function(u){var _;return p(/<=|=</,_=u)?"<=":p(/>=|=>/,_)?">=":p(/<>|!=|=!/,_)?"!=":p(/</,_)?"<":p(/>/,_)?">":p(/=/,_)?"==":q},1),g(l,"$target_number",function(u){return w(u,"?")?u:u.$to_i()},1)},Opal.modules["bcdice/format"]=function(o){var c,u,_,f,S,l,N=[],q=o.nil,t=o.module,p=o.eqeqeq,g=o.def,w=o.truthy,W=o.eqeq,k=o.rb_gt;return c=N,u=l=[t(N[0],"BCDice")].concat(c),f=[_=t(l[0],"Format")].concat(u),S=o.$r(f),_.$module_function(),g(_,"$comparison_operator",function(h){var C;return p("==",C=h)?"=":p("!=",C)?"<>":p(S("Symbol"),C)?h.$to_s():q},1),g(_,"$modifier",function(h){return w(h["$nil?"]())?q:W(h,0)?"":w(k(h,0))?"+"+h:h.$to_s()},1)},Opal.queue(function(o){var C,K,J,Q,U,n,v,z,y,E,D,Y,F,N=o.top,q=[],t=o.nil,p=o.module,g=o.klass,w=o.const_set,W=o.send2,k=o.find_super,d=o.def,c=o.truthy,j=o.to_ary,l=o.rb_plus,A=o.regexp,u=o.send,_=o.to_a,f=o.rb_minus,S=o.eqeq,B=o.neqeq;return N.$require("bcdice/normalize"),N.$require("bcdice/format"),C=q,K=F=[p(q[0],"BCDice")].concat(C),D=[p(F[0],"GameSystem")].concat(K),Y=o.$r(D),J=D[0],Q=Y("Base"),U=D,z=[v=g(J,Q,"NightWizard")].concat(U),y=o.$r(z),(E=v.$$prototype).nw_command=E.randomizer=E.total=E.interim_expr=E.status=E.fumble_numbers=E.critical_numbers=t,w(z[0],"ID","NightWizard"),w(z[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),w(z[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),w(z[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),v.$register_prefix("([-+]?\\d+)?NW","2R6"),d(v,"$initialize",function b(a){var r=this;return delete b.$$p,W(r,k(r,"initialize",b,!1,!0),"initialize",[a],null),r.nw_command="NW"},1),d(v,"$eval_game_system_specific_command",function(a){var n,r,s,$=this,e=t,i=t,m=t,P=t,x=t;return e=c(s=$.$parse_nw(a))?s:$.$parse_2r6(a),c(e)?(r=$.$roll_nw(e),i=null==(n=j(r))[0]?t:n[0],m=null==n[1]?t:n[1],P=null==n[2]?t:n[2],x=c(e.$cmp_op())?c(i.$send(e.$cmp_op(),e.$target_number()))?"\u6210\u529f":"\u5931\u6557":t,["("+e+")",m,P,i.$to_s(),x].$compact().$join(" \uff1e ")):t},1),v.$private(),(n=g(z[0],null,"Parsed")).$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number"),function(b,a,n){var r=g(b,a,"ParsedNW"),$=[r].concat(n),e=o.$r($),s=r.$$prototype;s.base=s.modify_number=s.active_modify_number=s.prana=s.command=s.critical_numbers=s.fumble_numbers=s.cmp_op=s.target_number=t,r.$attr_accessor("base"),r.$attr_accessor("modify_number"),d(r,"$initialize",function i(m){var x=this;return delete i.$$p,W(x,k(x,"initialize",i,!1,!0),"initialize",[],null),x.command=m},1),d(r,"$passive_modify_number",function(){return l(this.base,this.modify_number)},0),d(r,"$to_s",function(){var P,x,R,M,G,m=this;return P=c(m.base["$zero?"]())?t:m.base,x=e("Format").$modifier(m.modify_number),R=e("Format").$modifier(m.active_modify_number),M=c(G=m.prana)?"$"+m.prana:G,""+P+m.command+x+"@"+m.critical_numbers.$join(",")+"#"+m.fumble_numbers.$join(",")+M+R+m.cmp_op+m.target_number},0)}(z[0],y("Parsed"),z),function(b,a){var n=g(b,a,"Parsed2R6"),r=n.$$prototype;r.passive_modify_number=r.active_modify_number=r.critical_numbers=r.fumble_numbers=r.cmp_op=r.target_number=t,n.$attr_accessor("passive_modify_number"),d(n,"$to_s",function(){var e=this;return"2R6M["+e.passive_modify_number+","+e.active_modify_number+"]C["+e.critical_numbers.$join(",")+"]F["+e.fumble_numbers.$join(",")+"]"+e.cmp_op+e.target_number},0)}(z[0],y("Parsed")),d(v,"$parse_nw",function(a){var n,r,e=t,s=t,i=t;return e=A(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(a),c(e)?(s=y("ParsedNW").$new(this.nw_command),i=[e["$[]"](1).$to_i()],u(s,"base=",_(i)),f(i.length,1),i=[y("ArithmeticEvaluator").$eval(e["$[]"](2))],u(s,"modify_number=",_(i)),f(i.length,1),i=[c(e["$[]"](3))?u(e["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],u(s,"critical_numbers=",_(i)),f(i.length,1),i=[c(e["$[]"](4))?u(e["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],u(s,"fumble_numbers=",_(i)),f(i.length,1),i=[(n=e["$[]"](5),n===t||null==n?t:u(n,"to_i",[]))],u(s,"prana=",_(i)),f(i.length,1),i=[y("ArithmeticEvaluator").$eval(e["$[]"](6))],u(s,"active_modify_number=",_(i)),f(i.length,1),i=[y("Normalize").$comparison_operator(e["$[]"](7))],u(s,"cmp_op=",_(i)),f(i.length,1),i=[(r=e["$[]"](8),r===t||null==r?t:u(r,"to_i",[]))],u(s,"target_number=",_(i)),f(i.length,1),s):t},1),d(v,"$parse_2r6",function(a){var n,r=t,$=t,e=t;return r=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(a),c(r)?($=y("Parsed2R6").$new(),e=[y("ArithmeticEvaluator").$eval(r["$[]"](1))],u($,"passive_modify_number=",_(e)),f(e.length,1),e=[y("ArithmeticEvaluator").$eval(r["$[]"](2))],u($,"active_modify_number=",_(e)),f(e.length,1),e=[c(r["$[]"](3))?u(r["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],u($,"critical_numbers=",_(e)),f(e.length,1),e=[c(r["$[]"](4))?u(r["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],u($,"fumble_numbers=",_(e)),f(e.length,1),e=[y("Normalize").$comparison_operator(r["$[]"](5))],u($,"cmp_op=",_(e)),f(e.length,1),e=[(n=r["$[]"](6),n===t||null==n?t:u(n,"to_i",[]))],u($,"target_number=",_(e)),f(e.length,1),$):t},1),d(v,"$roll_nw",function(a){var r=this,$=t,e=t,s=t,i=t,m=t;for(r.critical_numbers=a.$critical_numbers(),r.fumble_numbers=a.$fumble_numbers(),r.total=0,r.interim_expr="",r.status=t,$=r.$roll_once_first();S($,"critical");)$=r.$roll_once();return B($,"fumble")&&c(a.$prana())&&(s=(e=r.randomizer.$roll_barabara(a.$prana(),6)).$sum(),i=e.$join(","),r.total=l(r.total,s),r.interim_expr=l(r.interim_expr,"+"+s+"["+i+"]")),m=S($,"fumble")?r.$fumble_base_number(a):l(a.$passive_modify_number(),a.$active_modify_number()),r.total=l(r.total,m),r.interim_expr=l(m.$to_s(),r.interim_expr),[r.total,r.interim_expr,r.status]},1),d(v,"$roll_once",function(a){var $,e,n=this,r=t;return null==a&&(a=!1),$=(r=n.randomizer.$roll_barabara(2,6)).$sum(),e=r.$join(","),c(a)&&c(n.fumble_numbers["$include?"]($))?(n.total=f(n.total,10),n.interim_expr=l(n.interim_expr,"-10["+e+"]"),n.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):c(n.critical_numbers["$include?"]($))?(n.total=l(n.total,10),n.interim_expr=l(n.interim_expr,"+10["+e+"]"),n.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(n.total=l(n.total,$),n.interim_expr=l(n.interim_expr,"+"+$+"["+e+"]"),t)},-1),d(v,"$roll_once_first",function(){return this.$roll_once(!0)},0),d(v,"$fumble_base_number",function(a){return a.$passive_modify_number()},1)})}}]);