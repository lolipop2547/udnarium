(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[6604],{3042:(J,Q,G)=>{G(9993),Opal.queue(function($){var N,L,Y,g,x,b,p,j,B,D=[],r=$.nil,E=$.module,I=$.klass,k=$.const_set,O=$.send,c=$.def,f=$.truthy,A=$.to_ary,R=$.rb_gt,l=$.rb_plus,K=$.neqeq,M=$.eqeq,v=$.eqeqeq,S=$.rb_lt,y=$.rb_minus,C=$.rb_le,q=$.rb_divide;return N=D,L=B=[E(D[0],"BCDice")].concat(N),p=[E(B[0],"GameSystem")].concat(L),j=$.$r(p),Y=p,x=[g=I(p[0],j("Base"),"Torg")].concat(Y),b=$.$r(x),g.$$prototype.randomizer=r,k(x[0],"ID","Torg"),k(x[0],"NAME","\u30c8\u30fc\u30b0"),k(x[0],"SORT_KEY","\u3068\u304a\u304f"),k(x[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u3000(TGm)\n\u3000TORG\u5c02\u7528\u306e\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n\u3000"TG(\u6280\u80fd\u57fa\u672c\u5024)"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u5404\u7a2e\u8868\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u4e00\u822c\u7d50\u679c\u8868 \u6210\u529f\u5ea6\u51fa\u529b\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u5a01\u5727/\u5a01\u5687 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cITx or INTIMIDATEx or TESTx\u300d\n\u3000\u30fb\u6311\u767a/\u30c8\u30ea\u30c3\u30af \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cTTx or TAUNTx or TRICKx or CTx\u300d\n\u3000\u30fb\u9593\u5408\u3044 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cMTx or MANEUVERx\u300d\n\u3000\u30fb\u30aa\u30fc\u30ba\uff08\u4e00\u822c\u4eba\uff09\u30c0\u30e1\u30fc\u30b8\u3000\u300cODTx or ORDSx or ODAMAGEx\u300d\n\u3000\u30fb\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u30fc\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),g.$register_prefix("TG","1R20","RT","Result","IT","Intimidate","Test","TT","Taunt","Trick","CT","MT","Maneuver","ODT","ords","odamage","DT","damage","BT","bonus","total"),c(g,"$replace_text",function(e){return e=(e=(e=(e=(e=(e=(e=e.$gsub(/Result/i,"RT")).$gsub(/(Intimidate|Test)/i,"IT")).$gsub(/(Taunt|Trick|CT)/i,"TT")).$gsub(/Maneuver/i,"MT")).$gsub(/(ords|odamage)/i,"ODT")).$gsub(/damage/i,"DT")).$gsub(/(bonus|total)/i,"BT"),(e=O(e,"gsub",[/TG(\d+)/i],function(){return"1R20+"+b("Regexp").$last_match(1)},0)).$gsub(/TG/i,"1R20")},1),c(g,"$torg_check",function(e){var _,t,o=this,n=r,u=r,i=r,s=r,a=r,T=r;return f(/(^|\s)S?(1R20([+-]\d+)*)(\s|$)/i["$=~"](e))?(e=b("Regexp").$last_match(2),n=b("Regexp").$last_match(3),o.$debug(n),f(n)&&(n=b("ArithmeticEvaluator").$eval(n)),o.$debug(n),n=n.$to_i(),t=o.$torg_dice(),i=null==(_=A(t))[1]?r:_[1],s=null==_[2]?r:_[2],a=o.$get_torg_bonus(u=null==_[0]?r:_[0]),T=f(n)?f(R(n,0))?a+"["+s+"]+"+n:a+"["+s+"]"+n:a+"["+s+"]",T=l(T,l(" \uff1e ",l(a,n).$to_s())),K(u,i)&&(T=l(T,l(l("(\u6280\u80fd\u7121",l(o.$get_torg_bonus(i),n).$to_s()),")"))),T="("+e+") \uff1e "+T):r},1),c(g,"$torg_dice",function(){var t=r,o=r,n=r,u=r,i=r,s=r;for(t=!0,o=!0,n=0,u=0,i="";f(t);)s=this.randomizer.$roll_once(20),n=l(n,s),f(o)&&(u=l(u,s)),f(i["$empty?"]())||(i=l(i,",")),i=l(i,s.$to_s()),M(s,20)?o=!1:K(s,10)&&(t=!1,o=!1);return[n,u,i]},0),c(g,"$eval_game_system_specific_command",function(e){var _,t,u,o=this,n=r,i=r,s=r,a=r,T=r,m=r,h=r;return n=e.$upcase(),n=o.$replace_text(n),f(u=o.$torg_check(n))?u:(i="1",s="",a=0,f(/([RITMDB]T)(\d+([+\-]\d+)*)/i["$=~"](n))?(T=b("Regexp").$last_match(1),m=b("Regexp").$last_match(2),v("RT",h=T)?(a=b("ArithmeticEvaluator").$eval(m),i=o.$get_torg_success_level(a),s="\u4e00\u822c\u7d50\u679c"):v("IT",h)?(a=b("ArithmeticEvaluator").$eval(m),i=o.$get_torg_interaction_result_intimidate_test(a),s="\u5a01\u5727/\u5a01\u5687"):v("TT",h)?(a=b("ArithmeticEvaluator").$eval(m),i=o.$get_torg_interaction_result_taunt_trick(a),s="\u6311\u767a/\u30c8\u30ea\u30c3\u30af"):v("MT",h)?(a=b("ArithmeticEvaluator").$eval(m),i=o.$get_torg_interaction_result_maneuver(a),s="\u9593\u5408\u3044"):v("DT",h)?(a=b("ArithmeticEvaluator").$eval(m),f(n["$=~"](/ODT/i))?(i=o.$get_torg_damage_ords(a),s="\u30aa\u30fc\u30ba\u30c0\u30e1\u30fc\u30b8"):(i=o.$get_torg_damage_posibility(a),s="\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8")):v("BT",h)&&(t=o.$get_torg_bonus_text(m),i=null==(_=A(t))[0]?r:_[0],a=null==_[1]?r:_[1],s="\u30dc\u30fc\u30ca\u30b9"),K(s,"")&&(i=s+"\u8868["+a+"] \uff1e "+i),i):r)},1),c(g,"$get_torg_success_level",function(e){return this.$get_torg_table_result(e,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])},1),c(g,"$get_torg_interaction_result_intimidate_test",function(e){return this.$get_torg_table_result(e,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),c(g,"$get_torg_interaction_result_taunt_trick",function(e){return this.$get_torg_table_result(e,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),c(g,"$get_torg_interaction_result_maneuver",function(e){return this.$get_torg_table_result(e,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u75b2\u52b4"],[10,"\u840e\u7e2e\uff0f\u75b2\u52b4"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},1),c(g,"$get_torg_table_result",function(e,_){var t=r;return t="1",function(){var o=$.new_brk();try{O(_,"each",[],function(u){var i;return null==u&&(u=r),i=u["$[]"](0),f(R(i,e))&&$.brk(r,o),t=u["$[]"](1)},{$$arity:1,$$brk:o})}catch(n){if(n===o)return n.$v;throw n}}(),t},2),c(g,"$get_torg_damage_ords",function(e){return this.$get_torg_damage(e,4,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15",[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"O3"],[5,"K3"],[6,"\u8ee2\u5012 K\uff0fO4"],[7,"\u8ee2\u5012 K\uff0fO5"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO9"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO10"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO11"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO12"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO13"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO14"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15"]])},1),c(g,"$get_torg_damage_posibility",function(e){return this.$get_torg_damage(e,3,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5",[[0,"1"],[1,"1"],[2,"O1"],[3,"K2"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 O2"],[7,"\u8ee2\u5012 K2"],[8,"\u8ee2\u5012 K2"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K5"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])},1),c(g,"$get_torg_damage",function(e,_,t,o){var u=r,i=r;return f(S(e,0))?"1":(u=y(o.$length(),1),f(C(e,u))?this.$get_torg_table_result(e,o):(i=q(y(e,u),2).$to_i(),l(l("",l(i,_).$to_s()),t)))},4),c(g,"$get_torg_bonus_text",function(e){var n,_=this,t=r,o=r,u=r,i=r;return o=(t=e.$split(/\+/)).$shift().$to_i(),n=b("ArithmeticEvaluator").$eval(t.$join("+")),u=_.$get_torg_bonus(o),_.$debug("TORG BT resultValue",u),_.$debug("TORG BT mod",n),M(n,0)?i=u.$to_s():(i=_.$getTorgBonusOutputTextWhenModDefined(o,u,n),o=o+"+"+n),[i,o]},1),c(g,"$getTorgBonusOutputTextWhenModDefined",function(e,_,t){var o=this;return o.$debug("getTorgBonusOutputTextWhenModDefined value, mod",e,t),f(R(t,0))?_+"["+e+"]+"+t+" \uff1e "+l(_,t):(o.$debug("resultValue",_),o.$debug("mod",t),_+"["+e+"]"+t+" \uff1e "+l(_,t))},3),c(g,"$get_torg_bonus",function(e){var o=r,n=r;return o=this.$get_torg_table_result(e,[[1,-12],[2,-10],[3,-8],[5,-5],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),f(R(e,20))&&(n=l(q(y(e,21),5).$to_i(),1),o=l(o,n)),o},1)})}}]);