(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2399],{5563:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var W,s,N,P,C,o,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.class_variable_set,E=r.truthy,I=r.class_variable_get,a=r.def,B=r.send,X=r.to_a,L=r.rb_minus,M=r.send2,G=r.find_super,H=r.hash2,F=r.find_block_super,j=r.neqeq;return W=U,o=[C=e(U[0],"I18n")].concat(W),y(o[0],"@@fallbacks",t),s=r.get_singleton_class(C),N=[s].concat(o),P=r.$r(N),a(s,"$fallbacks",function(){var T=t;return y(N[1],"@@fallbacks",E(null!=N[1].$$cvars["@@fallbacks"]?"class variable":t)&&E(T=I(N[1],"@@fallbacks",!1))?T:m(m(P("I18n"),"Locale"),"Fallbacks").$new()),E(T=P("Thread").$current()["$[]"]("i18n_fallbacks"))?T:I(N[1],"@@fallbacks",!1)},0),a(s,"$fallbacks=",function(b){var T;return y(N[1],"@@fallbacks",E(b["$is_a?"](P("Array")))?m(m(P("I18n"),"Locale"),"Fallbacks").$new(b):b),T=["i18n_fallbacks",I(N[1],"@@fallbacks",!1)],B(P("Thread").$current(),"[]=",X(T)),T[L(T.length,1)]},1),function(s,S){var b,T,x,c,P=[e(s,"Backend")].concat(S);return b=P,x=[T=e(P[0],"Fallbacks")].concat(b),c=r.$r(x),a(T,"$translate",function f(_,$,u){try{var n=f.$$p||t,i=this,v=t,z=t;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),E(u.$fetch("fallback",!0))?E(u["$[]"]("fallback_in_progress"))?M(i,G(i,"translate",f,!1,!0),"translate",[_,$,u],n):(E(u["$[]"]("default"))&&(v=i["$extract_non_symbol_default!"](u)),z=u.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),B(c("I18n").$fallbacks()["$[]"](_),"each",[],function g(w){var q=null==g.$$s?this:g.$$s;null==w&&(w=t);try{return B(q,"catch",["exception"],function p(){var l=null==p.$$s?this:p.$$s,A=t;if(A=M(l,F(l,"translate",p.$$def||g.$$def||f,!1,!1),"translate",[w,$,z],null),E(A["$nil?"]()))return t;j(_.$to_s(),w.$to_s())&&l.$on_fallback(_,w,$,u),r.ret(A)},{$$arity:0,$$s:q})}catch(p){if(!r.rescue(p,[m(c("I18n"),"InvalidLocale")]))throw p;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),E(u["$key?"]("default"))&&E(u["$[]"]("default")["$nil?"]())?t:E(v)?M(i,G(i,"translate",f,!1,!0),"translate",[_,t,u.$merge(H(["default"],{default:v}))],null):i.$throw("exception",m(c("I18n"),"MissingTranslation").$new(_,$,u))):M(i,G(i,"translate",f,!1,!0),"translate",[_,$,u],n)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),a(T,"$extract_non_symbol_default!",function(_){var u,$=t,n=t;return $=[_["$[]"]("default")].$flatten(),u=B($,"detect",[],function(v){return null==v&&(v=t),v["$is_a?"](c("Symbol"))["$!"]()},1),E(u)&&(n=["default",$["$[]"](0,$.$index(u))],B(_,"[]=",X(n)),L(n.length,1)),u},1),a(T,"$exists?",function f(_,$,u){try{var n=f.$$p||t,i=this;return delete f.$$p,null==u&&(u=c("EMPTY_HASH")),E(u.$fetch("fallback",!0))?(B(c("I18n").$fallbacks()["$[]"](_),"each",[],function v(z){var g=null==v.$$s?this:v.$$s;null==z&&(z=t);try{if(!E(M(g,F(g,"exists?",v.$$def||f,!1,!1),"exists?",[z,$],null)))return t;r.ret(!0)}catch(w){if(!r.rescue(w,[m(c("I18n"),"InvalidLocale")]))throw w;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):M(i,G(i,"exists?",f,!1,!0),"exists?",[_,$,u],n)}catch(v){if(v===r.returner)return v.$v;throw v}},-3),T.$private(),a(T,"$on_fallback",function(_,$,u,n){return t},4)}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(r){var C,h,b,T,x,c,s,S,U=[],t=r.nil,m=r.$$$,y=r.klass,E=r.const_set,I=r.def,a=r.truthy,B=r.rb_gt,X=r.rb_plus,L=r.rb_le,M=r.send,G=r.rb_minus,H=r.eqeq,F=r.rb_times,j=r.eqeqeq,J=r.rb_ge;return C=U,s=[(0,r.module)(U[0],"BCDice")].concat(C),S=r.$r(s),h=s,T=[b=y(s[0],null,"Randomizer")].concat(h),x=r.$r(T),(c=b.$$prototype).rand_results=c.detailed_rand_results=t,E(T[0],"UPPER_LIMIT_DICE_TIMES",200),E(T[0],"UPPER_LIMIT_DICE_SIDES",1e3),E(T[0],"UPPER_LIMIT_RANDS",1e4),I(b,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),b.$attr_reader("rand_results"),b.$attr_reader("detailed_rand_results"),E(T[0],"DetailedRandResult",x("Struct").$new("kind","sides","value")),I(b,"$roll_barabara",function(_,$){var u=this;return a(B(X(u.rand_results.$size(),_),x("UPPER_LIMIT_RANDS")))&&u.$raise(x("TooManyRandsError")),a(L(_,0))||a(B(_,x("UPPER_LIMIT_DICE_TIMES")))?[]:M(x("Array"),"new",[_],function n(){return(null==n.$$s?this:n.$$s).$roll_once($)},{$$arity:0,$$s:u})},2),I(b,"$roll_sum",function(_,$){return this.$roll_barabara(_,$).$sum()},2),I(b,"$roll_once",function(_){var u=t;return a(L(_,0))||a(B(_,x("UPPER_LIMIT_DICE_SIDES")))?0:(u=this.$rand_inner(_),this.$push_to_detail("normal",_,u),u)},1),I(b,"$roll_index",function(_){return G(this.$roll_once(_),1)},1),I(b,"$roll_tens_d10",function(){var u,$=t;return $=this.$rand_inner(10),H($,10)&&($=0),u=F($,10),this.$push_to_detail("tens_d10",10,u),u},0),I(b,"$roll_d9",function(){var $;return $=G(this.$rand_inner(10),1),this.$push_to_detail("d9",10,$),$},0),I(b,"$roll_d66",function(_){var n,u=t;return u=M(x("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(m(x("D66SortType"),"ASC"),n=_)?u["$sort!"]():j(m(x("D66SortType"),"DESC"),n)&&u["$sort!"]()["$reverse!"](),X(F(u["$[]"](0),10),u["$[]"](1))},1),b.$private(),I(b,"$rand_inner",function(_){var u,$=this;return a(J($.rand_results.$size(),x("UPPER_LIMIT_RANDS")))&&$.$raise(x("TooManyRandsError")),u=$.$random(_),$.rand_results["$<<"]([u,_]),u},1),I(b,"$random",function(_){return X(x("Kernel").$rand(_),1)},1),I(b,"$push_to_detail",function(_,$,u){var i;return i=x("DetailedRandResult").$new(_,$,u),this.detailed_rand_results.$push(i)},3),y(s[0],S("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var a,M,J,W,C,o,s,H,X,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,E=r.truthy;return a=U,M=X=[m(U[0],"BCDice")].concat(a),J=H=[m(X[0],"DiceTable")].concat(M),C=[W=e(H[0],null,"RollResult")].concat(J),o=r.$r(C),(s=W.$$prototype).table_name=s.value=s.body=t,y(W,"$initialize",function(N,P,h){var b=this;return b.table_name=N,b.value=P,b.body=h},3),W.$attr_reader("table_name"),W.$attr_reader("value"),W.$attr_reader("body"),y(W,"$to_s",function(){var N=this;return N.table_name+"("+N.value+") \uff1e "+N.body},0),y(W,"$last_body",function(){var N=this;return E(N.body["$is_a?"](o("RollResult")))?N.body.$last_body():N.body},0),y(W,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var B,G,W,C,o,s,S,F,L,U=[],t=r.nil,m=r.module,e=r.klass,y=r.truthy,E=r.def,I=r.rb_minus;return B=U,G=L=[m(U[0],"BCDice")].concat(B),W=F=[m(L[0],"DiceTable")].concat(G),o=[C=e(F[0],null,"ChainTable")].concat(W),s=r.$r(o),(S=C.$$prototype).times=S.sides=S.items=S.name=t,E(C,"$initialize",function(P,h,b){var T=this,x=t;return T.name=P,T.items=b.$freeze(),x=/(\d+)D(\d+)/i.$match(h),y(x)||T.$raise(s("ArgumentError"),"Unexpected table type: "+h),T.times=x["$[]"](1).$to_i(),T.sides=x["$[]"](2).$to_i()},3),E(C,"$roll",function(P){var b,T,h=this,x=t;return b=P.$roll_sum(h.times,h.sides),T=I(b,h.times),x=h.items["$[]"](T),y(x["$respond_to?"]("roll"))&&(x=x.$roll(P)),s("RollResult").$new(h.name,b,x)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var M,j,s,S,N,P,h,W,H,U=[],t=r.nil,m=r.module,e=r.klass,y=r.hash2,E=r.defs,I=r.def,a=r.rb_plus,B=r.rb_times,X=r.rb_minus;return M=U,j=H=[m(U[0],"BCDice")].concat(M),s=W=[m(H[0],"DiceTable")].concat(j),N=[S=e(W[0],null,"D66GridTable")].concat(s),P=r.$r(N),(h=S.$$prototype).name=h.items=t,E(S,"$from_i18n",function(T,x){var f=t;return f=P("I18n").$t(T,y(["locale","raise"],{locale:x,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items"))},2),I(S,"$initialize",function(T,x){return this.name=T,this.items=x.$freeze()},2),I(S,"$roll",function(T){var c,f,_,$,u;return c=T.$roll_once(6),f=T.$roll_once(6),_=a(B(c,10),f),$=X(c,1),u=X(f,1),P("RollResult").$new(this.name,_,this.items["$[]"]($)["$[]"](u))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var X,H,o,s,S,N,j,J,M,t=[],m=r.nil,e=r.module,y=r.klass,E=r.hash2,I=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),X=t,H=M=[e(t[0],"BCDice")].concat(X),j=[e(M[0],"DiceTable")].concat(H),J=r.$r(j),o=j,S=[s=y(j[0],J("D66GridTable"),"D66HalfGridTable")].concat(o),N=r.$r(S),I(s,"$from_i18n",function(h,b){var x=m;return x=N("I18n").$t(h,E(["locale","raise"],{locale:b,raise:!0})),this.$new(x["$[]"]("name"),x["$[]"]("items_1_2_3"),x["$[]"]("items_4_5_6"))},2),a(s,"$initialize",function(h,b,T){return this.name=h,this.items=[b,b,b,T,T,T].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var X,H,o,s,S,N,j,J,M,t=[],m=r.nil,e=r.module,y=r.klass,E=r.hash2,I=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),X=t,H=M=[e(t[0],"BCDice")].concat(X),j=[e(M[0],"DiceTable")].concat(H),J=r.$r(j),o=j,S=[s=y(j[0],J("D66GridTable"),"D66OneThirdTable")].concat(o),N=r.$r(S),I(s,"$from_i18n",function(h,b){var x=m;return x=N("I18n").$t(h,E(["locale","raise"],{locale:b,raise:!0})),this.$new(x["$[]"]("name"),x["$[]"]("items_1_2"),x["$[]"]("items_3_4"),x["$[]"]("items_5_6"))},2),a(s,"$initialize",function(h,b,T,x){return this.name=h,this.items=[b,b,T,T,x,x].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var H,W,N,P,h,b,T,o,j,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,E=r.hash2,I=r.defs,a=r.def,B=r.eqeqeq,X=r.rb_plus,L=r.rb_times,M=r.truthy;return H=U,W=j=[e(U[0],"BCDice")].concat(H),N=o=[e(j[0],"DiceTable")].concat(W),h=[P=y(o[0],null,"D66Table")].concat(N),b=r.$r(h),(T=P.$$prototype).sort_type=T.items=T.name=t,I(P,"$from_i18n",function(c,f){var u,$=t;return $=b("I18n").$t(c,E(["locale"],{locale:f})),u=b("D66SortType").$const_get($["$[]"]("d66_sort_type")),this.$new($["$[]"]("name"),u,$["$[]"]("items"))},2),a(P,"$initialize",function(c,f,_){var $=this;return $.name=c,$.sort_type=f,$.items=_.$freeze()},3),a(P,"$roll",function(c){var f=this,_=t,$=t,u=t,n=t;return _=c.$roll_barabara(2,6),B(m(b("D66SortType"),"ASC"),$=f.sort_type)?_["$sort!"]():B(m(b("D66SortType"),"DESC"),$)&&_["$sort!"]()["$reverse!"](),u=X(L(_["$[]"](0),10),_["$[]"](1)),n=M($=f.items["$[]"](u))?$:f.items["$[]"](u.$to_s()),M(n["$respond_to?"]("roll"))&&(n=n.$roll(c)),b("RollResult").$new(f.name,u,n)},1),a(P,"$choice",function(c){return b("RollResult").$new(this.name,c,this.items["$[]"](c))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var J,s,N,P,C,t=[],m=r.nil,e=r.module,y=r.klass,E=r.hash2,I=r.send,a=r.to_ary,B=r.rb_plus,X=r.rb_times,L=r.to_a,M=r.rb_minus,G=r.send2,H=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),J=t,s=C=[e(t[0],"BCDice")].concat(J),N=[e(C[0],"DiceTable")].concat(s),P=r.$r(N),F(y(N[0],P("D66Table"),"D66LeftRangeTable"),"$initialize",function x(c,f,_){var n;return delete x.$$p,n=E([],{}),I(_,"each",[],function(v){var z,q;return null==v&&(v=m),z=a(v),q=null==z[1]?m:z[1],I(null==z[0]?m:z[0],"each",[],function(l){return null==l&&(l=m),I(q,"each_with_index",[],function(d,O){var re,V;return null==d&&(d=m),null==O&&(O=m),re=B(X(l,10),B(O,1)),I(n,"[]=",L(V=[re,d])),V[M(V.length,1)]},2)},1)},1),G(this,H(this,"initialize",x,!1,!0),"initialize",[c,f,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var L,F,o,s,S,N,P,J,G,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,E=r.truthy,I=r.rb_minus,a=r.rb_plus,B=r.rb_times;return L=U,F=G=[m(U[0],"BCDice")].concat(L),o=J=[m(G[0],"DiceTable")].concat(F),S=[s=e(J[0],null,"D66ParityTable")].concat(o),N=r.$r(S),(P=s.$$prototype).odd=P.even=P.name=t,y(s,"$initialize",function(b,T,x){var c=this;return c.name=b,c.odd=T.$freeze(),c.even=x.$freeze()},3),y(s,"$roll",function(b){var c,_,$,T=this,x=t;return x=b.$roll_once(6),c=b.$roll_once(6),_=(E(x["$odd?"]())?T.odd:T.even)["$[]"](I(c,1)),$=a(B(x,10),c),N("RollResult").$new(T.name,$,_)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var X,H,C,o,s,S,N,j,M,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,E=r.rb_plus,I=r.rb_times,a=r.send;return X=U,H=M=[m(U[0],"BCDice")].concat(X),C=j=[m(M[0],"DiceTable")].concat(H),s=[o=e(j[0],null,"D66RangeTable")].concat(C),S=r.$r(s),(N=o.$$prototype).items=N.name=t,y(o,"$initialize",function(h,b){return this.name=h,this.items=b.$freeze()},2),y(o,"$roll",function(h){var T,x,c,f=t;return T=h.$roll_once(6),x=h.$roll_once(6),c=E(I(T,10),x),f=a(this.items,"find",[],function($){return null==$&&($=t),$["$[]"](0)["$include?"](c)},1),S("RollResult").$new(this.name,c,f["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,C,P,h,b,T,x,s,J,U=[],t=r.nil,m=r.module,e=r.klass,y=r.const_set,E=r.send,I=r.truthy,a=r.def,B=r.to_a,X=r.rb_minus,L=r.eqeqeq,M=r.rb_times,G=r.rb_plus;return F=U,C=J=[m(U[0],"BCDice")].concat(F),P=s=[m(J[0],"DiceTable")].concat(C),b=[h=e(s[0],null,"RangeTable")].concat(P),T=r.$r(b),(x=h.$$prototype).name=x.items=x.num_of_dice=x.num_of_sides=x.formatter=t,y(b[0],"RollResult",E(T("Struct"),"new",["sum","values","content","formatted"],function c(){return(null==c.$$s?this:c.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:h})),y(b[0],"Item",T("Struct").$new("range","content")),y(b[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),y(b[0],"DEFAULT_FORMATTER",E(h,"lambda",[],function(f,_){return null==f&&(f=t),null==_&&(_=t),f.$name()+"("+_.$sum()+") \uff1e "+_.$content()},2)),h.$attr_reader("name"),h.$attr_reader("num_of_dice"),h.$attr_reader("num_of_sides"),a(h,"$initialize",function c(f,_,$){var i,u=c.$$p||t,n=this,v=t;return delete c.$$p,n.name=f.$freeze(),n.formatter=I(i=u)?i:T("DEFAULT_FORMATTER"),v=T("DICE_ROLL_METHOD_RE").$match(_),I(v)||n.$raise(T("ArgumentError"),n.name+": invalid dice roll method: "+_),n.num_of_dice=v["$[]"](1).$to_i(),n.num_of_sides=v["$[]"](2).$to_i(),n.$store($)},3),a(h,"$fetch",function(f){var $,_=this;return $=E(_.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](f)},1),I($)||_.$raise(T("RangeError"),_.name+": value is out of range: "+f),$},1),a(h,"$roll",function(f){var u,n,i,_=this,$=t;return u=($=f.$roll_barabara(_.num_of_dice,_.num_of_sides)).$sum(),n=T("RollResult").$new(u,$,_.$fetch(u).$content()),i=[_.formatter["$[]"](_,n)],E(n,"formatted=",B(i)),X(i.length,1),n},1),h.$private(),a(h,"$store",function(f){var $,u,_=this;return $=E(f,"map",[],function n(i,v){return null==i&&(i=t),null==v&&(v=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),v]},{$$arity:2,$$s:_}),u=E($,"sort_by",[],function(i,v){return null==i&&(i=t),null==v&&(v=t),i.$min()},2),_.$assert_min_sum_is_covered(u),_.$assert_max_sum_is_covered(u),_.$assert_no_gap_or_overlap_in_ranges(u),_.items=E(u,"map",[],function(i,v){return null==i&&(i=t),null==v&&(v=t),T("Item").$new(i,v.$freeze()).$freeze()},2).$freeze(),_},1),a(h,"$coerce_to_int_range",function(f){var $;return L(T("Integer"),$=f)?T("Range").$new(f,f):L(T("Range"),$)&&I(f.$begin()["$is_a?"](T("Integer")))&&I(f.$end()["$is_a?"](T("Integer")))?f:this.$raise(T("TypeError"),this.name+": "+f+" ("+f.$class()+") must be an Integer or a Range with Integers ")},1),a(h,"$assert_min_sum_is_covered",function(f){var $,_=this,u=t;return $=_.num_of_dice,u=f.$first()["$[]"](0),I(u["$include?"]($))||_.$raise(T("RangeError"),_.name+": min value ("+$+") is not covered: "+u),_},1),a(h,"$assert_max_sum_is_covered",function(f){var $,_=this,u=t;return $=M(_.num_of_dice,_.num_of_sides),u=f.$last()["$[]"](0),I(u["$include?"]($))||_.$raise(T("RangeError"),_.name+": max value ("+$+") is not covered: "+u),_},1),a(h,"$assert_no_gap_or_overlap_in_ranges",function(f){return E(f,"each_cons",[2],function $(u,n){var g,w,i=null==$.$$s?this:$.$$s,v=t,z=t;return null==i.name&&(i.name=t),null==u&&(u=t),null==n&&(n=t),v=u["$[]"](0),z=n["$[]"](0),g=v.$max(),w=G(g,1),I(z["$include?"](g))&&i.$raise(T("RangeError"),i.name+": Range overlap: "+v+" and "+z),I(z["$include?"](w))?t:i.$raise(T("RangeError"),i.name+": Range gap: "+v+" and "+z)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var X,H,C,P,h,b,T,s,j,M,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,E=r.send,I=r.def,a=r.rb_minus;return X=U,H=M=[e(U[0],"BCDice")].concat(X),C=j=[e(M[0],"DiceTable")].concat(H),P=s=[y(j[0],null,"SaiFicSkillTable")].concat(C),b=[h=y(s[0],null,"Category")].concat(P),T=r.$r(b),h.$$prototype.name=t,I(h,"$initialize",function(f,_,$,u){var n=this;return n.name=f,n.skills=E(_.$map(),"with_index",[2],function(v,z){return null==v&&(v=t),null==z&&(z=t),m(T("SaiFicSkillTable"),"Skill").$new(f,v,$,z,u)},2),n.dice=$},4),I(h,"$roll",function(f){return this.$skills()["$[]"](a(f.$roll_sum(2,6),2))},1),I(h,"$to_s",function(){return this.name},0),h.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var a,M,J,S,N,C,H,X,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,E=r.hash2;return a=U,M=X=[m(U[0],"BCDice")].concat(a),J=H=[m(X[0],"DiceTable")].concat(M),C=[e(H[0],null,"SaiFicSkillTable")].concat(J),(N=(S=e(C[0],null,"Skill")).$$prototype).s_format=N.category_dice=N.row_dice=N.category_name=N.name=t,y(S,"$initialize",function(h,b,T,x,c){var f=this;return f.category_name=h,f.name=b,f.category_dice=T,f.row_dice=x,f.s_format=c},5),y(S,"$to_s",function(){var h=this;return h.$format(h.s_format,E(["category_dice","row_dice","category_name","skill_name"],{category_dice:h.category_dice,row_dice:h.row_dice,category_name:h.category_name,skill_name:h.name}))},0),S.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var W,S,T,x,c,f,_,P,o,U=r.top,t=[],m=r.nil,e=r.$$$,y=r.module,E=r.klass,I=r.hash2,a=r.send,X=r.defs,L=r.const_set,M=r.to_ary,G=r.def,H=r.truthy,F=r.rb_minus,j=r.rb_plus;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),W=t,S=o=[y(t[0],"BCDice")].concat(W),T=P=[y(o[0],"DiceTable")].concat(S),c=[x=E(P[0],null,"SaiFicSkillTable")].concat(T),f=r.$r(c),(_=x.$$prototype).rtt=_.rtt_format=_.rct=_.rct_format=_.rttn=_.rttn_format=_.categories=m,X(x,"$from_i18n",function(u,n,i){var v,z,g,l,p=m;if(null==i)i=I([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(v=i.$$smap.rtt)&&(v=m),null==(z=i.$$smap.rct)&&(z=m),null==(g=i.$$smap.rttn)&&(g=m),l=(p=f("I18n").$t("RTT",I(["locale","raise","default"],{locale:n,raise:!1,default:I([],{})})).$merge(f("I18n").$t(u,I(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),p=a(p,"select",[],function(d,O){return null==d&&(d=m),null==O&&(O=m),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](d)},2),this.$new(l,r.to_hash(p).$merge(I(["rtt","rct","rttn"],{rtt:v,rct:z,rttn:g})))},-3),L(c[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),L(c[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),L(c[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),L(c[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),G(x,"$initialize",function(u,n){var i,v,z,g,w,q,p,l=this;if(null==n)n=I([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=m),null==(v=n.$$smap.rct)&&(v=m),null==(z=n.$$smap.rttn)&&(z=m),null==(g=n.$$smap.rtt_format)&&(g=f("DEFAULT_RTT")),null==(w=n.$$smap.rct_format)&&(w=f("DEFAULT_RCT")),null==(q=n.$$smap.rttn_format)&&(q=f("DEFAULT_RTTN")),null==(p=n.$$smap.s_format)&&(p=f("DEFAULT_S")),l.categories=a(u.$map(),"with_index",[1],function(d,O){var re,ie,Q;return null==d&&(d=m),null==O&&(O=m),ie=null==(re=M(d))[0]?m:re[0],Q=null==re[1]?m:re[1],e(f("SaiFicSkillTable"),"Category").$new(ie,Q,O,p)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),l.rtt=i,l.rct=v,l.rttn=z.$to_a(),l.rtt_format=g,l.rct_format=w,l.rttn_format=q},-2),L(c[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),x.$attr_reader("categories"),G(x,"$roll_command",function(u,n){var v,i=this,z=m,g=m;return H(["RTT",i.rtt]["$include?"](v=n))?i.$format_skill(i.rtt_format,i.$roll_skill(u)):H(["RCT",i.rct]["$include?"](v))?(z=i.$roll_category(u),i.$format(i.rct_format,I(["category_dice","category_name"],{category_dice:z.$dice(),category_name:z.$name()}))):H(g=f("RTTN").$index(v))||H(g=i.rttn.$index(v))?i.$format_skill(i.rttn_format,i.categories["$[]"](g).$roll(u)):m},2),G(x,"$roll_category",function(u){return this.categories["$[]"](F(u.$roll_once(6),1))},1),G(x,"$roll_skill",function(u){return this.$roll_category(u).$roll(u)},1),G(x,"$prefixes",function(){var u=this;return j(["RTT[1-6]?","RCT",u.rtt,u.rct],u.rttn).$compact()},0),x.$private(),G(x,"$format_skill",function(u,n){return this.$format(u,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var L,F,o,s,S,N,P,J,G,U=[],t=r.nil,m=r.module,e=r.klass,y=r.hash2,E=r.defs,I=r.truthy,a=r.def,B=r.rb_minus;return L=U,F=G=[m(U[0],"BCDice")].concat(L),o=J=[m(G[0],"DiceTable")].concat(F),S=[s=e(J[0],null,"Table")].concat(o),N=r.$r(S),(P=s.$$prototype).times=P.sides=P.name=P.items=t,E(s,"$from_i18n",function(b,T){var c=t;return c=N("I18n").$t(b,y(["locale"],{locale:T})),this.$new(c["$[]"]("name"),c["$[]"]("type"),c["$[]"]("items"))},2),a(s,"$initialize",function(b,T,x){var c=this,f=t;return c.name=b,c.items=x.$freeze(),f=/(\d+)D(\d+)/i.$match(T),I(f)||c.$raise(N("ArgumentError"),"Unexpected table type: "+T),c.times=f["$[]"](1).$to_i(),c.sides=f["$[]"](2).$to_i()},3),a(s,"$roll",function(b){var x,T=this;return x=b.$roll_sum(T.times,T.sides),T.$choice(x)},1),a(s,"$choice",function(b){var x,T=this;return x=B(b,T.times),N("RollResult").$new(T.name,b,T.items["$[]"](x))},1)},Opal.modules["bcdice/dice_table"]=function(r){var U=r.top;return U.$require("bcdice/dice_table/roll_result"),U.$require("bcdice/dice_table/chain_table"),U.$require("bcdice/dice_table/d66_grid_table"),U.$require("bcdice/dice_table/d66_half_grid_table"),U.$require("bcdice/dice_table/d66_one_third_table"),U.$require("bcdice/dice_table/d66_left_range_table"),U.$require("bcdice/dice_table/d66_parity_table"),U.$require("bcdice/dice_table/d66_range_table"),U.$require("bcdice/dice_table/d66_table"),U.$require("bcdice/dice_table/range_table"),U.$require("bcdice/dice_table/sai_fic_skill_table"),U.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var E,X,M,a,U=[],m=r.module,e=r.const_set;return E=U,X=a=[m(U[0],"BCDice")].concat(E),M=[m(a[0],"D66SortType")].concat(X),e(M[0],"NO_SORT","no_sort"),e(M[0],"ASC","asc"),e(M[0],"DESC","desc"),function(B,X){var M=[m(B,"RoundType")].concat(X);return e(M[0],"CEIL","ceil"),e(M[0],"FLOOR","floor"),e(M[0],"ROUND","round")}(a[0],a)},Opal.modules["bcdice/translate"]=function(r){var a,M,G,H,F,X,U=[],t=r.nil,m=r.module,e=r.hash2,E=r.def;return a=U,M=X=[m(U[0],"BCDice")].concat(a),H=[G=m(X[0],"Translate")].concat(M),F=r.$r(H),E(G,"$translate",function(J,W){var C,o=this;if(null==o.locale&&(o.locale=t),null==W)W=e([],{});else if(!W.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return C=r.kwrestargs(W,{}),F("I18n").$translate(J,e(["locale","raise"],{locale:o.locale,raise:!0}).$merge(r.to_hash(C)))},-2)},Opal.modules["bcdice/result"]=function(r){var X,F,C,j,W,M,U=[],t=r.nil,e=r.klass,y=r.send,E=r.to_a,I=r.rb_minus,a=r.def;return X=U,F=M=[(0,r.module)(U[0],"BCDice")].concat(X),[j=e(M[0],null,"Result")].concat(F),(W=j.$$prototype).secret=W.success=W.failure=W.critical=W.fumble=t,a(C=r.get_singleton_class(j),"$success",function(S){return y(this.$new(),"tap",[],function(h){var b=t;return null==h&&(h=t),y(h,"text=",E(b=[S])),I(b.length,1),y(h,"success=",E(b=[!0])),b[I(b.length,1)]},1)},1),a(C,"$failure",function(S){return y(this.$new(),"tap",[],function(h){var b=t;return null==h&&(h=t),y(h,"text=",E(b=[S])),I(b.length,1),y(h,"failure=",E(b=[!0])),b[I(b.length,1)]},1)},1),a(C,"$critical",function(S){return y(this.$new(),"tap",[],function(h){var b=t;return null==h&&(h=t),y(h,"text=",E(b=[S])),I(b.length,1),y(h,"critical=",E(b=[!0])),I(b.length,1),y(h,"success=",E(b=[!0])),b[I(b.length,1)]},1)},1),a(C,"$fumble",function(S){return y(this.$new(),"tap",[],function(h){var b=t;return null==h&&(h=t),y(h,"text=",E(b=[S])),I(b.length,1),y(h,"fumble=",E(b=[!0])),I(b.length,1),y(h,"failure=",E(b=[!0])),b[I(b.length,1)]},1)},1),a(C,"$nothing",function(){return"nothing"},0),a(j,"$initialize",function(o){var s=this;return null==o&&(o=t),s.text=o,s.rands=t,s.detailed_rands=t,s.secret=!1,s.success=!1,s.failure=!1,s.critical=!1,s.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),a(j,"$secret?",function(){return this.secret},0),a(j,"$success?",function(){return this.success},0),a(j,"$failure?",function(){return this.failure},0),a(j,"$critical?",function(){return this.critical},0),a(j,"$fumble?",function(){return this.fumble},0),a(j,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var T,c,f,t=[],m=r.$r(t),e=r.nil,y=r.$$$,E=r.module,I=r.klass,a=r.truthy,B=r.const_set,X=r.defs,L=r.gvars,M=r.rb_lt,G=r.send,H=r.to_a,F=r.rb_minus,j=r.def,J=r.to_ary,W=r.neqeq,C=r.rb_plus,o=r.eqeq,s=r.rb_ge,S=r.rb_gt,N=r.eqeqeq,P=r.rb_le,h=r.rb_times;return T=t,c=[E(t[0],"Racc")].concat(T),f=r.$r(c),I(c[0],f("StandardError"),"ParseError"),a(y("::","ParseError","skip_raise")?"constant":e)||B(t[0],"ParseError",y(m("Racc"),"ParseError")),function(b,T){var n,i,v,z,g,f=[E(b,"Racc")].concat(T),_=r.$r(f);return a(_("Racc_No_Extensions","skip_raise")?"constant":e)||B(f[0],"Racc_No_Extensions",!1),n=f,v=[i=I(f[0],null,"Parser")].concat(n),z=r.$r(v),(g=i.$$prototype).yydebug=g.racc_debug_out=g.racc_error_status=g.racc_t=g.racc_vstack=g.racc_val=g.racc_state=g.racc_tstack=e,B(v[0],"Racc_Runtime_Version","1.4.6"),B(v[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),B(v[0],"Racc_Runtime_Core_Version_R","1.4.6"),B(v[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),B(v[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),B(v[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),B(v[0],"Racc_Runtime_Core_Version",z("Racc_Runtime_Core_Version_R")),B(v[0],"Racc_Runtime_Core_Revision",z("Racc_Runtime_Core_Revision_R")),B(v[0],"Racc_Runtime_Type","ruby"),X(z("Parser"),"$racc_runtime_type",function(){return z("Racc_Runtime_Type")},0),j(i,"$_racc_setup",function(){var q,p,l=this,A=e,d=e,O=e;return null==L.stderr&&(L.stderr=e),a(y(l.$class(),"Racc_debug_parser"))||(l.yydebug=!1),a(null!=(q=l.yydebug)&&q!==e?"instance-variable":e)||(l.yydebug=!1),a(l.yydebug)&&(a(null!=(p=l.racc_debug_out)&&p!==e?"instance-variable":e)||(l.racc_debug_out=L.stderr),l.racc_debug_out=a(A=l.racc_debug_out)?A:L.stderr),d=y(l.$class(),"Racc_arg"),a(M(d.$size(),14))&&(G(d,"[]=",H(O=[13,!0])),F(O.length,1)),d},0),j(i,"$_racc_init_sysvars",function(){var q=this;return q.racc_state=[0],q.racc_tstack=[],q.racc_vstack=[],q.racc_t=e,q.racc_val=e,q.racc_read_next=!0,q.racc_user_yyerror=!1,q.racc_error_status=0},0),j(i,"$do_parse",function(){return this.$__send__(z("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j(i,"$next_token",function(){return this.$raise(z("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j(i,"$_racc_do_parse_rb",function(q,p){var l,d=this,O=e,re=e,V=e,ie=e,K=e,k=e,Z=e,R=e;return l=J(q),O=null==l[0]?e:l[0],re=null==l[1]?e:l[1],V=null==l[2]?e:l[2],ie=null==l[3]?e:l[3],K=null==l[10]?e:l[10],d.$_racc_init_sysvars(),k=Z=R=e,G(d,"catch",["racc_end_parse"],function D(){var $e,ee,Y=null==D.$$s?this:D.$$s,ce=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);a(!0);)for(a(R=ie["$[]"](Y.racc_state["$[]"](-1)))?(a(Y.racc_read_next)&&W(Y.racc_t,0)&&(ee=Y.$next_token(),$e=J(ee),k=null==$e[0]?e:$e[0],Y.racc_val=null==$e[1]?e:$e[1],Y.racc_t=a(k)?a(ce=K["$[]"](k))?ce:1:0,a(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,k,Y.racc_val),Y.racc_read_next=!1),R=C(R,Y.racc_t),a(s(R,0))&&a(Z=O["$[]"](R))&&o(re["$[]"](R),Y.racc_state["$[]"](-1))||(Z=V["$[]"](Y.racc_state["$[]"](-1)))):Z=V["$[]"](Y.racc_state["$[]"](-1));a(Z=Y.$_racc_evalact(Z,q)););},{$$arity:0,$$s:d})},2),j(i,"$yyparse",function(q,p){return this.$__send__(z("Racc_YY_Parse_Method"),q,p,this.$_racc_setup(),!0)},2),j(i,"$_racc_yyparse_rb",function(q,p,l,A){var d,V=e,ie=e,Q=e,K=e,Z=e,R=e,D=e;return d=J(l),V=null==d[0]?e:d[0],ie=null==d[1]?e:d[1],Q=null==d[2]?e:d[2],K=null==d[3]?e:d[3],Z=null==d[10]?e:d[10],this.$_racc_init_sysvars(),R=e,D=e,G(this,"catch",["racc_end_parse"],function ne(){var Y=null==ne.$$s?this:ne.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!a(D=K["$[]"](Y.racc_state["$[]"](-1)));)for(;a(R=Y.$_racc_evalact(Q["$[]"](Y.racc_state["$[]"](-1)),l)););return G(q,"__send__",[p],function ce(se,le){var ae=null==ce.$$s?this:ce.$$s,te=e,oe=e;for(null==ae.racc_t&&(ae.racc_t=e),null==ae.racc_state&&(ae.racc_state=e),null==ae.racc_read_next&&(ae.racc_read_next=e),null==se&&(se=e),null==le&&(le=e),ae.racc_t=a(se)?a(te=Z["$[]"](se))?te:1:0,ae.racc_val=le,ae.racc_read_next=!1,D=C(D,ae.racc_t),a(s(D,0))&&a(R=V["$[]"](D))&&o(ie["$[]"](D),ae.racc_state["$[]"](-1))||(R=Q["$[]"](ae.racc_state["$[]"](-1)));a(R=ae.$_racc_evalact(R,l)););for(;a(a(te=a(oe=(D=K["$[]"](ae.racc_state["$[]"](-1)))["$!"]())?oe:ae.racc_read_next["$!"]())?te:ae.racc_t["$=="](0));)for(a(D)&&a(D=C(D,ae.racc_t))&&a(s(D,0))&&a(R=V["$[]"](D))&&o(ie["$[]"](D),ae.racc_state["$[]"](-1))||(R=Q["$[]"](ae.racc_state["$[]"](-1)));a(R=ae.$_racc_evalact(R,l)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),j(i,"$_racc_evalact",function(q,p){var l,Q,d=this,O=e,re=e,ie=e,K=e,k=e,Z=e,R=e;if(O=null==(l=J(p))[0]?e:l[0],re=null==l[1]?e:l[1],ie=null==l[3]?e:l[3],Q=null==l[11]?e:l[11],K=null==l[12]?e:l[12],a(S(q,0))&&a(M(q,Q)))a(S(d.racc_error_status,0))&&(o(d.racc_t,1)||(d.racc_error_status=F(d.racc_error_status,1))),d.racc_vstack.$push(d.racc_val),d.racc_state.$push(q),d.racc_read_next=!0,a(d.yydebug)&&(d.racc_tstack.$push(d.racc_t),d.$racc_shift(d.racc_t,d.racc_tstack,d.racc_vstack));else if(a(M(q,0))&&a(S(q,K["$-@"]()))){if(k=G(d,"catch",["racc_jump"],function D(){var ne=null==D.$$s?this:D.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(p,q)),!1},{$$arity:0,$$s:d}),a(k)){if(N(1,Z=k))return d.racc_user_yyerror=!0,K["$-@"]();if(N(2,Z))return Q;d.$raise("[Racc Bug] unknown jump code")}}else if(o(q,Q))a(d.yydebug)&&d.$racc_accept(),d.$throw("racc_end_parse",d.racc_vstack["$[]"](0));else{if(o(q,K["$-@"]())){for(N(0,Z=d.racc_error_status)?a(p["$[]"](21))||d.$on_error(d.racc_t,d.racc_val,d.racc_vstack):N(3,Z)&&(o(d.racc_t,0)&&d.$throw("racc_end_parse",e),d.racc_read_next=!0),d.racc_user_yyerror=!1,d.racc_error_status=3;a(!0)&&!(a(R=ie["$[]"](d.racc_state["$[]"](-1)))&&(R=C(R,1),a(s(R,0))&&a(q=O["$[]"](R))&&o(re["$[]"](R),d.racc_state["$[]"](-1))));)a(P(d.racc_state.$size(),1))&&d.$throw("racc_end_parse",e),d.racc_state.$pop(),d.racc_vstack.$pop(),a(d.yydebug)&&(d.racc_tstack.$pop(),d.$racc_e_pop(d.racc_state,d.racc_tstack,d.racc_vstack));return q}d.$raise("[Racc Bug] unknown action "+q.$inspect())}return a(d.yydebug)&&d.$racc_next_state(d.racc_state["$[]"](-1),d.racc_state),e},2),j(i,"$_racc_do_reduce",function(q,p){var l,K,Z,Y,ce,se,ae,d=this,re=e,V=e,ie=e,Q=e,k=e,R=e,D=e,ne=e,$e=e,ee=e,le=e,_e=e,ue=e,te=e;return re=null==(l=J(q))[4]?e:l[4],V=null==l[5]?e:l[5],ie=null==l[6]?e:l[6],Q=null==l[7]?e:l[7],K=null==l[8]?e:l[8],k=null==l[9]?e:l[9],Z=null==l[13]?e:l[13],R=d.racc_state,D=d.racc_vstack,ne=d.racc_tstack,$e=h(p,-3),ee=k["$[]"]($e),Y=k["$[]"](C($e,1)),ce=k["$[]"](C($e,2)),se=[],a(d.yydebug)&&(le=ne["$[]"](ee["$-@"](),ee)),_e=D["$[]"](ee["$-@"](),ee),a(d.yydebug)&&(ue=[ee["$-@"](),ee,se],G(ne,"[]=",H(ue)),F(ue.length,1)),ue=[ee["$-@"](),ee,se],G(D,"[]=",H(ue)),F(ue.length,1),ue=[ee["$-@"](),ee,se],G(R,"[]=",H(ue)),F(ue.length,1),a(Z)?D.$push(d.$__send__(ce,_e,D,_e["$[]"](0))):D.$push(d.$__send__(ce,_e,D)),ne.$push(Y),a(d.yydebug)&&d.$racc_reduce(le,Y,ne,D),ae=F(Y,K),a($e=Q["$[]"](ae))&&($e=C($e,R["$[]"](-1)),a(s($e,0))&&a(te=re["$[]"]($e))&&o(V["$[]"]($e),ae))?te:ie["$[]"](ae)},2),j(i,"$on_error",function(q,p,l){var d,A=this;return A.$raise(z("ParseError"),A.$sprintf("\nparse error on value %s (%s)",p.$inspect(),a(d=A.$token_to_str(q))?d:"?"))},3),j(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j(i,"$yyerrok",function(){return this.racc_error_status=0},0),j(i,"$racc_read_token",function(q,p,l){var A=this;return A.racc_debug_out.$print("read    "),A.racc_debug_out.$print(p.$inspect(),"(",A.$racc_token2str(q),") "),A.racc_debug_out.$puts(l.$inspect()),A.racc_debug_out.$puts()},3),j(i,"$racc_shift",function(q,p,l){var A=this;return A.racc_debug_out.$puts("shift   "+A.$racc_token2str(q)),A.$racc_print_stacks(p,l),A.racc_debug_out.$puts()},3),j(i,"$racc_reduce",function(q,p,l,A){var d=this,O=e;return(O=d.racc_debug_out).$print("reduce "),a(q["$empty?"]())?O.$print(" <none>"):G(q,"each",[],function re(V){return null==V&&(V=e),O.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(V))},{$$arity:1,$$s:d}),O.$puts(" --\x3e "+d.$racc_token2str(p)),d.$racc_print_stacks(l,A),d.racc_debug_out.$puts()},4),j(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j(i,"$racc_e_pop",function(q,p,l){var A=this;return A.racc_debug_out.$puts("error recovering mode: pop token"),A.$racc_print_states(q),A.$racc_print_stacks(p,l),A.racc_debug_out.$puts()},3),j(i,"$racc_next_state",function(q,p){var l=this;return l.racc_debug_out.$puts("goto    "+q),l.$racc_print_states(p),l.racc_debug_out.$puts()},2),j(i,"$racc_print_stacks",function(q,p){var A=e;return(A=this.racc_debug_out).$print("        ["),G(q,"each_index",[],function d(O){return null==O&&(O=e),A.$print(" (",(null==d.$$s?this:d.$$s).$racc_token2str(q["$[]"](O))," ",p["$[]"](O).$inspect(),")")},{$$arity:1,$$s:this}),A.$puts(" ]")},2),j(i,"$racc_print_states",function(q){var l=e;return(l=this.racc_debug_out).$print("        ["),G(q,"each",[],function(d){return null==d&&(d=e),l.$print(" ",d)},1),l.$puts(" ]")},1),j(i,"$racc_token2str",function(q){var l;return a(l=y(this.$class(),"Racc_token_to_s_table")["$[]"](q))?l:this.$raise("[Racc Bug] can't convert token "+q+" to string")},1),j(i,"$token_to_str",function(q){return y(this.$class(),"Racc_token_to_s_table")["$[]"](q)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var F,C,N,c,f,h,b,s,J,U=[],t=r.nil,m=r.$$$,e=r.module,y=r.klass,E=r.def,I=r.send2,a=r.find_super,B=r.eqeq,X=r.const_set,L=r.eqeqeq,M=r.rb_divide,G=r.alias;return F=U,C=J=[e(U[0],"BCDice")].concat(F),N=s=[e(J[0],"Arithmetic")].concat(C),h=[e(s[0],"Node")].concat(N),b=r.$r(h),(f=(c=y(h[0],null,"BinaryOp")).$$prototype).lhs=f.rhs=f.op=t,E(c,"$initialize",function($,u,n){var i=this;return i.lhs=$,i.op=u,i.rhs=n},3),E(c,"$eval",function($){var i,u=this,n=t;return n=u.lhs.$eval($),i=u.rhs.$eval($),n.$send(u.op,i)},1),E(c,"$output",function(){var $=this;return""+$.lhs.$output()+$.op+$.rhs.$output()},0),E(c,"$s_exp",function(){var $=this;return"("+$.$op_for_s_exp()+" "+$.lhs.$s_exp()+" "+$.rhs.$s_exp()+")"},0),E(c,"$op_for_s_exp",function(){return this.op},0),function(T,x,c){var f=y(T,x,"DivideBase"),_=[f].concat(c),$=r.$r(_),u=f.$$prototype;u.lhs=u.rhs=u.op=t,E(f,"$initialize",function n(i,v){return delete n.$$p,I(this,a(this,"initialize",n,!1,!0),"initialize",[i,"/",v],null)},2),E(f,"$eval",function(i){var z,g,v=this;return z=v.lhs.$eval(i),g=v.rhs.$eval(i),B(g,0)&&v.$raise($("ZeroDivisionError")),v.$divide_and_round(z,g,i)},1),E(f,"$output",function n(){var i=n.$$p||t,v=this;return delete n.$$p,""+I(v,a(v,"output",n,!1,!0),"output",[],i)+v.$rounding_method()},0),f.$private(),E(f,"$rounding_method",function(){return m(this.$class(),"ROUNDING_METHOD")},0),E(f,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),E(f,"$divide_and_round",function(i,v,z){return this.$raise($("NotImplementedError"))},3)}(h[0],b("BinaryOp"),h),function(T,x,c){var f=y(T,x,"DivideWithGameSystemDefault"),_=[f].concat(c),$=r.$r(_);X(_[0],"ROUNDING_METHOD",""),f.$private(),E(f,"$divide_and_round",function(n,i,v){var z;return L(m($("RoundType"),"CEIL"),z=v)?M(n.$to_f(),i).$ceil():L(m($("RoundType"),"ROUND"),z)?M(n.$to_f(),i).$round():M(n,i).$floor()},3)}(h[0],b("DivideBase"),h),function(T,x,c){var f=y(T,x,"DivideWithCeil"),_=[f].concat(c);X(_[0],"ROUNDING_METHOD","C"),f.$private(),E(f,"$divide_and_round",function(u,n,i){return M(u.$to_f(),n).$ceil()},3)}(h[0],b("DivideBase"),h),function(T,x,c){var f=y(T,x,"DivideWithRound"),_=[f].concat(c);X(_[0],"ROUNDING_METHOD","R"),f.$private(),E(f,"$divide_and_round",function(u,n,i){return M(u.$to_f(),n).$round()},3)}(h[0],b("DivideBase"),h),function(T,x,c){var f=y(T,x,"DivideWithFloor"),_=[f].concat(c);X(_[0],"ROUNDING_METHOD","F"),f.$private(),E(f,"$divide_and_round",function(u,n,i){return M(u,n).$to_i()},3)}(h[0],b("DivideBase"),h),function(T,x){var c=y(T,null,"Negative");c.$$prototype.body=t,E(c,"$initialize",function($){return this.body=$},1),E(c,"$eval",function($){return this.body.$eval($)["$-@"]()},1),E(c,"$output",function(){return"-"+this.body.$output()},0),E(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(h[0]),function(T,x){var c=y(T,null,"Parenthesis");c.$$prototype.expr=t,E(c,"$initialize",function($){return this.expr=$},1),E(c,"$eval",function($){return this.expr.$eval($)},1),E(c,"$output",function(){return"("+this.expr.$output()+")"},0),E(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(h[0]),function(T,x){var c=y(T,null,"Number");return c.$$prototype.value=t,E(c,"$initialize",function($){return this.value=$},1),E(c,"$eval",function($){return this.value},1),E(c,"$output",function(){return this.value.$to_s()},0),G(c,"s_exp","output")}(h[0])},Opal.modules.strscan=function(r){var H,F,j,J,W,U=[],t=r.nil,e=r.def,y=r.truthy,E=r.eqeqeq,I=r.Opal,a=r.send,B=r.to_a,X=r.rb_minus,L=r.alias;return H=U,j=[F=(0,r.klass)(U[0],null,"StringScanner")].concat(H),J=r.$r(j),(W=F.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=t,F.$attr_reader("pos","matched"),e(F,"$initialize",function(o){var s=this;return s.string=o,s.pos=0,s.matched=t,s.working=o,s.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)},0),e(F,"$scan",function(o){var s=this,S=(o=s.$anchor(o)).exec(s.working);return null==S?s.matched=t:"object"==typeof S?(s.prev_pos=s.pos,s.pos+=S[0].length,s.working=s.working.substring(S[0].length),s.matched=S[0],s.match=S,S[0]):"string"==typeof S?(s.pos+=S.length,s.working=s.working.substring(S.length),S):t},1),e(F,"$scan_until",function(o){var s=this;o=s.$anchor(o);for(var P,S=s.pos,N=s.working;;){if(P=o.exec(N),S+=1,N=N.substr(1),null!=P)return s.matched=s.string.substr(s.pos,S-s.pos-1+P[0].length),s.match=P,s.prev_pos=S-1,s.pos=S,s.working=N.substr(P[0].length),s.matched;if(0===N.length)return s.match=[],s.matched=t}},1),e(F,"$[]",function(o){var S;if(y(this.match["$empty?"]()))return t;E(J("Symbol"),S=o)?o=o.$to_s():E(J("String"),S)||(o=I["$coerce_to!"](o,J("Integer"),"to_int"));var N=this.match;return o<0&&(o+=N.length),o<0||o>=N.length||null==N[o]?t:N[o]},1),e(F,"$check",function(o){var s=this,S=(o=s.$anchor(o)).exec(s.working);return s.matched=null==S?t:S[0]},1),e(F,"$check_until",function(o){var s=this,S=s.prev_pos,N=s.pos,P=s.$scan_until(o);return P!==t&&(s.matched=P.substr(-1),s.working=s.string.substr(N)),s.prev_pos=S,s.pos=N,P},1),e(F,"$peek",function(o){return this.working.substring(0,o)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(o){var S=o.exec(this.working);return null==S?t:0==S.index?0:S.index+1},1),e(F,"$skip",function(o){var s=this,S=(o=s.$anchor(o)).exec(s.working);if(null==S)return s.match=[],s.matched=t;var N=S[0],P=N.length;return s.matched=N,s.match=S,s.prev_pos=s.pos,s.pos+=P,s.working=s.working.substring(P),P},1),e(F,"$skip_until",function(o){var S=this.$scan_until(o);return S===t?t:(this.matched=S.substr(-1),S.length)},1),e(F,"$get_byte",function(){var o=this,s=t;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,s=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=t,s},0),e(F,"$match?",function(o){var s=this,S=(o=s.$anchor(o)).exec(s.working);return null==S?t:(s.prev_pos=s.pos,S[0].length)},1),e(F,"$pos=",function(o){var s=this;return o<0&&(o+=s.string.$length()),s.pos=o,s.working=s.string.slice(o)},1),e(F,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(F,"$post_match",function(){var o=this;return o.matched===t?t:o.string.substr(o.pos)},0),e(F,"$pre_match",function(){var o=this;return o.matched===t?t:o.string.substr(0,o.prev_pos)},0),e(F,"$reset",function(){var o=this;return o.working=o.string,o.matched=t,o.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var s,o=this;return o.match=t,s=[o.string.$length()],a(o,"pos=",B(s)),s[X(s.length,1)]},0),e(F,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=t,o.match=t,o},0),L(F,"bol?","beginning_of_line?"),L(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(o){var s=o.toString().match(/\/([^\/]+)$/);return s=s?s[1]:void 0,new RegExp("^(?:"+o.source+")",s)},1)},Opal.modules["bcdice/normalize"]=function(r){var a,M,X,U=[],t=r.nil,m=r.module,e=r.eqeqeq,y=r.def,E=r.eqeq;return a=U,X=[m(U[0],"BCDice")].concat(a),(M=m(X[0],"Normalize")).$module_function(),y(M,"$comparison_operator",function(H){var F;return e(/<=|=</,F=H)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":t},1),y(M,"$target_number",function(H){return E(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var M,j,s,S,N,P,h,W,H,U=r.top,t=[],m=r.nil,e=r.module,y=r.klass,E=r.const_set,I=r.hash2,a=r.truthy,B=r.send,X=r.def;return U.$require("strscan"),U.$require("bcdice/normalize"),M=t,j=H=[e(t[0],"BCDice")].concat(M),s=W=[e(H[0],"Command")].concat(j),N=[S=y(W[0],null,"Lexer")].concat(s),P=r.$r(N),(h=S.$$prototype).scanner=h.notations=m,E(N[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),X(S,"$initialize",function(T,x){var c,f,$;return T=a($=(f=(c=T)===m||null==c?m:B(c,"split",[" ",2]))===m||null==f?m:B(f,"first",[]))?$:"",this.scanner=P("StringScanner").$new(T),this.notations=B(x,"map",[],function(n){return null==n&&(n=m),a(n["$is_a?"](P("String")))?P("Regexp").$new(n):n},1)},2),X(S,"$next_token",function(){try{var T=this,x=m,c=m,_=m,$=m;return a(T.scanner["$eos?"]())?[!1,"$"]:(B(T.notations,"each",[],function u(n){var v,i=null==u.$$s?this:u.$$s;if(null==i.scanner&&(i.scanner=m),null==n&&(n=m),v=i.scanner.$scan(n),!a(v))return m;r.ret(["NOTATION",v])},{$$arity:1,$$s:T}),a(x=T.scanner.$scan(/\d+/))?["NUMBER",x.$to_i()]:a(c=T.scanner.$scan(/[<>!=]+/))?(c=P("Normalize").$comparison_operator(c),[a(c)?"CMP_OP":"ILLEGAL",c]):(_=T.scanner.$getch().$upcase(),[a($=P("SYMBOLS")["$[]"](_))?$:_.$to_sym(),_]))}catch(u){if(u===r.returner)return u.$v;throw u}},0),X(S,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var B,G,W,C,o,s,S,F,L,U=[],t=r.nil,m=r.module,e=r.klass,y=r.def,E=r.truthy,I=r.eqeqeq;return B=U,G=L=[m(U[0],"BCDice")].concat(B),W=F=[m(L[0],"Command")].concat(G),o=[C=e(F[0],null,"Parsed")].concat(W),s=r.$r(o),(S=C.$$prototype).question_target=S.critical=S.fumble=S.dollar=S.modify_number=S.target_number=S.prefix_number=S.command=S.suffix_number=S.cmp_op=t,C.$attr_accessor("command"),C.$attr_accessor("prefix_number"),C.$attr_accessor("suffix_number"),C.$attr_accessor("critical"),C.$attr_accessor("fumble"),C.$attr_accessor("dollar"),C.$attr_accessor("modify_number"),C.$attr_accessor("cmp_op"),C.$attr_accessor("target_number"),C.$attr_writer("question_target"),y(C,"$initialize",function(){var P=this;return P.prefix_number=t,P.suffix_number=t,P.critical=t,P.fumble=t,P.dollar=t,P.cmp_op=t,P.target_number=t,P.question_target=!1},0),y(C,"$question_target?",function(){return this.question_target},0),y(C,"$to_s",function(P){var _,h=this,b=t,T=t,x=t,c=t,f=t;return null==P&&(P="after_command"),b=E(h.critical)?"@"+h.critical:t,T=E(h.fumble)?"#"+h.fumble:t,x=E(h.dollar)?"$"+h.dollar:t,c=s("Format").$modifier(h.modify_number),f=E(h.question_target)?"?":h.target_number,I("after_command",_=P)?[h.prefix_number,h.command,h.suffix_number,b,T,x,c,h.cmp_op,f].$join():I("after_modify_number",_)?[h.prefix_number,h.command,h.suffix_number,c,b,T,x,h.cmp_op,f].$join():I("after_target_number",_)?[h.prefix_number,h.command,h.suffix_number,c,h.cmp_op,f,b,T,x].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var s,h,_,i,v,z,g,w,q,p,l,A,re,$,u,n,Q,T,x,N,U=r.top,t=[],m=r.$r(t),e=r.nil,y=r.$$$,E=r.klass,I=r.module,a=r.hash2,B=r.send2,X=r.find_super,L=r.def,M=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeq,j=r.hash,J=r.const_set,W=r.truthy,C=r.to_ary;return U.$require("racc/parser.rb"),U.$require("bcdice/arithmetic/node"),U.$require("bcdice/command/lexer"),U.$require("bcdice/command/parsed"),E(y(m("BCDice"),"Command"),y(m("Racc"),"Parser"),"Parser"),s=t,h=N=[I(t[0],"BCDice")].concat(s),T=[I(N[0],"Command")].concat(h),x=r.$r(T),_=T,u=[$=E(T[0],y(x("Racc"),"Parser"),"Parser")].concat(_),n=r.$r(u),(Q=$.$$prototype).notations=Q.lexer=Q.modifier=Q.suffix_number=Q.prefix_number=Q.need_suffix_number=Q.need_prefix_number=Q.critical=Q.fumble=Q.dollar=Q.allowed_cmp_op=Q.question_target=e,L($,"$initialize",function K(k,Z){var R,D,ne,$e,Y=this;if(delete K.$$p,R=r.slice.call(arguments),null==(D=r.extract_kwargs(R)))D=a([],{});else if(!D.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=R,!r.hasOwnProperty.call(D.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return $e=D.$$smap.round_type,B(Y,X(Y,"initialize",K,!1,!0),"initialize",[],null),Y.notations=ne,Y.round_type=$e,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),L($,"$disable_modifier",function(){return this.modifier=!1,this},0),L($,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),L($,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),L($,"$has_prefix_number",function(){var k=this;return k.prefix_number=!0,k.need_prefix_number=!0,k},0),L($,"$has_suffix_number",function(){var k=this;return k.suffix_number=!0,k.need_suffix_number=!0,k},0),L($,"$enable_critical",function(){return this.critical=!0,this},0),L($,"$enable_fumble",function(){return this.fumble=!0,this},0),L($,"$enable_dollar",function(){return this.dollar=!0,this},0),L($,"$restrict_cmp_op_to",function(k){var Z,D=this;return Z=r.slice.call(arguments),D.allowed_cmp_op=Z,D},-1),L($,"$enable_question_target",function(){return this.question_target=!0,this},0),L($,"$parse",function(k){var Z=this;try{return Z.lexer=n("Lexer").$new(k,Z.notations),Z.$do_parse()}catch(R){if(!r.rescue(R,[n("ParseError"),n("ZeroDivisionError")]))throw R;try{return e}finally{r.pop_exception()}}},1),$.$private(),L($,"$parsed",function(k,Z,R,D){return M(n("Parsed").$new(),"tap",[],function $e(ee){var Y,ce,se,le,_e,ue,ae=null==$e.$$s?this:$e.$$s,te=e;return null==ae.round_type&&(ae.round_type=e),null==ee&&(ee=e),te=[k["$[]"]("command")],M(ee,"command=",G(te)),H(te.length,1),te=[(Y=k["$[]"]("prefix"),Y===e||null==Y?e:M(Y,"eval",[ae.round_type]))],M(ee,"prefix_number=",G(te)),H(te.length,1),te=[(ce=k["$[]"]("suffix"),ce===e||null==ce?e:M(ce,"eval",[ae.round_type]))],M(ee,"suffix_number=",G(te)),H(te.length,1),te=[(se=Z["$[]"]("critical"),se===e||null==se?e:M(se,"eval",[ae.round_type]))],M(ee,"critical=",G(te)),H(te.length,1),te=[(le=Z["$[]"]("fumble"),le===e||null==le?e:M(le,"eval",[ae.round_type]))],M(ee,"fumble=",G(te)),H(te.length,1),te=[(_e=Z["$[]"]("dollar"),_e===e||null==_e?e:M(_e,"eval",[ae.round_type]))],M(ee,"dollar=",G(te)),H(te.length,1),te=[R.$eval(ae.round_type)],M(ee,"modify_number=",G(te)),H(te.length,1),te=[D["$[]"]("cmp_op")],M(ee,"cmp_op=",G(te)),H(te.length,1),F(D["$[]"]("target"),"?")?(M(ee,"question_target=",G(te=[!0])),H(te.length,1),M(ee,"target_number=",G(te=[0])),te[H(te.length,1)]):(M(ee,"question_target=",G(te=[!1])),H(te.length,1),te=[(ue=D["$[]"]("target"),ue===e||null==ue?e:M(ue,"eval",[ae.round_type]))],M(ee,"target_number=",G(te)),te[H(te.length,1)])},{$$arity:1,$$s:this})},4),L($,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],v=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],z=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],g=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],w=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],q=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],p=[e,6,13,3,9,-1,27,-15,-10,-1,-38],l=[e,e,e,e,e,e,19,16,15,e,e],A=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],re=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),J(u[0],"Racc_arg",[i,v,g,z,w,q,l,p,19,A,re,58,35,!0]),J(u[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),J(u[0],"Racc_debug_parser",!1),L($,"$_reduce_1",function(k,Z,R){var D;return W(this.modifier)||this.$raise(n("ParseError")),D=C(k),this.$parsed(null==D[0]?e:D[0],null==D[1]?e:D[1],null==D[2]?e:D[2],null==D[3]?e:D[3])},3),L($,"$_reduce_2",function(k,Z,R){var D;return W(this.modifier)||this.$raise(n("ParseError")),D=C(k),this.$parsed(null==D[0]?e:D[0],null==D[2]?e:D[2],null==D[1]?e:D[1],null==D[3]?e:D[3])},3),L($,"$_reduce_3",function(k,Z,R){var D,ce;return ce=null==(D=C(k))[2]?e:D[2],this.$parsed(null==D[0]?e:D[0],null==D[1]?e:D[1],y(y(n("Arithmetic"),"Node"),"Number").$new(0),ce)},3),L($,"$_reduce_4",function(k,Z,R){var D=this;return W(D.prefix_number)&&W(D.suffix_number)||D.$raise(n("ParseError")),a(["command","prefix","suffix"],{command:k["$[]"](1),prefix:k["$[]"](0),suffix:k["$[]"](2)})},3),L($,"$_reduce_5",function(k,Z,R){var D=this;return W(D.prefix_number)||D.$raise(n("ParseError")),W(D.need_suffix_number)&&D.$raise(n("ParseError")),a(["command","prefix"],{command:k["$[]"](1),prefix:k["$[]"](0)})},3),L($,"$_reduce_6",function(k,Z,R){var D=this;return W(D.suffix_number)||D.$raise(n("ParseError")),W(D.need_prefix_number)&&D.$raise(n("ParseError")),a(["command","suffix"],{command:k["$[]"](0),suffix:k["$[]"](1)})},3),L($,"$_reduce_7",function(k,Z,R){var D=this;return(W(D.need_prefix_number)||W(D.need_suffix_number))&&D.$raise(n("ParseError")),a(["command"],{command:k["$[]"](0)})},3),L($,"$_reduce_8",function(k,Z,R){return a([],{})},3),L($,"$_reduce_9",function(k,Z,R){var D,ce,se,ee=e;return ee=null==(D=C(k))[0]?e:D[0],ce=null==D[2]?e:D[2],W(this.critical)&&W(ee["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["critical",ce])),H(se.length,1),ee},3),L($,"$_reduce_10",function(k,Z,R){var D,ce,se,ee=e;return ee=null==(D=C(k))[0]?e:D[0],ce=null==D[2]?e:D[2],W(this.fumble)&&W(ee["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["fumble",ce])),H(se.length,1),ee},3),L($,"$_reduce_11",function(k,Z,R){var D,ce,se,ee=e;return ee=null==(D=C(k))[0]?e:D[0],ce=null==D[2]?e:D[2],W(this.dollar)&&W(ee["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),M(ee,"[]=",G(se=["dollar",ce])),H(se.length,1),ee},3),L($,"$_reduce_12",function(k,Z,R){return k["$[]"](1)},3),L($,"$_reduce_13",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"Negative").$new(k["$[]"](1))},3),L($,"$_reduce_14",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"+",k["$[]"](2))},3),L($,"$_reduce_15",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"-",k["$[]"](2))},3),L($,"$_reduce_16",function(k,Z,R){return W(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),a([],{})},3),L($,"$_reduce_17",function(k,Z,R){var D,ee,Y;return Y=null==(D=C(k))[1]?e:D[1],W(this.allowed_cmp_op["$include?"](ee=null==D[0]?e:D[0]))||this.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:ee,target:Y})},3),L($,"$_reduce_18",function(k,Z,R){var ne,D=this;return ne=k["$[]"](0),W(D.question_target)||D.$raise(n("ParseError")),W(D.allowed_cmp_op["$include?"](ne))||D.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),L($,"$_reduce_19",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"+",k["$[]"](2))},3),L($,"$_reduce_20",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"-",k["$[]"](2))},3),L($,"$_reduce_22",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"*",k["$[]"](2))},3),L($,"$_reduce_23",function(k,Z,R){return k["$[]"](3).$new(k["$[]"](0),k["$[]"](2))},3),L($,"$_reduce_25",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),L($,"$_reduce_26",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"DivideWithCeil")},3),L($,"$_reduce_27",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"DivideWithCeil")},3),L($,"$_reduce_28",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"DivideWithRound")},3),L($,"$_reduce_29",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"DivideWithFloor")},3),L($,"$_reduce_30",function(k,Z,R){return k["$[]"](1)},3),L($,"$_reduce_31",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"Negative").$new(k["$[]"](1))},3),L($,"$_reduce_33",function(k,Z,R){return k["$[]"](1)},3),L($,"$_reduce_34",function(k,Z,R){return y(y(n("Arithmetic"),"Node"),"Number").$new(k["$[]"](0))},3),L($,"$_reduce_none",function(k,Z,R){return k["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var B,G,J,W,C,o,F,L,U=[],t=r.nil,m=r.module,e=r.send,y=r.eqeqeq,E=r.truthy,I=r.def;return B=U,G=L=[m(U[0],"BCDice")].concat(B),J=F=[m(L[0],"Deprecated")].concat(G),C=[W=m(F[0],"Checker")].concat(J),o=r.$r(C),W.$private(),I(W,"$check_result_legacy",function(S,N,P,h){var c,b=this,T=t,x=t,f=t,_=t;return T=e(N,"map",[],"sides".$to_proc()),c=(x=e(N,"map",[],"value".$to_proc())).$sum(),f=y([100],_=T)?b.$check_1D100(S,c,P,h):y([20],_)?b.$check_1D20(S,c,P,h):y([6,6],_)?b.$check_2D6(S,c,x,P,h):t,(E(f["$nil?"]())||E(f["$empty?"]()))&&(f=y([10],_=T.$uniq())?b.$check_nD10(S,c,x,P,h):y([6],_)?b.$check_nD6(S,c,x,P,h):t,E(f["$nil?"]())||E(f["$empty?"]()))?t:o("Result").$new(f.$delete_prefix(" \uff1e "))},4),I(W,"$check_1D100",function(S,N,P,h){return t},4),I(W,"$check_1D20",function(S,N,P,h){return t},4),I(W,"$check_nD10",function(S,N,P,h,b){return t},5),I(W,"$check_2D6",function(S,N,P,h,b){return t},5),I(W,"$check_nD6",function(S,N,P,h,b){return t},5)},Opal.modules["bcdice/base"]=function(r){var N,x,u,i,v,c,f,_,$,h,U=r.top,t=[],m=r.$r(t),e=r.nil,y=r.$$$,E=r.module,I=r.klass,a=r.truthy,B=r.def,X=r.regexp,L=r.rb_plus,M=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeqeq,j=r.eqeq,J=r.range,W=r.rb_divide,C=r.rb_times,o=r.rb_ge,s=e;return U.$require("i18n"),U.$require("i18n/backend/fallbacks"),U.$require("bcdice/randomizer"),U.$require("bcdice/dice_table"),U.$require("bcdice/enum"),U.$require("bcdice/translate"),U.$require("bcdice/result"),U.$require("bcdice/command/parser"),U.$require("bcdice/deprecated/checker"),N=t,x=h=[E(t[0],"BCDice")].concat(N),f=[c=I(h[0],null,"Base")].concat(x),_=r.$r(f),($=c.$$prototype).sort_add_dice=$.sort_barabara_dice=$.enabled_d9=$.raw_input=$.randomizer=$.enabled_upcase_input=$.debug=e,i=[u=r.get_singleton_class(c)].concat(f),v=r.$r(i),u.$attr_reader("prefixes"),B(u,"$register_prefix",function(g){var q,p=this,l=e;return null==p.prefixes&&(p.prefixes=e),q=r.slice.call(arguments),p.prefixes=a(l=p.prefixes)?l:[],p.prefixes.$concat(q.$flatten())},-1),B(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),B(u,"$prefixes_pattern",function(){var g=this,w=e;return null==g.prefixes_pattern&&(g.prefixes_pattern=e),null==g.prefixes&&(g.prefixes=e),g.prefixes_pattern=a(w=g.prefixes_pattern)?w:e,a(g.prefixes_pattern)?g.prefixes_pattern:(g.prefixes=a(w=g.prefixes)?w:[],g.prefixes.$freeze(),g.prefixes_pattern=(a(g.prefixes["$empty?"]())?/(?!)/:X(["^(S)?(",g.prefixes.$join("|"),")"],"i")).$freeze())},0),B(u,"$command_pattern",function(){var g=this,w=e,q=e;return null==g.command_pattern&&(g.command_pattern=e),null==g.prefixes&&(g.prefixes=e),g.command_pattern=a(w=g.command_pattern)?w:e,a(g.command_pattern)?g.command_pattern:(g.prefixes=a(w=g.prefixes)?w:[],g.prefixes.$freeze(),q=L(M(y(v("CommonCommand"),"COMMANDS"),"map",[],function(l){return null==l&&(l=e),y(l,"PREFIX_PATTERN").$source()},1),g.prefixes),g.command_pattern=X(["^S?(",q.$join("|"),")"],"i").$freeze())},0),B(u,"$eval",function(g){return this.$new(g).$eval()},1),c.$include(_("Translate")),c.$include(y(_("Deprecated"),"Checker")),B(c,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=y(_("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=y(_("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=y(_("BCDice"),"Randomizer").$new(),i.debug=!1},1),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),B(c,"$sort_add_dice?",function(){return this.sort_add_dice},0),B(c,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),B(c,"$enabled_d9?",function(){return this.enabled_d9},0),B(c,"$enable_debug",function(){return this.debug=!0},0),B(c,"$eval",function(){var i,v,z,n=this,g=e;return i=y(_("BCDice"),"Preprocessor").$process(n.raw_input,n),v=a(z=n.$dice_command(i))?z:n.$eval_common_command(n.raw_input),a(v)?(g=[n.randomizer.$rand_results()],M(v,"rands=",G(g)),H(g.length,1),g=[n.randomizer.$detailed_rand_results()],M(v,"detailed_rands=",G(g)),H(g.length,1),v):e},0),B(c,"$change_text",function(n){return n},1),B(c,"$check_result",function(n,i,v,z){var g=this,w=e,q=e,p=e,l=e,A=e;return w=g.$check_result_legacy(n,i,v,z),a(w)?w:(q=M(i,"map",[],"sides".$to_proc()),l=(p=M(i,"map",[],"value".$to_proc())).$sum(),w=F([100],A=q)?g.$result_1d100(n,l,v,z):F([20],A)?g.$result_1d20(n,l,v,z):F([6,6],A)?g.$result_2d6(n,l,p,v,z):e,j(w,_("Result").$nothing())?e:a(w)?w:(w=F([10],A=q.$uniq())?g.$result_nd10(n,l,p,v,z):F([6],A)?g.$result_nd6(n,l,p,v,z):e,j(w,_("Result").$nothing())?e:a(w)?w:g.$result_ndx(n,v,z)))},4),B(c,"$grich_text",function(n,i,v){return e},3),c.$private(),B(c,"$eval_common_command",function(n){try{return n=this.$change_text(n),M(y(_("CommonCommand"),"COMMANDS"),"each",[],function v(z){var w,g=null==v.$$s?this:v.$$s;if(null==g.randomizer&&(g.randomizer=e),null==z&&(z=e),w=z.$eval(n,g,g.randomizer),!a(w))return e;r.ret(w)},{$$arity:1,$$s:this}),e}catch(v){if(v===r.returner)return v.$v;throw v}},1),B(c,"$dice_command",function(n){var i=this,v=e,z=e,g=e,w=e,q=e;return a(i.enabled_upcase_input)&&(n=n.$upcase()),v=i.$class().$prefixes_pattern().$match(n),a(v)?(z=v["$[]"](1)["$nil?"]()["$!"](),a(z)&&(n=n["$[]"](J(1,-1,!1))),g=i.$eval_game_system_specific_command(n),a(g["$is_a?"](_("Result")))?(w=[a(q=g["$secret?"]())?q:z],M(g,"secret=",G(w)),H(w.length,1),g):a(g["$nil?"]())||a(g["$empty?"]())||j(g,"1")?e:M(_("Result").$new(),"tap",[],function(l){return null==l&&(l=e),w=[g.$to_s()],M(l,"text=",G(w)),H(w.length,1),M(l,"secret=",G(w=[z])),w[H(w.length,1)]},1)):e},1),B(c,"$eval_game_system_specific_command",function(n){return e},1),B(c,"$result_ndx",function(n,i,v){return a(v["$is_a?"](_("String")))?e:a(n.$send(i,v))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))},3),B(c,"$result_1d100",function(n,i,v,z){return e},4),B(c,"$result_1d20",function(n,i,v,z){return e},4),B(c,"$result_nd10",function(n,i,v,z,g){return e},5),B(c,"$result_2d6",function(n,i,v,z,g){return e},5),B(c,"$result_nd6",function(n,i,v,z,g){return e},5),B(c,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),B(c,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),B(c,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),B(c,"$get_table_by_nDx",function(n,i,v){var g,w=e;return g=this.randomizer.$roll_sum(i,v),w=this.$get_table_value(n["$[]"](H(g,i))),a(w["$nil?"]())?["1",0]:[w,g]},3),B(c,"$get_table_by_1d3",function(n){var z,g,i=this,w=e;return i.$debug("get_table_by_1d3"),z=i.randomizer.$roll_sum(1,6),i.$debug("num",z),g=W(H(z,1),2).$to_i(),i.$debug("index",g),w=n["$[]"](g),a(w["$nil?"]())?["1",0]:[w,z]},1),B(c,"$get_table_by_d66_swap",function(n){var v;return v=this.randomizer.$roll_d66(y(_("D66SortType"),"ASC")),[this.$get_table_by_number(v,n),v]},1),B(c,"$get_table_by_d66",function(n){var v,z,g,q,w=e;return v=this.randomizer.$roll_once(6),z=this.randomizer.$roll_once(6),g=L(C(H(v,1),6),H(z,1)),w=n["$[]"](g),q=""+v+z,a(w["$nil?"]())?["1",q]:[w,q]},1),B(c,"$get_table_by_number",function(n,i,v){try{return null==v&&(v="1"),M(i,"each",[],function g(w){var p,q=null==g.$$s?this:g.$$s;if(null==w&&(w=e),p=w["$[]"](0),!a(o(p,n)))return e;r.ret(q.$get_table_value(w["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(v)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),B(c,"$get_table_value",function(n){return a(n["$is_a?"](_("Proc")))?n.$call():n},1),B(c,"$roll_tables",function(n,i){var z=e;return z=i["$[]"](n),a(z)?z.$roll(this.randomizer).$to_s():e},2),B(c,"$debug",function(n,i){var z,g=this,w=e,q=e;return z=r.slice.call(arguments,1),a(g.debug)?(w=a(n["$is_a?"](_("String")))?n:n.$inspect(),a(z["$empty?"]())?g.$warn(w):(q=M(z,"map",[],function(l){return null==l&&(l=e),a(l["$is_a?"](_("String")))?'"'+l+'"':l.$inspect()},1),g.$warn(w+": "+q.$join(", ")))):e},-2),y(y(m("I18n"),"Backend"),"Simple").$include(y(y(m("I18n"),"Backend"),"Fallbacks")),m("I18n").$load_path()["$<<"](m("Dir")["$[]"](m("File").$join("bcdice","../../i18n/**/*.yml"))),s=["ja_jp"],M(m("I18n"),"default_locale=",G(s)),H(s.length,1),s=[["ja_jp"]],M(m("I18n").$fallbacks(),"defaults=",G(s)),s[H(s.length,1)]},Opal.queue(function(r){var N,T,_,$,u,q,p,l,A,d,n,i,v,c,f,h,t=[],m=r.nil,e=r.$$$,y=r.module,E=r.klass,I=r.const_set,a=r.send2,B=r.find_super,X=r.def,L=r.eqeq,M=r.truthy,G=r.rb_le,H=r.rb_ge,F=r.rb_plus,j=r.send,J=r.to_a,W=r.rb_minus,C=r.hash2,o=r.defs,s=r.to_ary;return r.top.$require("bcdice/base"),N=t,T=h=[y(t[0],"BCDice")].concat(N),c=[y(h[0],"GameSystem")].concat(T),f=r.$r(c),_=c[0],$=f("Base"),u=c,i=[n=E(_,$,"MagicaLogia")].concat(u),v=r.$r(i),n.$$prototype.randomizer=m,I(i[0],"ID","MagicaLogia"),I(i[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),I(i[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),I(i[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),X(n,"$initialize",function g(w){var p=this;return delete g.$$p,a(p,B(p,"initialize",g,!1,!0),"initialize",[w],null),p.sort_add_dice=!0,p.sort_barabara_dice=!0,p.d66_sort_type=e(v("D66SortType"),"ASC")},1),X(n,"$result_2d6",function(w,q,p,l,A){var d=this,O=m,re=m;return L(A,"?")||!L(l,">=")?m:(O=M(G(q,2))?v("Result").$fumble(d.$translate("fumble")):M(H(q,12))?v("Result").$critical(d.$translate("MagicaLogia.special")):M(H(w,A))?v("Result").$success(d.$translate("success")):v("Result").$failure(d.$translate("failure")),re=[F(O.$text(),d.$gain_magic_element(p["$[]"](0),p["$[]"](1)))],j(O,"text=",J(re)),W(re.length,1),O)},5),X(n,"$eval_game_system_specific_command",function(w){var p,q=this;return M(p=e(q.$class(),"SKILL_TABLE").$roll_command(q.randomizer,w))?p:q.$roll_tables(w,e(q.$class(),"TABLES"))},1),n.$private(),X(n,"$gain_magic_element",function(w,q){var p=this,l=m;return L(w,q)?(l=p.$translate("MagicaLogia.elements.items")["$[]"](W(w,1)),F(" \uff1e ",p.$format(p.$translate("MagicaLogia.elements.format"),C(["text"],{text:l})))):""},2),q=i,l=[p=E(i[0],null,"SkillExpandTable")].concat(q),A=r.$r(l),(d=p.$$prototype).times=d.sides=d.items=d.name=d.skill_table=m,o(p,"$from_i18n",function(re,V,ie){var K=m;return K=A("I18n").$t(re,C(["locale","raise"],{locale:V,raise:!1})),this.$new(K["$[]"]("name"),K["$[]"]("type"),K["$[]"]("items"),ie)},3),X(p,"$initialize",function(re,V,ie,Q){var K=this,k=m;return K.name=re,K.items=ie.$freeze(),K.skill_table=Q,k=/(\d+)D(\d+)/i.$match(V),M(k)||K.$raise(A("ArgumentError"),"Unexpected table type: "+V),K.times=k["$[]"](1).$to_i(),K.sides=k["$[]"](2).$to_i()},4),X(p,"$roll",function(re){var ie,Q,V=this;return ie=re.$roll_sum(V.times,V.sides),Q=V.$expand(V.items["$[]"](W(ie,V.times)),re),e(A("DiceTable"),"RollResult").$new(V.name,ie,Q)},1),p.$private(),X(p,"$expand",function(re,V){return j(re,"gsub",[/%{([a-z]+)}/],function Q(){var Z,K=null==Q.$$s?this:Q.$$s;return Z=A("Regexp").$last_match()["$[]"](1).$to_sym(),K.$roll_skill(Z,V)},{$$arity:0,$$s:this})},2),I(l[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),X(p,"$roll_skill",function(re,V){var Q=m;return L(re,"skill")?this.skill_table.$roll_skill(V):L(re,"element")?this.skill_table.$roll_category(V):(Q=A("CATEGORIES").$index(re),M(Q)||this.$raise(A("ArgumentError")),this.skill_table.$categories()["$[]"](Q).$roll(V).$name())},2),function(g,w,q){var p=E(g,null,"FallenAfterTable"),l=[p].concat(q),A=r.$r(l),d=p.$$prototype;d.lower=d.higher=d.name=m,o(p,"$from_i18n",function(re,V){var Q=m;return Q=A("I18n").$t(re,C(["locale","raise"],{locale:V,raise:!0})),this.$new(Q["$[]"]("name"),Q["$[]"]("items_lower"),Q["$[]"]("items_higher"))},2),X(p,"$initialize",function(re,V,ie){var Q=this;return Q.name=re,Q.lower=V,Q.higher=ie},3),X(p,"$roll",function(re){var V,ie,K,k,Q=this,Z=m;return ie=re.$roll_barabara(2,6),k=null==(V=s(ie))[1]?m:V[1],Z=M(G(K=null==V[0]?m:V[0],3))?Q.lower:Q.higher,Q.name+"("+K+","+k+") \uff1e "+Z["$[]"](W(k,1))},1)}(i[0],0,i),function(g,w){var q=[g].concat(w),p=r.$r(q);g.$private(),X(g,"$translate_skill_table",function(A){return e(p("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",A,C(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))},1),X(g,"$translate_tables",function(A,d){var O,re,V,ie,Q,K;return O=p("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",A,d),re=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",A),V=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",A),ie=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",A),Q=e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",A),K=p("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",A,d),C(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",A,d),ST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",A,d),FT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",A),WT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",A,d),FCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",A),AT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",A,d),BGT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",A),DAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",A),FAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",A),WIT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",A),TCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",A),PCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",A),MCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",A),ICT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",A),SCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",A),XCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",A),WCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",A),CCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",A),MIT:O,MOT:re,MAT:V,MUT:ie,MFT:Q,MLT:K,BST:e(p("DiceTable"),"ChainTable").$new(p("I18n").$translate("MagicaLogia.tables.BST.name",C(["raise","locale"],{raise:!0,locale:A})),"1D6",[O,re,V,ie,Q,K]),PT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",A),XEST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",A,d),IWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",A,d),MCST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",A,d),WDST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",A,d),LWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",A,d),STB:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",A,d),MGCT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",A),MBST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",A,d),MAST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",A,d),TCST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",A,d),PWST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",A,d),PAST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",A,d),GBST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",A,d),SLST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",A,d),WLAT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",A),WMT:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",A,d),FFT:e(p("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",A),OLST:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",A,d),TPTB:p("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",A,d),FLT:p("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",A)})},2)}(r.get_singleton_class(n),i),I(i[0],"SKILL_TABLE",n.$translate_skill_table("ja_jp")),I(i[0],"TABLES",n.$translate_tables("ja_jp",v("SKILL_TABLE"))),n.$register_prefix(v("SKILL_TABLE").$prefixes()),n.$register_prefix(v("TABLES").$keys())})}}]);