(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7073],{5396:(O,tt,w)=>{w(9993),Opal.queue(function(i){var P,J,j,d,p,B,y,U,z,M=[],t=i.nil,S=i.module,E=i.klass,x=i.const_set,H=i.send2,G=i.find_super,h=i.def,k=i.send,_=i.truthy,q=i.to_ary,o=i.rb_plus,v=i.rb_gt,T=i.to_a,K=i.rb_minus,L=i.eqeq,R=i.neqeq,N=i.rb_times,V=i.rb_lt;return P=M,J=z=[S(M[0],"BCDice")].concat(P),y=[S(z[0],"GameSystem")].concat(J),U=i.$r(y),j=y,p=[d=E(y[0],U("Base"),"BarnaKronika")].concat(j),B=i.$r(p),d.$$prototype.isBattleMode=t,x(p[0],"ID","BarnaKronika"),x(p[0],"NAME","\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab"),x(p[0],"SORT_KEY","\u306f\u308b\u306a\u304f\u308d\u306b\u304b"),x(p[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000nBK\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30bb\u30c3\u30c8\u6570\u304c1\u4ee5\u4e0a\u306e\u6642\u306f\u30bb\u30c3\u30c8\u6570\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n\u30fb\u653b\u6483\u5224\u5b9a\u3000nBA\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u3001\u653b\u6483\u5024\u3068\u547d\u4e2d\u90e8\u4f4d\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u3000nBKCt\u3000nBACt\n\u3000\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u308d\u306b\u300cCt\u300d\u3092\u4ed8\u3051\u308b\u3068\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30b3\u30fc\u30eb\u3067\u3059\u3002\n\u3000\u30c0\u30a4\u30b9\u6570n,\u30b3\u30fc\u30eb\u6570t\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30c0\u30a4\u30b9\u6570n\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u30bb\u30c3\u30c8\u6570\u304c1\u4ee5\u4e0a\u306e\u6642\u306f\u30bb\u30c3\u30c8\u6570\u3082\u8868\u793a\u3057\u3001\u653b\u6483\u5224\u5b9a\u306e\u5834\u5408\u306f\u547d\u4e2d\u90e8\u4f4d\u3082\u8868\u793a\u3057\u307e\u3059\u3002\n"),d.$register_prefix("\\d+BK","\\d+BA","\\d+BKC","\\d+BAC","\\d+R6"),h(d,"$initialize",function b(n){var r=this;return delete b.$$p,H(r,G(r,"initialize",b,!1,!0),"initialize",[n],null),r.sort_add_dice=!0,r.sort_barabara_dice=!0},1),h(d,"$replace_text",function(n){return n=k(n,"gsub",[/(\d+)BKC(\d)/],function(){return B("Regexp").$last_match(1)+"R6[0,"+B("Regexp").$last_match(2)+"]"},0),n=k(n,"gsub",[/(\d+)BAC(\d)/],function(){return B("Regexp").$last_match(1)+"R6[1,"+B("Regexp").$last_match(2)+"]"},0),n=k(n,"gsub",[/(\d+)BK/],function(){return B("Regexp").$last_match(1)+"R6[0,0]"},0),k(n,"gsub",[/(\d+)BA/],function(){return B("Regexp").$last_match(1)+"R6[1,0]"},0)},1),h(d,"$eval_game_system_specific_command",function(n){var e,r,$=this,s=t,a=t,m=t,g=t,c=t,f=t,u=t,l=t;return n=$.$replace_text(n),_(/(^|\s)S?((\d+)[rR]6(\[([,\d]+)\])?)(\s|$)/i["$=~"](n))?(n=B("Regexp").$last_match(2),s=B("Regexp").$last_match(5),a=B("Regexp").$last_match(3),a=_(m=a)?m:1,$.isBattleMode=!1,g=0,_(s)&&(r=k(s.$split(","),"map",[],"to_i".$to_proc()),g=null==(e=q(r))[1]?t:e[1],$.isBattleMode=(null==e[0]?t:e[0])["$=="](1)),$.$debug("@isBattleMode",$.isBattleMode),r=$.$roll_barna_kronika(a,g),c=null==(e=q(r))[1]?t:e[1],f=null==e[2]?t:e[2],u=null==e[3]?t:e[3],l="("+n+") \uff1e ["+(null==e[0]?t:e[0])+"] \uff1e ",_($.isBattleMode)?l=o(l,u):($.$debug("suc",c),l=_(v(c,1))?o(l,"\u6210\u529f\u6570"+c):o(l,"\u5931\u6557"),$.$debug("set",f),_(v(f,0))&&(l=o(l,",\u30bb\u30c3\u30c8"+f))),l):t},1),h(d,"$roll_barna_kronika",function(n,e){var r=this,$=t,s=t,a=t,m=t,g=t,A=t;return n=n.$to_i(),$="",s=0,a=0,m="",g=[0,0,0,0,0,0],k(n,"times",[],function C(c){var u,l,f=null==C.$$s?this:C.$$s;return null==f.randomizer&&(f.randomizer=t),null==c&&(c=t),l=[u=f.randomizer.$roll_index(6),o(g["$[]"](u),1)],k(g,"[]=",T(l)),K(l.length,1),_(v(g["$[]"](u),s))?s=g["$[]"](u):t},{$$arity:1,$$s:r}),k(6,"times",[],function C(c){var u,f=null==C.$$s?this:C.$$s;return null==c&&(c=t),u=g["$[]"](c),L(u,0)?t:(k(u,"times",[],function(W){return null==W&&(W=t),$=o($,o(c,1)+",")},1),_(f.$isCriticalCall(c,e))?(f.$debug("isCriticalCall"),m=o(m,f.$getAttackStringWhenCriticalCall(c,u))):_(f.$isNomalAttack(e,u))&&(f.$debug("isNomalAttack"),m=o(m,f.$getAttackStringWhenNomal(c,u))),_(v(u,1))?a=o(a,1):t)},{$$arity:1,$$s:r}),R(e,0)&&(A=g["$[]"](K(e,1)),s=N(A,2),a=R(A,0)?1:0),_(r.isBattleMode)&&_(V(s,2))&&(m="\u5931\u6557"),$=$.$sub(/,$/,""),m=m.$sub(/,$/,""),[$,s,a,m]},2),h(d,"$isCriticalCall",function(n,e){return!(!_(this.isBattleMode)||L(e,0))&&e["$=="](o(n,1))},2),h(d,"$isNomalAttack",function(n,e){return!(!_(this.isBattleMode)||R(n,0))&&v(e,1)},2),h(d,"$getAttackStringWhenCriticalCall",function(n,e){var $,s;return $=this.$getAttackHitLocation(o(n,1)),s=N(e,2),o($,":\u653b\u6483\u5024"+s+",")},2),h(d,"$getAttackStringWhenNomal",function(n,e){var $;return $=this.$getAttackHitLocation(o(n,1)),o($,":\u653b\u6483\u5024"+e+",")},2),h(d,"$getAttackHitLocation",function(n){return this.$get_table_by_number(n,[[1,"\u982d\u90e8"],[2,"\u53f3\u8155"],[3,"\u5de6\u8155"],[4,"\u53f3\u811a"],[5,"\u5de6\u811a"],[6,"\u80f4\u4f53"]])},1)})}}]);