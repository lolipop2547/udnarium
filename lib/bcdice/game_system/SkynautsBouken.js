(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[303],{5444:(en,$n,q)=>{q(9993),Opal.queue(function(a){var X,Y,Z,b,v,p,z,Q,w,I=[],n=a.nil,V=a.$$$,k=a.module,j=a.klass,x=a.const_set,g=a.hash2,C=a.send2,B=a.find_super,N=a.def,m=a.truthy,G=a.hash,D=a.to_ary,h=a.send,F=a.eqeq,R=a.range,P=a.rb_le,L=a.rb_ge,A=a.to_a,E=a.rb_minus,c=a.rb_plus,M=a.neqeq;return X=I,Y=w=[k(I[0],"BCDice")].concat(X),z=[k(w[0],"GameSystem")].concat(Y),Q=a.$r(z),Z=z,v=[b=j(z[0],Q("Base"),"SkynautsBouken")].concat(Z),p=a.$r(v),b.$$prototype.randomizer=n,x(v[0],"ID","SkynautsBouken"),x(v[0],"NAME","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09"),x(v[0],"SORT_KEY","\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642"),x(v[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\uff08nSNt#f\uff09 n:\u30c0\u30a4\u30b9\u6570(\u7701\u7565\u66422)\u3001t:\u76ee\u6a19\u5024(\u7701\u7565\u66427)\u3001f:\u30d5\u30a1\u30f3\u30d6\u30eb\u5024(\u7701\u7565\u66421)\n    \u4f8b\uff09SN6#2\u30003SN\n\u30fb\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af (Dx/y@m) x:\u30c0\u30e1\u30fc\u30b8\u7bc4\u56f2\u3001y:\u653b\u6483\u56de\u6570\n\u3000\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u3000\u4f8b\uff09 D/4\u3000D19/2\u3000D/3@8\u3000D[\u5927\u63fa\u308c]/2\n\u30fb\u56de\u907f(AVO@m\u30c0\u30e1\u30fc\u30b8)\n\u3000\u3000m:\u56de\u907f\u65b9\u5411\uff08\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\uff09\u3001\u30c0\u30e1\u30fc\u30b8\uff1a\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u7d50\u679c\n\u3000\u3000\u4f8b\uff09AVO@8[1,4],[2,6],[3,8]\u3000AVO@2[6,4],[2,6]\n\u30fbFT \u30d5\u30a1\u30f3\u30d6\u30eb\u8868(p76)\n\u30fbNV \u822a\u884c\u8868\n\n\u25a0 \u5224\u5b9a\u30bb\u30c3\u30c8\n\u30fb\u300a\u56de\u907f\u904b\u52d5\u300b\u5224\u5b9a+\u56de\u907f\uff08nSNt#f/AVO@\u30c0\u30e1\u30fc\u30b8\uff09\n\u3000\u3000nSNt#f \u2192 \u6210\u529f\u306a\u3089 AVO@m\n\u3000\u3000\u4f8b\uff09SN/AVO@8[1,4],[2,6],[3,8]\u30003SN#2/AVO@2[6,4],[2,6]\n\u30fb\u7832\u6483\u5224\u5b9a+\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(nSNt#f/Dx/y@m)\n\u3000\u3000\u884c\u70ba\u5224\u5b9a\u306e\u51fa\u76ee\u5909\u66f4\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u9003\u3059\u306e\u3067\u8981GM\u306e\u8a31\u53ef\n\u3000\u3000nSNt#f \u2192 \u6210\u529f\u306a\u3089 Dx/y@m\n\u3000\u3000\u4f8b\uff09SN/D/4\u30003SN#2/D[\u5927\u63fa\u308c]/2\n"),x(v[0],"TABLES",g(["FT","NV"],{FT:V(p("DiceTable"),"Table").$new("\u30d5\u30a1\u30f3\u30d6\u30eb\u8868","1D6",["\u306a\u3093\u3068\u304b\u5927\u4e8b\u306b\u306f\u3044\u305f\u3089\u306a\u304b\u3063\u305f\u3002\u901a\u5e38\u306e\u5931\u6557\u3068\u540c\u69d8\u306e\u51e6\u7406\u3092\u884c\u3046\u3053\u3068\u3002","\u8ee2\u3093\u3067\u3057\u307e\u3063\u305f\u3002\u30ad\u30df\u306f[\u8ee2\u5012](p107)\u3059\u308b\u3002","\u5931\u6557\u306b\u30a4\u30e9\u30a4\u30e9\u3057\u3066\u3057\u307e\u3063\u305f\u3002\u30ad\u30df\u306f\u7372\u5f97\u3057\u3066\u3044\u308b\u3010\u30ad\u30ba\u30ca\u30111\u3064\u306e\u300c\u652f\u63f4\u30c1\u30a7\u30c3\u30af\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u308b\u3002","\u81ea\u8eab\u306e\u3044\u308b\u30de\u30b9\u3092[\u7834\u640d](p104)\u3055\u305b\u308b\u3002\u3053\u306e[\u7834\u640d]\u306b\u3088\u3063\u3066\u3001\u30ad\u30df\u306e\u3010\u751f\u547d\u70b9\u3011\u306f\u6e1b\u5c11\u3057\u306a\u3044\u3002","\u982d\u3092\u3076\u3064\u3051\u3066\u3057\u307e\u3063\u305f\u3002\u30ad\u30df\u306e\u3010\u751f\u547d\u70b9\u3011\u3092\u300c1d6\u70b9\u300d\u6e1b\u5c11\u3059\u308b\u3002","\u5947\u8de1\u7684\u306a\u7d50\u679c\u3002 \u3053\u306e\u884c\u70ba\u5224\u5b9a\u306f\u6210\u529f\u3068\u306a\u308b\u3002"]),NV:V(p("DiceTable"),"Table").$new("\u822a\u6d77\u8868","1d6",["\u30b9\u30dd\u30c3\u30c81\u3064\u5206\u9032\u3080","\u30b9\u30dd\u30c3\u30c81\u3064\u5206\u9032\u3080","\u30b9\u30dd\u30c3\u30c81\u3064\u5206\u9032\u3080","\u30b9\u30dd\u30c3\u30c82\u3064\u5206\u9032\u3080","\u30b9\u30dd\u30c3\u30c82\u3064\u5206\u9032\u3080","\u30b9\u30dd\u30c3\u30c83\u3064\u5206\u9032\u3080"])}).$freeze()),b.$register_prefix("D","\\d?SN","NV","FT","AVO"),N(b,"$initialize",function S(r){var s=this;return delete S.$$p,C(s,B(s,"initialize",S,!1,!0),"initialize",[r],null),s.round_type=V(p("RoundType"),"FLOOR")},1),N(b,"$eval_game_system_specific_command",function(r){var s,_,t,$,o,e=this;return m(s=m(_=m(t=m($=m(o=e.$command_sn(r))?o:e.$command_d(r))?$:e.$command_avo(r))?t:e.$command_snavo(r))?_:e.$command_snd(r))?s:e.$roll_tables(r,p("TABLES"))},1),b.$private(),x(v[0],"DIRECTION_INFOS",G(0,g(["name","position_diff"],{name:"",position_diff:[0,0]}),1,g(["name","position_diff"],{name:"\u5de6\u4e0b",position_diff:[-1,1]}),2,g(["name","position_diff"],{name:"\u4e0b",position_diff:[0,1]}),3,g(["name","position_diff"],{name:"\u53f3\u4e0b",position_diff:[1,1]}),4,g(["name","position_diff"],{name:"\u5de6",position_diff:[-1,0]}),5,g(["name","position_diff"],{name:"",position_diff:[0,0]}),6,g(["name","position_diff"],{name:"\u53f3",position_diff:[1,0]}),7,g(["name","position_diff"],{name:"\u5de6\u4e0a",position_diff:[-1,-1]}),8,g(["name","position_diff"],{name:"\u4e0a",position_diff:[0,-1]}),9,g(["name","position_diff"],{name:"\u53f3\u4e0a",position_diff:[1,-1]})).$freeze()),x(v[0],"D_REGEXP",/^D([1-46-9]{0,8})(\[.+\]|S|F|SF|FS)?\/(\d{1,2})(@([2468]))?$/.$freeze()),N(b,"$command_sn",function(r){var e,s,_=this,t=n,$=n,o=n,i=n,f=n,u=n,l=n,d=n;return _.$debug("SN",r),t=V(p("Command"),"Parser").$new(/[1-9]?SN(\d{0,2})/,g(["round_type"],{round_type:_.$round_type()})).$restrict_cmp_op_to(n).$enable_fumble().$parse(r),m(t)?(s=h(t.$command().$split("SN",2),"map",[],"to_i".$to_proc()),o=null==(e=D(s))[1]?n:e[1],F($=null==e[0]?n:e[0],0)&&($=2),F(o,0)&&(o=7),i=m(t.$fumble()["$nil?"]())?1:t.$fumble(),_.$debug("SN Parsed",$,o,i),u=(f=_.randomizer.$roll_barabara($,6)).$sort()["$[]"](R(-2,-1,!1)),l=F(u,[6,6])?p("Result").$critical("\u30b9\u30da\u30b7\u30e3\u30eb\uff08\u3010\u751f\u547d\u70b9\u30111d6\u56de\u5fa9\uff09"):m(P(f.$max(),i))?p("Result").$fumble("\u30d5\u30a1\u30f3\u30d6\u30eb\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u8868FT\uff09"):m(L(u.$sum(),o))?p("Result").$success("\u6210\u529f"):p("Result").$failure("\u5931\u6557"),F($,2)?(d=[["("+$+"SN"+o+"#"+i+")",u.$sum()+"["+f.$join(",")+"]",l.$text()].$compact().$join(" \uff1e ")],h(l,"text=",A(d)),E(d.length,1)):(d=[["("+$+"SN"+o+"#"+i+")",c(c("[",f.$join(",")),"]"),u.$sum()+"["+u.$join(",")+"]",l.$text()].$compact().$join(" \uff1e ")],h(l,"text=",A(d)),E(d.length,1)),l):n},1),N(b,"$command_d",function(r){var e,s,_=this,t=n,$=n,o=n,i=n,f=n,u=n,l=n,d=n,T=n,y=n;return t=p("D_REGEXP").$match(r),m(t)?($=t["$[]"](3).$to_i(),o=t["$[]"](1).$to_s(),i=t["$[]"](5).$to_i(),f=_.$get_fire_points($,o),u=["("+(r=r.$sub("SF/","[\u5927\u63fa\u308c,\u706b\u707d]/").$sub("FS/","[\u706b\u707d,\u5927\u63fa\u308c]/").$sub("F/","[\u706b\u707d]/").$sub("S/","[\u5927\u63fa\u308c]/"))+")",_.$get_points_text(f,0,0)],M(i,0)&&(s=(l=p("DIRECTION_INFOS")["$[]"](i))["$[]"]("position_diff"),d=null==(e=D(s))[0]?n:e[0],T=null==e[1]?n:e[1],y=[-1,c(u["$[]"](-1),"\n")],h(u,"[]=",A(y)),E(y.length,1),u["$<<"]("\u300a\u5f3e\u9053\u5b66\u300b"+l["$[]"]("name")),u["$<<"](_.$get_points_text(f,d,T))),u.$compact().$join(" \uff1e ")):n},1),N(b,"$command_avo",function(r){var e,s,t=n,$=n,o=n,i=n;return this.$debug("AVO",r),t=r.$match(/^AVO@([2468])(.*?)$/),m(t)?(s=($=p("DIRECTION_INFOS")["$[]"](t["$[]"](1).$to_i()))["$[]"]("position_diff"),e=D(s),o=null==e[0]?n:e[0],i=null==e[1]?n:e[1],c("\u300a\u56de\u907f\u904b\u52d5\u300b"+$["$[]"]("name")+" \uff1e ",h(t["$[]"](2),"gsub",[/\(?\[(\d),(\d{1,2})\]\)?/],function f(){var l,d,u=null==f.$$s?this:f.$$s;return l=c(p("Regexp").$last_match(1).$to_i(),i),d=c(p("Regexp").$last_match(2).$to_i(),o),u.$get_xy_text(d,l)},{$$arity:0,$$s:this}))):n},1),N(b,"$command_snavo",function(r){var e,s,t,$,o,_=this,i=n,f=n;return s=r.$split(/\/?AVO/,2),e=D(s),_.$debug("SNAVO",t=null==e[0]?n:e[0],$=null==e[1]?n:e[1]),o=/^@([2468])(.*?)$/.$match($),m(o)&&(i=_.$command_sn(t),m(i))?(m(i["$success?"]())&&(f=[c(i.$text(),c("\n \uff1e ",_.$command_avo(c("AVO",$))))],h(i,"text=",A(f)),E(f.length,1)),i):n},1),N(b,"$command_snd",function(r){var e,s,t,$,o,_=this,i=n,f=n;return s=r.$split(/\/?D/,2),e=D(s),_.$debug("SND",t=null==e[0]?n:e[0],$=null==e[1]?n:e[1]),o=p("D_REGEXP").$match("D"+$),m(o)&&(i=_.$command_sn(t),m(i))?(m(i["$success?"]())&&(f=[c(i.$text(),"\n \uff1e "+_.$command_d(c("D",$)))],h(i,"text=",A(f)),E(f.length,1)),i):n},1),N(b,"$get_points_text",function(r,e,s){return c("[\u7e26,\u6a2a]=",h(r,"map",[],function t($){return null==$&&($=n),h($,"map",[],function i(f,u){return null==f&&(f=n),null==u&&(u=n),(null==i.$$s?this:i.$$s).$get_xy_text(c(f,e),c(u,s))},{$$arity:2,$$s:null==t.$$s?this:t.$$s}).$join()},{$$arity:1,$$s:this}).$join(","))},3),N(b,"$get_xy_text",function(r,e){return m(R(2,12,!1)["$include?"](r))&&m(R(1,6,!1)["$include?"](e))?"["+e+","+r+"]":"(["+e+","+r+"])"},2),N(b,"$get_fire_points",function(r,e){var _;return _=h(e.$chars(),"map",[],"to_i".$to_proc()),h(r.$times(),"map",[],function t(){var o,i,$=null==t.$$s?this:t.$$s;return null==$.randomizer&&($.randomizer=n),o=$.randomizer.$roll_once(6),i=$.randomizer.$roll_sum(2,6),c([[i,o]],h(_,"map",[],function(u){var l,d,y;return null==u&&(u=n),d=p("DIRECTION_INFOS")["$[]"](u)["$[]"]("position_diff"),y=null==(l=D(d))[1]?n:l[1],[c(i,null==l[0]?n:l[0]),c(o,y)]},1))},{$$arity:0,$$s:this})},2)})}}]);